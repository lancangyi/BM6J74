C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE OEM_POWER
OBJECT MODULE PLACED IN Oem\Oem_Power.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\c51.exe Oem\Oem_Power.c LA WL(1) CD OT(9,SIZE) NOAREGS OR INCDIR(.\Core\Include\;.\
                    -Oem\Include\)

line level    source

   1          /*-----------------------------------------------------------------------------
   2           * Filename: OEM_POWER.C
   3           * Function: OEM USE EC CONTROL SYSTEM POWER
   4           *
   5           * Copyright (c) 2006-2009, ITE Tech. Inc. All Rights Reserved.
   6           *---------------------------------------------------------------------------*/
   7          #include "CORE_INC.H"
   8          #include "OEM_INC.H"
   9          
  10          //-----------------------------------------------------------------------------
  11          //OEM_POWER.H Parameter
  12          //define    _PowrUp_S5      0
  13          //define    _SYSTEM_S0      1
  14          //define    _SYSTEM_S1      2
  15          //define    _SYSTEM_S3      3
  16          //define    _SYSTEM_S4      4
  17          //define    _SYSTEM_S5      5
  18          //define    _GO_POWER_ON    6
  19          //define    _GO_RESUME_ON   7
  20          //define    _GO_SUSPNED_OFF 8
  21          //define    _GO_POWER_OFF   9
  22          
  23          
  24          //-----------------------------------------------------------------------------
  25          
  26          /*-----------------------------------------------------------------------------
  27           * Internal Process Definition
  28           *---------------------------------------------------------------------------*/
  29          static void Oem_CheckPowSwitch(void);
  30          static void Oem_PowSwToPWRBTN(void);
  31          static void Oem_ChkS3Suspend(void);
  32          static void Oem_ChkS5Shutdown(void);
  33          static void Oem_ChkS3WakeUp(void);
  34          static void Oem_SysOnSequence(void);
  35          static void Oem_SysOffSequence(void);
  36          static void Oem_SysResumeSequence(void);
  37          static void Oem_SysSuspendSequence(void);
  38          static void Oem_SysSuspendInit(void);
  39          static void Oem_SysResumeInit(void);
  40          static void Oem_PowSwitchIntr(void);
  41          static void Oem_PowSwOver5Sec(void);
  42          static void Oem_PowSwOver5Sec_ForceShutdown(void);
  43          
  44          
  45          /****************************************/
  46          /*      ADC Base and Calculation Reference              */
  47          /****************************************
  48          base : 0.0029296875
  49          
  50          Setting 1: 1.55V
  51          
  52          Max:1.6171875
  53          Min:1.453125
  54          Assume: 1.4V => 478d => 1DEh
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 2   

  55          
  56          
  57          Setting 2: 1.294V
  58          
  59          Max:1E0=>
  60          Min:199=>1.1982421875 
  61          Assume 1.2V => 410d => 19Ah
  62          
  63          Setting 3: 1.107V
  64          
  65          Max:1A0 :1.21875
  66          Min:15F :1.0283203125
  67          Assume: 1V => 341d => 155h
  68          
  69            ****************************************/
  70          /*                              End                                             */
  71          /****************************************/
  72          
  73          //-----------------------------------------------------------------------------
  74          // Handle System Power Control
  75          //-----------------------------------------------------------------------------
  76          void Oem_SysPowerContrl(void)
  77          {
  78   1          switch (SysPowState)
  79   1          {
  80   2              case 0: // EC Initial Boot
  81   2                      Oem_CheckPowSwitch();
  82   2                      
  83   2      
  84   2                      break;
  85   2      
  86   2              case 1: // System S0
  87   2      
  88   2                      Oem_PowSwToPWRBTN();
  89   2                        #if 1
  90   2                      Oem_PowSwOver5Sec();
  91   2                        #endif
  92   2      
  93   2                      Oem_ChkS5Shutdown();
  94   2                        
  95   2                      if(SysPowState == _SYSTEM_S0)
  96   2                      {
  97   3                      Oem_ChkS3Suspend();
  98   3                      }
  99   2      
 100   2                      Oem_PowSwOver5Sec_ForceShutdown();
 101   2                      
 102   2                      break;
 103   2      
 104   2              case 2: // System S1
 105   2      
 106   2                      break;
 107   2      
 108   2              case 3: // System S3
 109   2                      Oem_PowSwToPWRBTN();
 110   2                      //Oem_PowSwOver5Sec();
 111   2                      Oem_ChkS3WakeUp();
 112   2      
 113   2                      if(SysPowState == _SYSTEM_S3)
 114   2                      {
 115   3                      Oem_ChkS5Shutdown();
 116   3                      }
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 3   

 117   2                      break;
 118   2      
 119   2              case 4: // System S4
 120   2      
 121   2              case 5: // System S5
 122   2      
 123   2                      Oem_CheckPowSwitch();
 124   2      
 125   2                              if(STATE_PM_SLP_S4() == HighActive)
 126   2                              {
 127   3                                      Oem_TriggerPowerOn();
 128   3                              }
 129   2      
 130   2      
 131   2                      break;
 132   2      
 133   2              case 6: // S5 -> S0  system power on sequence
 134   2                      Oem_SysOnSequence();
 135   2                        Oem_PowSwOver5Sec_ForceShutdown();
 136   2                      break;
 137   2      
 138   2              case 7: // S3 -> S0 resume power sequence
 139   2                      Oem_SysResumeSequence();
 140   2                        Oem_PowSwOver5Sec_ForceShutdown();
 141   2                      break;
 142   2      
 143   2              case 8: // S0 -> S3  system suspend sequence
 144   2                      Oem_SysSuspendSequence();
 145   2                        Oem_PowSwOver5Sec_ForceShutdown();
 146   2                      break;
 147   2      
 148   2              case 9: // S0 -> S5 system power off sequence
 149   2      
 150   2                      Oem_SysOffSequence();
 151   2                        Oem_PowSwOver5Sec_ForceShutdown();
 152   2                      break;
 153   2      
 154   2              default:
 155   2                      SysPowState=0;
 156   2                      return;
 157   2          }
 158   1          //-------------------------------------------------------------------------
 159   1      
 160   1      }
 161          //-----------------------------------------------------------------------------
 162          
 163          //-----------------------------------------------------------------------------
 164          // Automatic Cold Boot Test Service (Suggestion: 1 Sec Hook)
 165          //-----------------------------------------------------------------------------
 166          void Oem_ColdBootTester(void)
 167          {
 168   1          if ( AutoColdBootTimer > 0 )
 169   1          {
 170   2              if ( SysPowState == _SYSTEM_S5 )
 171   2              {
 172   3                  if ( ColdBootTimer == 0x00 )
 173   3                  {
 174   4                      ColdBootTimer = AutoColdBootTimer;
 175   4                  }
 176   3                  else
 177   3                  {
 178   4                      ColdBootTimer--;
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 4   

 179   4      
 180   4                      if ( ColdBootTimer == 0x00 )
 181   4                      {
 182   5                          Oem_TriggerPowerOn();
 183   5                      }
 184   4                  }
 185   3      
 186   3              }
 187   2              else
 188   2              {
 189   3                  ColdBootTimer = AutoColdBootTimer;
 190   3      
 191   3              }
 192   2          }
 193   1      
 194   1      }
 195          //-----------------------------------------------------------------------------
 196          
 197          //-----------------------------------------------------------------------------
 198          // Power Switch Control
 199          //-----------------------------------------------------------------------------
 200          void Oem_CheckPowSwitch(void)
 201          {
 202   1          BYTE BTemp;
 203   1          if ( LockSwitchPowerOn > 0 )
 204   1          {
 205   2              LockSwitchPowerOn--;
 206   2              return;
 207   2          }
 208   1          #if PowerSW_Active
                  //InputDebounce(FLAG PIN_STATUS,FLAG _ACTIVE,BYTE Counter_ID,BYTE ReloadCnt)
                  BTemp = InputDebounce(STATE_PANSHW(),HighActive,0x00,T_POWSW_ONDB);
                  //Return_0x00:NoAcitve 0x01:Active 0x02:Active&Debounced 0x03:RepeatActive
                  #else
 213   1          BTemp = InputDebounce(STATE_PANSHW(),LowActive,0x00,T_POWSW_ONDB);
 214   1          #endif
 215   1      
 216   1          if ( BTemp == 0x02 )        // Active and Debounced
 217   1          {
 218   2              Oem_TriggerPowerOn();
 219   2          }
 220   1      
 221   1      }
 222          //-----------------------------------------------------------------------------
 223          
 224          //-----------------------------------------------------------------------------
 225          // Trigger Control System Power On
 226          //-----------------------------------------------------------------------------
 227          void Oem_TriggerPowerOn(void)
 228          {
 229   1          CtrlPowStep = 0;    //Reset Power Step Control Register
 230   1          PowSeqDelay = 0;    //Clear Sequence Delay Register
 231   1          SysPowState = _GO_POWER_ON; // Trigger S5->S0 system power on sequence
 232   1      
 233   1      }
 234          //-----------------------------------------------------------------------------
 235          
 236          //-----------------------------------------------------------------------------
 237          // Trigger Control System Power Off
 238          //-----------------------------------------------------------------------------
 239          void Oem_TriggerPowerOff(void)
 240          {
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 5   

 241   1          CtrlPowStep = 0;    //Reset Power Step Control Register
 242   1          PowSeqDelay = 0;    //Clear Sequence Delay Register
 243   1          SysPowState = _GO_POWER_OFF;    // Trigger S5 system power off sequence
 244   1          LockSwitchPowerOn = T_POWSW_LockON;    // Lock Power timer
 245   1      
 246   1      }
 247          //-----------------------------------------------------------------------------
 248          
 249          //-----------------------------------------------------------------------------
 250          // Power Switch routine to PWRBTN# Control
 251          //-----------------------------------------------------------------------------
 252          void Oem_PowSwToPWRBTN(void)
 253          {
 254   1          BYTE    BTemp;
 255   1      
 256   1          #if PowerSW_Active
                  //InputDebounce(FLAG PIN_STATUS,FLAG _ACTIVE,BYTE Counter_ID,BYTE ReloadCnt)
                  BTemp = InputDebounce(STATE_PANSHW(),HighActive,0x00,T_POWSW_ToBTN);
                  //Return_0x00:NoAcitve 0x01:Active 0x02:Active&Debounced 0x03:RepeatActive
                  #else
 261   1          BTemp = InputDebounce(STATE_PANSHW(),LowActive,0x00,T_POWSW_ToBTN);
 262   1          #endif
 263   1      
 264   1          if ( BTemp == 0x03 )
 265   1          {
 266   2              //PWRBTN_LO();
 267   2      
 268   2              #if SB_PWRBTN_DEBUG
                              RamDebug(0x5A);
                      #endif
 271   2          }
 272   1          else
 273   1          {
 274   2              //PWRBTN_HI();
 275   2          }
 276   1      
 277   1      }
 278          //-----------------------------------------------------------------------------
 279          
 280          //-----------------------------------------------------------------------------
 281          // Power Switch Interrupt Sequence Control
 282          //-----------------------------------------------------------------------------
 283          void Oem_PowSwitchIntr(void)
 284          {
 285   1          BYTE BTemp;
 286   1      
 287   1          #if PowerSW_Active
                  //InputDebounce(FLAG PIN_STATUS,FLAG _ACTIVE,BYTE Counter_ID,BYTE ReloadCnt)
                  BTemp = InputDebounce(STATE_PANSHW(),HighActive,0x00,T_POWSW_INTR);
                  //Return_0x00:NoAcitve 0x01:Active 0x02:Active&Debounced 0x03:RepeatActive
                  #else
 292   1          BTemp = InputDebounce(STATE_PANSHW(),LowActive,0x00,T_POWSW_INTR);
 293   1          #endif
 294   1          if ( BTemp == 0x02 )        // Active and Debounced
 295   1          {
 296   2              Oem_TriggerPowerOff();
 297   2          }
 298   1      
 299   1      }
 300          //-----------------------------------------------------------------------------
 301          
 302          //-----------------------------------------------------------------------------
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 6   

 303          // Power Switch Control
 304          //-----------------------------------------------------------------------------
 305          void Oem_PowSwOver5Sec(void)
 306          {
 307   1          BYTE BTemp;
 308   1          if ( (SysPowState == _SYSTEM_S4) || (SysPowState == _SYSTEM_S5) || (SysPowState == _PowrUp_S5) )
 309   1          {
 310   2              return;
 311   2          }
 312   1          #if PowerSW_Active
                  //InputDebounce(FLAG PIN_STATUS,FLAG _ACTIVE,BYTE Counter_ID,BYTE ReloadCnt)
                      BTemp = InputDebounce(STATE_PANSHW(),HighActive,0x00,T_POWSW_OVER);
                  //Return_0x00:NoAcitve 0x01:Active 0x02:Active&Debounced 0x03:RepeatActive
                  #else
 317   1              BTemp = InputDebounce(STATE_PANSHW(),LowActive,0x00,T_POWSW_OVER);
 318   1          #endif
 319   1      
 320   1          if ( BTemp == 0x03 )        // Active and Debounced
 321   1          {
 322   2              PowSwOverTimer++;
 323   2              if ( PowSwOverTimer > 1000 )
 324   2              {
 325   3                  Oem_TriggerPowerOff();
 326   3              }
 327   2          }
 328   1          else
 329   1          {
 330   2              PowSwOverTimer = 0;
 331   2          }
 332   1      
 333   1      }
 334          
 335          //-----------------------------------------------------------------------------
 336          // Check System S5 Shutdown Signal (PM_SLP_S5 or SUSC)
 337          // Usually from System South Bridge
 338          //-----------------------------------------------------------------------------
 339          void Oem_ChkS5Shutdown(void)
 340          {
 341   1          bit bTemp;
 342   1          bTemp = STATE_PM_SLP_S4();   // Get SLP_S4 Status
 343   1          if ( !bTemp )   // Low Active
 344   1          {
 345   2              Oem_TriggerPowerOff();
 346   2          }
 347   1      
 348   1      }
 349          //-----------------------------------------------------------------------------
 350          
 351          //-----------------------------------------------------------------------------
 352          // Check System S3 Suspend Signal (PM_SLP_S3 or SUSB)
 353          // Usually from System South Bridge
 354          //-----------------------------------------------------------------------------
 355          void Oem_ChkS3Suspend(void)
 356          {
 357   1          bit bTemp;
 358   1          bTemp = STATE_PM_SLP_S3();   // Get SLP_S3 Status
 359   1          if ( !bTemp )   // Low Active
 360   1          {
 361   2              CtrlPowStep = 0;    //Reset Power Step Control Register
 362   2              PowSeqDelay = 0;    //Clear Sequence Delay Register
 363   2              // Trigger S0 -> S3  system suspend power off sequence
 364   2              SysPowState = _GO_SUSPNED_OFF;
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 7   

 365   2          }
 366   1      
 367   1      }
 368          //-----------------------------------------------------------------------------
 369          
 370          //-----------------------------------------------------------------------------
 371          // Check System S3 Resume Signal (PM_SLP_S3 or SUSB)
 372          // Usually from System South Bridge
 373          //-----------------------------------------------------------------------------
 374          void Oem_ChkS3WakeUp(void)
 375          {
 376   1          bit bTemp;
 377   1          bTemp = STATE_PM_SLP_S3();   // Get SLP_S3 Status
 378   1          if ( bTemp )    // Hi->Wake-Up
 379   1          {
 380   2              CtrlPowStep = 0;    //Reset Power Step Control Register
 381   2              PowSeqDelay = 0;    //Clear Sequence Delay Register
 382   2              // Trigger S3 -> S0  system resume power on sequence
 383   2              SysPowState = _GO_RESUME_ON;
 384   2          }
 385   1      
 386   1      }
 387          //-----------------------------------------------------------------------------
 388          
 389          //-----------------------------------------------------------------------------
 390          // System Power On RAM & Register configuration
 391          //-----------------------------------------------------------------------------
 392          void Oem_SysOnInit(void)
 393          {
 394   1              
 395   1          SysPowState = _SYSTEM_S0;   // Set System S0
 396   1      
 397   1          LED_S0_Status = 0;
 398   1          _CORE_PMFLAG = 0;
 399   1          CORE_PMFLAG_S0 = 1;
 400   1              EC_start();
 401   1      }
 402          //-----------------------------------------------------------------------------
 403          
 404          
 405          //-----------------------------------------------------------------------------
 406          // System Power Off RAM & Register configuration
 407          //-----------------------------------------------------------------------------
 408          void Oem_SysOffInit(void)
 409          {
 410   1          SysPowState = _SYSTEM_S5;   // Set System S5
 411   1      
 412   1          _CORE_PMFLAG = 0;
 413   1          CORE_PMFLAG_S5 = 1;
 414   1          CtrlPowStep = 0;    //Reset Power Step Control Register
 415   1          PowSeqDelay = 0;    //Clear Sequence Delay Register
 416   1          
 417   1              #if     Reset_PMC_UnderS5
                      RSTC1 = BIT2;   //Reset PMC
                      Index_07H = 0x11;
                      Index_30H = 0x01;
                      Index_07H = 0x00;
                      SET_MASK(IER3, Int_PMCIBF);
                      ISR3 = Int_PMCIBF;
                      SET_BIT(PM1CTL, 0);
              
                      //PMC2  
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 8   

                      Index_07H = 0x12;
                      Index_30H = 0x01;
                      Index_07H = 0x00;
                      SET_MASK(IER3, Int_PMC2IBF);
                      ISR3 = Int_PMC2IBF;
                      SET_BIT(PM2CTL, 0);
                      #endif
 434   1              
 435   1      }
 436          //-----------------------------------------------------------------------------
 437          
 438          //-----------------------------------------------------------------------------
 439          // System Suspend Power Off RAM & Register configuration
 440          //-----------------------------------------------------------------------------
 441          void Oem_SysSuspendInit(void)
 442          {
 443   1          SysPowState = _SYSTEM_S3;   // Set System S3
 444   1      
 445   1          _CORE_PMFLAG = 0;
 446   1          CORE_PMFLAG_S3 = 1;
 447   1      
 448   1      
 449   1      }
 450          //-----------------------------------------------------------------------------
 451          
 452          //-----------------------------------------------------------------------------
 453          // System Suspend Power On RAM & Register configuration
 454          //-----------------------------------------------------------------------------
 455          void Oem_SysResumeInit(void)
 456          {
 457   1          SysPowState = _SYSTEM_S0;   // Set System S0
 458   1      
 459   1          _CORE_PMFLAG = 0;
 460   1          CORE_PMFLAG_S0 = 1;
 461   1      }
 462          
 463          //-----------------------------------------------------------------------------
 464          // Init Share Memory Register
 465          //-----------------------------------------------------------------------------
 466          void InitShareMemory(void)
 467          {
 468   1          //UCCTRLR = 0x83;   //ATi Chipset Need (INTEL don't)
 469   1      //    SWCTL2 = 0;         //Set sysetm power on
 470   1          FMSSR = 0x0F;       //For 1M Bytes Share Rom
 471   1          SET_BIT(FPCFG,4);   //Enable LPC Bust mode
 472   1      
 473   1      }
 474          
 475          //-----------------------------------------------------------------------------
 476          // FUNCTION: System Power On Sequence (Turns On System Power)
 477          // TimeHook: 5mSec
 478          //-----------------------------------------------------------------------------
 479          void Oem_SysOnSequence(void)
 480          {
 481   1          //bit  bTemp;
 482   1          //BYTE BTemp;
 483   1          //-------------------------------------------------------------------------
 484   1          if ( PowSeqDelay > 4 )
 485   1          {
 486   2              PowSeqDelay-=5; //5mSec count base
 487   2              if ( PowSeqDelay < 4 )
 488   2              {
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 9   

 489   3                  PowSeqDelay=0;
 490   3              }
 491   2              else
 492   2              {
 493   3                  return;
 494   3              }
 495   2          }
 496   1          //-------------------------------------------------------------------------
 497   1          //Power On Sequence step control
 498   1          //-------------------------------------------------------------------------
 499   1          switch (CtrlPowStep)    //Step 5mSec
 500   1          {
 501   2      
 502   2              case 0:
 503   2      
 504   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE0) ;
                              #endif
 507   2                      
 508   2                      PowSeqDelay = 15;
 509   2                      break;
 510   2                      
 511   2              case 1:
 512   2      
 513   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE1) ;
                              #endif
 516   2                                      
 517   2                      PowSeqDelay = 150;      //delay 110ms           
 518   2                      break;
 519   2      
 520   2      
 521   2              case 2:
 522   2      
 523   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE2) ;
                              #endif
 526   2                      
 527   2                      PowSeqDelay = 80 ;
 528   2                      break ;
 529   2      
 530   2              case 3:
 531   2      
 532   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE3) ;
                              #endif
 535   2                      
 536   2                      break;
 537   2      
 538   2              case 4:
 539   2      
 540   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE4) ;
                              #endif
 543   2                      
 544   2                      break;
 545   2      
 546   2              case 5:
 547   2      
 548   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE5) ;
                              #endif
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 10  

 551   2      
 552   2                      PowSeqDelay = 5 ;               
 553   2                      break;
 554   2      
 555   2              case 6:
 556   2      
 557   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE6) ;
                              #endif
 560   2                      
 561   2                      PowSeqDelay = 5 ;
 562   2                      break ;
 563   2      
 564   2              case 7:
 565   2      
 566   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE7) ;
                              #endif
 569   2      
 570   2                      PowSeqDelay = 5 ;
 571   2                      break ;
 572   2      
 573   2              case 8:
 574   2      
 575   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE8) ;
                              #endif
 578   2                      
 579   2                      PowSeqDelay = 10 ;
 580   2                      break ;
 581   2      
 582   2              case 9:
 583   2      
 584   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xE9) ;
                              #endif
 587   2      
 588   2                      PowSeqDelay = 10 ;
 589   2      
 590   2                      break ;
 591   2      
 592   2      
 593   2              case 10:
 594   2      
 595   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xEA) ;
                              #endif
 598   2                      
 599   2                      PowSeqDelay = 10 ;
 600   2                      break ;
 601   2      
 602   2      
 603   2      
 604   2              case 11:
 605   2      
 606   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xEB) ;
                              #endif
 609   2      
 610   2                      Oem_SysOnInit();
 611   2      
 612   2      
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 11  

 613   2                      break;
 614   2      
 615   2              default:
 616   2                      CtrlPowStep=0;
 617   2                      break;
 618   2          }
 619   1      
 620   1          //-------------------------------------------------------------------------
 621   1      
 622   1              CtrlPowStep++;
 623   1      
 624   1          //-------------------------------------------------------------------------
 625   1      
 626   1      }
 627          
 628          
 629          //-----------------------------------------------------------------------------
 630          // FUNCTION: System Resume from S3 Sequence (Turns On Suspend Power)
 631          // TimeHook: 5mSec
 632          //-----------------------------------------------------------------------------
 633          void Oem_SysResumeSequence(void)
 634          {
 635   1          //bit bTemp;
 636   1      
 637   1          //-------------------------------------------------------------------------
 638   1          if ( PowSeqDelay > 4 )
 639   1          {
 640   2              PowSeqDelay-=5; //5mSec count base
 641   2      
 642   2              if ( PowSeqDelay < 4 )
 643   2              {
 644   3                  PowSeqDelay=0;
 645   3              }
 646   2              else
 647   2              {
 648   3                  return;
 649   3              }
 650   2          }
 651   1          //-------------------------------------------------------------------------
 652   1          //System Resume Sequence step control
 653   1          //-------------------------------------------------------------------------
 654   1          switch (CtrlPowStep)    //Step 5mSec
 655   1          {
 656   2      
 657   2              case 0:
 658   2      
 659   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC0) ;
                              #endif
 662   2      
 663   2                      PowSeqDelay = 5 ;
 664   2      
 665   2                      break;
 666   2      
 667   2      
 668   2              case 1:
 669   2      
 670   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC1) ;
                              #endif
 673   2      
 674   2      
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 12  

 675   2                      PowSeqDelay = 5 ;
 676   2                      
 677   2                      break;
 678   2      
 679   2      
 680   2              case 2:
 681   2      
 682   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC2) ;
                              #endif
 685   2      
 686   2                      
 687   2                      PowSeqDelay = 5 ;
 688   2      
 689   2                      break;
 690   2      
 691   2              case 3:
 692   2      
 693   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC3) ;
                              #endif
 696   2      
 697   2                      PowSeqDelay = 5 ;
 698   2      
 699   2                      break;
 700   2      
 701   2              case 4:
 702   2      
 703   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC4) ;
                              #endif
 706   2      
 707   2                      PowSeqDelay = 10 ;
 708   2      
 709   2                      break;
 710   2      
 711   2      
 712   2      
 713   2      
 714   2              case 5:
 715   2      
 716   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC5) ;
                              #endif
 719   2      
 720   2                      PowSeqDelay = 10 ;
 721   2      
 722   2                      break;
 723   2      
 724   2              case 6:
 725   2      
 726   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC6) ;
                              #endif
 729   2      
 730   2                      break ;
 731   2      
 732   2              case 7:
 733   2      
 734   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xC7) ;
                              #endif
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 13  

 737   2                      
 738   2                      break;
 739   2      
 740   2      
 741   2              case 8:
 742   2      
 743   2                      #if PWR_ON_SEQ_DEBUG
                              RamDebug(0xC8) ;
                              #endif
 746   2                      
 747   2                      break;
 748   2      
 749   2      
 750   2              case 9:
 751   2      
 752   2                      #if RESUME_SEQ_DEBUG
                              RamDebug(0xC9) ;
                              #endif
 755   2      
 756   2                      Oem_SysOnInit();
 757   2      
 758   2                      break ;
 759   2      
 760   2              default:
 761   2                      CtrlPowStep=0;
 762   2                      break;
 763   2          }
 764   1      
 765   1          //-------------------------------------------------------------------------
 766   1      
 767   1              CtrlPowStep++;
 768   1      
 769   1          //-------------------------------------------------------------------------
 770   1      
 771   1      }
 772          
 773          //-----------------------------------------------------------------------------
 774          // FUNCTION: Force System Power Off Sequence
 775          //
 776          //-----------------------------------------------------------------------------
 777          void Oem_ForceSystemOff(void)
 778          {
 779   1          CtrlPowStep = 0;
 780   1          while(1)
 781   1          {
 782   2              vDelay1ms(5);   // Delay 5ms
 783   2              Oem_SysOffSequence();
 784   2              if( CtrlPowStep == 0 )
 785   2              {
 786   3                  break;
 787   3              }
 788   2          }
 789   1      
 790   1      }
 791          //-----------------------------------------------------------------------------
 792          
 793          //-----------------------------------------------------------------------------
 794          // FUNCTION: System Power Off Sequence
 795          // TimeHook: 5mSec
 796          //-----------------------------------------------------------------------------
 797          void Oem_SysOffSequence(void)
 798          {
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 14  

 799   1          //bit   bTemp;
 800   1          //-------------------------------------------------------------------------
 801   1          if ( PowSeqDelay > 4 )
 802   1          {
 803   2              PowSeqDelay-=5; //5mSec count base
 804   2      
 805   2              if ( PowSeqDelay < 4 )
 806   2              {
 807   3                  PowSeqDelay=0;
 808   3              }
 809   2              else
 810   2              {
 811   3                  return;
 812   3              }
 813   2          }
 814   1          //-------------------------------------------------------------------------
 815   1          // System Off step contrl
 816   1          //-------------------------------------------------------------------------
 817   1          switch (CtrlPowStep)    //Step 5mSec
 818   1          {
 819   2              case 0:
 820   2                              
 821   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF0) ;
                              #endif
 824   2                      
 825   2                      break;
 826   2                                      
 827   2      
 828   2              case 1:
 829   2                              
 830   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF1) ;
                              #endif
 833   2      
 834   2                      break;
 835   2      
 836   2      
 837   2              case 2:
 838   2                              
 839   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF2) ;
                              #endif
 842   2      
 843   2                      break;
 844   2      
 845   2              case 3:
 846   2                              
 847   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF3) ;
                              #endif
 850   2      
 851   2      
 852   2                      PowSeqDelay = 10 ;
 853   2                      break;
 854   2      
 855   2      
 856   2              case 4:
 857   2                              
 858   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF4) ;
                              #endif
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 15  

 861   2      
 862   2      
 863   2                      
 864   2                      PowSeqDelay = 10 ;
 865   2                      break;
 866   2                                      
 867   2              case 5:
 868   2      
 869   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF5) ;
                              #endif
 872   2      
 873   2                      
 874   2                      
 875   2                      break;
 876   2                                      
 877   2              case 6:
 878   2      
 879   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF6) ;
                              #endif
 882   2                      
 883   2                      
 884   2                     break;
 885   2      
 886   2                                      
 887   2              case 7:
 888   2      
 889   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF7) ;
                              #endif
 892   2                      
 893   2                      PowSeqDelay = 5 ;
 894   2      
 895   2                      break ;
 896   2                      
 897   2              case 8:
 898   2      
 899   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF8) ;
                              #endif
 902   2      
 903   2                      
 904   2                      PowSeqDelay = 5 ;
 905   2      
 906   2                      break ;
 907   2      
 908   2              case 9:
 909   2      
 910   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xF9) ;
                              #endif
 913   2      
 914   2                      
 915   2                      PowSeqDelay = 5 ;
 916   2      
 917   2                      break ;
 918   2      
 919   2              case 10:
 920   2      
 921   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xFA) ;
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 16  

                              #endif
 924   2      
 925   2      
 926   2                      PowSeqDelay = 5 ;
 927   2      
 928   2                      break ;
 929   2      
 930   2      
 931   2              case 11:
 932   2      
 933   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xFB) ;
                              #endif
 936   2      
 937   2                      
 938   2                      PowSeqDelay = 5 ;
 939   2      
 940   2                      break ;
 941   2      
 942   2      
 943   2              case 12:
 944   2      
 945   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xFC) ;
                              #endif
 948   2              
 949   2                      
 950   2                      PowSeqDelay = 5 ;
 951   2      
 952   2                      break ;
 953   2      
 954   2      
 955   2              case 13:
 956   2      
 957   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xFD) ;
                              #endif
 960   2      
 961   2                      
 962   2                      PowSeqDelay = 5 ;
 963   2      
 964   2                      break ;
 965   2      
 966   2      
 967   2              case 14:
 968   2      
 969   2                      
 970   2                      #if PWR_OFF_SEQ_DEBUG
                              RamDebug(0xFE) ;
                              #endif
 973   2      
 974   2                      Oem_SysOffInit();
 975   2      
 976   2                      break;
 977   2                                      
 978   2              default:
 979   2                      CtrlPowStep=0;
 980   2                      return;
 981   2          }
 982   1      
 983   1          //-------------------------------------------------------------------------
 984   1      
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 17  

 985   1              CtrlPowStep++;
 986   1      
 987   1          //-------------------------------------------------------------------------
 988   1      
 989   1      }
 990          //-----------------------------------------------------------------------------
 991          
 992          //-----------------------------------------------------------------------------
 993          // FUNCTION: System Suspend Power Off Sequence
 994          // TimeHook: 5mSec
 995          //-----------------------------------------------------------------------------
 996          void Oem_SysSuspendSequence(void)
 997          {
 998   1          //bit   bTemp;
 999   1      
1000   1          //-------------------------------------------------------------------------
1001   1          if ( PowSeqDelay > 4 )
1002   1          {
1003   2              PowSeqDelay-=5; //5mSec count base
1004   2      
1005   2              if ( PowSeqDelay < 4 )
1006   2              {
1007   3                  PowSeqDelay=0;
1008   3              }
1009   2              else
1010   2              {
1011   3                  return;
1012   3              }
1013   2          }
1014   1          //-------------------------------------------------------------------------
1015   1          //System Suspend step control
1016   1          //-------------------------------------------------------------------------
1017   1          switch (CtrlPowStep)    //Step 5mSec
1018   1          {
1019   2              
1020   2              case 0:
1021   2      
1022   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB0) ;
                              #endif
1025   2      
1026   2                      
1027   2                      break ;
1028   2      
1029   2              case 1:
1030   2      
1031   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB1) ;
                              #endif
1034   2                      
1035   2                      
1036   2      
1037   2                      break;
1038   2                      
1039   2              case 2:
1040   2      
1041   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB2) ;
                              #endif
1044   2      
1045   2                      break;
1046   2      
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 18  

1047   2              case 3:
1048   2      
1049   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB3) ;
                              #endif
1052   2                      
1053   2      
1054   2                      break;
1055   2      
1056   2              case 4:
1057   2                              
1058   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB4) ;
                              #endif
1061   2      
1062   2      
1063   2                      PowSeqDelay = 10;
1064   2                      break;
1065   2      
1066   2              case 5:
1067   2                              
1068   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB5) ;
                              #endif
1071   2                      
1072   2      
1073   2                      PowSeqDelay = 10;
1074   2                      break;
1075   2      
1076   2              case 6:
1077   2                              
1078   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB6) ;
                              #endif
1081   2                      
1082   2      
1083   2                      break;
1084   2      
1085   2              case 7:
1086   2                              
1087   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB7) ;
                              #endif
1090   2                      
1091   2                      
1092   2      
1093   2                      break;
1094   2      
1095   2              case 8:
1096   2                              
1097   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB8) ;
                              #endif
1100   2                      
1101   2                      
1102   2      
1103   2                      break;
1104   2      
1105   2              case 9:
1106   2                              
1107   2                      #if SUSPEND_SEQ_DEBUG
                              RamDebug(0xB9) ;
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 19  

                              #endif
1110   2                      
1111   2                      Oem_SysSuspendInit();
1112   2      
1113   2                      break;
1114   2                                      
1115   2              default:
1116   2                      CtrlPowStep=0;
1117   2                      break;
1118   2          }
1119   1      
1120   1          //-------------------------------------------------------------------------
1121   1      
1122   1              CtrlPowStep++;
1123   1      
1124   1          //-------------------------------------------------------------------------
1125   1      
1126   1      }
1127          //-----------------------------------------------------------------------------
1128          
1129          
1130          void Oem_PowSwOver5Sec_ForceShutdown(void)
1131          {
1132   1              BYTE BTemp;
1133   1              #if PowerSW_Active
                      //InputDebounce(FLAG PIN_STATUS,FLAG _ACTIVE,BYTE Counter_ID,BYTE ReloadCnt)
                      BTemp = InputDebounce(STATE_PANSHW(),HighActive,0x00,T_POWSW_OVER);
                      //Return_0x00:NoAcitve 0x01:Active 0x02:Active&Debounced 0x03:RepeatActive
                      #else
1138   1              BTemp = InputDebounce(STATE_PANSHW(),LowActive,0x00,T_POWSW_OVER);
1139   1              #endif
1140   1      
1141   1              if ( BTemp == 0x03 )        // Active and Debounced
1142   1              {
1143   2                      PowSwOverTimer++;
1144   2                      if ( PowSwOverTimer > 1500 )
1145   2                      {
1146   3      
1147   3                              
1148   3                              PowSwOverTimer = 0;
1149   3                              Oem_SysOffInit();
1150   3                      }
1151   2              }
1152   1              else
1153   1              {
1154   2                      PowSwOverTimer = 0;
1155   2              }
1156   1      }
1157          
1158          
1159          void Check_Power_State(void)
1160          {
1161   1              if(STATE_PM_SLP_S4() == HIGH)   //Not S5
1162   1              {
1163   2      
1164   2                      if(STATE_PM_SLP_S3() == HIGH )  //S0
1165   2                      {
1166   3                              if( (SysPowState == _SYSTEM_S5) ||(SysPowState == _PowrUp_S5) || (SysPowState == _SYSTEM_S4)  ) //S4/S5
             - -> S0
1167   3                              {
1168   4      
1169   4                                      Oem_SysOnInit();
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 20  

1170   4                                      
1171   4                                      CLR_BIT(Index_23H, 0);  //Enable 48M clock                              
1172   4                              }
1173   3                              else if( (SysPowState == _SYSTEM_S3) )  //S3->S0+
1174   3                              {
1175   4                                      Oem_SysResumeInit();
1176   4                                      CLR_BIT(Index_23H, 0);  //Enable 48M clock      
1177   4                                      //J74_002++>>
1178   4                                      EC_start();
1179   4                                      //J74_002++>>
1180   4                                      
1181   4                              }
1182   3                              
1183   3                      }
1184   2                      else            //S3
1185   2                      {
1186   3                              if( SysPowState == _SYSTEM_S0 ) //S0->S3
1187   3                              {
1188   4                                      #ifdef Check_SUSB_Twice
1189   4                                      SysPowState = _Ready_to_S3;
1190   4                                      #else
                                              Oem_SysSuspendInit();   
                                              SET_BIT(Index_23H,0);   //Disable 48M clock
                                              #endif
1194   4      
1195   4                              }
1196   3                              #ifdef Check_SUSB_Twice
1197   3                              else if( SysPowState == _Ready_to_S3 )  //S0->S3 (ready to S3)
1198   3                              {
1199   4                                      Oem_SysSuspendInit();   
1200   4                                      SET_BIT(Index_23H,0);   //Disable 48M clock
1201   4                              }
1202   3                              #endif
1203   3                              
1204   3                      }
1205   2                      
1206   2              }
1207   1              else                    //S4 or S5
1208   1              {
1209   2                      #ifdef Check_SUSB_Twice
1210   2                      if( (SysPowState == _SYSTEM_S0) ||(SysPowState == _SYSTEM_S3) ||(SysPowState == _Ready_to_S3) ) //S0/S3 
             --> S4/S5
1211   2                      #else
                              if( (SysPowState == _SYSTEM_S0) ||(SysPowState == _SYSTEM_S3) ) //S0/S3 -> S4/S5
                              #endif
1214   2                      {
1215   3                      
1216   3                              Oem_SysOffInit();
1217   3                              SET_BIT(Index_23H,0);   //Disable 48M clock
1218   3                              
1219   3                      }
1220   2              }
1221   1              
1222   1      }
1223          
1224          //power led
1225          const WORD code PowerLEDPattern[]= 
1226          {
1227                  //--------------------------------------------------------------------------
1228                  //      S0      S3      S4      S5      index4  index5                                           
1229                  //--------------------------------------------------------------------------
1230                          0xFFFF, 0x5555, 0x0000, 0x0000, 0x0000, 0x0000,         //      Power LED1
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 21  

1231          };
1232          
1233          //----------------------------------------------------------------------------
1234          // Turn on/off LEDs according to machine status.
1235          // Executed once per 1 sec
1236          // for example:
1237          //               ->BIT14        
1238          //              1010101010101010
1239          //              0101010101010101
1240          //                                <-BIT3                                
1241          //----------------------------------------------------------------------------
1242          void ProcessLED(void) 
1243          {
1244   1              BYTE bat_index, pwr_index;   
1245   1          
1246   1              LED_FLASH_CNT <<= 1;
1247   1              if(LED_FLASH_CNT == 0)
1248   1                      LED_FLASH_CNT=0x0001;
1249   1      
1250   1          /* Power LED control method */
1251   1          pwr_index=0;                // pre-set S0                  
1252   1          
1253   1              if(SystemIsS5)              // pre-set S5    
1254   1              {
1255   2                      pwr_index=3;
1256   2              }
1257   1              if(SystemIsS4)              // pre-set S4   
1258   1              {
1259   2                      pwr_index=2;
1260   2              }
1261   1              if(SystemIsS3)              // pre-set S3    
1262   1              {
1263   2                      pwr_index=1;
1264   2              }
1265   1      
1266   1              if(PowerLEDPattern[pwr_index] & LED_FLASH_CNT)  // setup power LED
1267   1              {       
1268   2                      PWR_LED_ON();
1269   2              } 
1270   1              else 
1271   1              {       
1272   2                      PWR_LED_OFF();
1273   2              }
1274   1          
1275   1      
1276   1      }
1277          /*-----------------------------------------------------------------------------
1278           * End
1279           *---------------------------------------------------------------------------*/
1280          
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 22  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION Com00C3 (BEGIN)
0000         L?0196:
0000         L?0197:
0000 74FF              MOV     A,#0FFH
0002 75F0FB            MOV     B,#0FBH
0005 120000      E     LCALL   ?C?IILDX
0008 C3                CLR     C
0009         L?0198:
0009 900000      E     MOV     DPTR,#PowSeqDelay+01H
000C E0                MOVX    A,@DPTR
000D 9404              SUBB    A,#04H
000F 900000      E     MOV     DPTR,#PowSeqDelay
0012 E0                MOVX    A,@DPTR
0013 9400              SUBB    A,#00H
0015 22                RET     
0016         L?0199:
0016         L?0200:
0016 E4                CLR     A
0017 900000      E     MOV     DPTR,#CtrlPowStep
001A F0                MOVX    @DPTR,A
001B 900000      E     MOV     DPTR,#PowSeqDelay
001E F0                MOVX    @DPTR,A
001F A3                INC     DPTR
0020 F0                MOVX    @DPTR,A
0021 900000      E     MOV     DPTR,#SysPowState
0024 22                RET     
0025         L?0201:
0025         L?0202:
0025 900000      E     MOV     DPTR,#PowSeqDelay
0028 E4                CLR     A
0029 F0                MOVX    @DPTR,A
002A A3                INC     DPTR
002B 22                RET     
002C         L?0203:
002C 740A              MOV     A,#0AH
002E         L?0204:
002E 900000      E     MOV     DPTR,#?_InputDebounce?BYTE+03H
0031 F0                MOVX    @DPTR,A
0032 E4                CLR     A
0033 FB                MOV     R3,A
0034 FD                MOV     R5,A
0035 22                RET     
0036         L?0205:
0036 900000      E     MOV     DPTR,#PowSwOverTimer
0039 E4                CLR     A
003A 75F001            MOV     B,#01H
003D 120000      E     LCALL   ?C?IILDX
0040 D3                SETB    C
0041 900000      E     MOV     DPTR,#PowSwOverTimer+01H
0044 E0                MOVX    A,@DPTR
0045 22                RET     
0046         L?0206:
0046 900000      E     MOV     DPTR,#SysPowState
0049         L?0207:
0049 F0                MOVX    @DPTR,A
004A E4                CLR     A
004B 7800        E     MOV     R0,#LOW CORE_PMFLAG
004D F6                MOV     @R0,A
004E E6                MOV     A,@R0
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 23  

004F 22                RET     
0050         L?0208:
0050         L?0209:
0050 900000      E     MOV     DPTR,#CtrlPowStep
0053 E0                MOVX    A,@DPTR
0054 04                INC     A
0055 F0                MOVX    @DPTR,A
0056 22                RET     
0057         L?0210:
0057 900000      E     MOV     DPTR,#?_InputDebounce?BYTE+03H
005A 7432              MOV     A,#032H
005C F0                MOVX    @DPTR,A
005D E4                CLR     A
005E FB                MOV     R3,A
005F FD                MOV     R5,A
0060 22                RET     
             ; FUNCTION Com00C3 (END)

             ; FUNCTION Oem_SysPowerContrl (BEGIN)
                                           ; SOURCE LINE # 76
                                           ; SOURCE LINE # 77
                                           ; SOURCE LINE # 78
0000 900000      E     MOV     DPTR,#SysPowState
0003 E0                MOVX    A,@DPTR
0004 120000      E     LCALL   ?C?CCASE
0007 0000        R     DW      ?C0002
0009 00                DB      00H
000A 0000        R     DW      ?C0003
000C 01                DB      01H
000D 0000        R     DW      ?C0018
000F 02                DB      02H
0010 0000        R     DW      ?C0006
0012 03                DB      03H
0013 0000        R     DW      ?C0009
0015 04                DB      04H
0016 0000        R     DW      ?C0009
0018 05                DB      05H
0019 0000        R     DW      ?C0013
001B 06                DB      06H
001C 0000        R     DW      ?C0014
001E 07                DB      07H
001F 0000        R     DW      ?C0015
0021 08                DB      08H
0022 0000        R     DW      ?C0016
0024 09                DB      09H
0025 0000              DW      00H
0027 0000        R     DW      ?C0017
                                           ; SOURCE LINE # 79
                                           ; SOURCE LINE # 80
0029         ?C0002:
                                           ; SOURCE LINE # 81
0029 020000      R     LJMP    Oem_CheckPowSwitch
                                           ; SOURCE LINE # 84
                                           ; SOURCE LINE # 86
002C         ?C0003:
                                           ; SOURCE LINE # 88
002C 120000      R     LCALL   Oem_PowSwToPWRBTN
                                           ; SOURCE LINE # 90
002F 120000      R     LCALL   Oem_PowSwOver5Sec
                                           ; SOURCE LINE # 93
0032 120000      R     LCALL   Oem_ChkS5Shutdown
                                           ; SOURCE LINE # 95
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 24  

0035 900000      E     MOV     DPTR,#SysPowState
0038 E0                MOVX    A,@DPTR
0039 B40103            CJNE    A,#01H,?C0004
                                           ; SOURCE LINE # 96
                                           ; SOURCE LINE # 97
003C 120000      R     LCALL   Oem_ChkS3Suspend
                                           ; SOURCE LINE # 98
003F         ?C0004:
                                           ; SOURCE LINE # 100
                                           ; SOURCE LINE # 102
003F 803B              SJMP    ?C0176
                                           ; SOURCE LINE # 104
                                           ; SOURCE LINE # 106
                                           ; SOURCE LINE # 108
0041         ?C0006:
                                           ; SOURCE LINE # 109
0041 120000      R     LCALL   Oem_PowSwToPWRBTN
                                           ; SOURCE LINE # 111
0044 120000      R     LCALL   Oem_ChkS3WakeUp
                                           ; SOURCE LINE # 113
0047 900000      E     MOV     DPTR,#SysPowState
004A E0                MOVX    A,@DPTR
004B 6403              XRL     A,#03H
004D 7035              JNZ     ?C0018
                                           ; SOURCE LINE # 114
                                           ; SOURCE LINE # 115
004F 020000      R     LJMP    Oem_ChkS5Shutdown
                                           ; SOURCE LINE # 116
                                           ; SOURCE LINE # 117
                                           ; SOURCE LINE # 119
                                           ; SOURCE LINE # 121
0052         ?C0009:
                                           ; SOURCE LINE # 123
0052 120000      R     LCALL   Oem_CheckPowSwitch
                                           ; SOURCE LINE # 125
0055 900000      E     MOV     DPTR,#GPIO_5x
0058 E0                MOVX    A,@DPTR
0059 30E304            JNB     ACC.3,?C0011
005C 7F01              MOV     R7,#01H
005E 8002              SJMP    ?C0012
0060         ?C0011:
0060 7F00              MOV     R7,#00H
0062         ?C0012:
0062 EF                MOV     A,R7
0063 6401              XRL     A,#01H
0065 701D              JNZ     ?C0018
                                           ; SOURCE LINE # 126
                                           ; SOURCE LINE # 127
0067 020000      R     LJMP    Oem_TriggerPowerOn
                                           ; SOURCE LINE # 128
                                           ; SOURCE LINE # 131
                                           ; SOURCE LINE # 133
006A         ?C0013:
                                           ; SOURCE LINE # 134
006A 120000      R     LCALL   Oem_SysOnSequence
                                           ; SOURCE LINE # 135
006D         ?C0173:
                                           ; SOURCE LINE # 136
006D 800D              SJMP    ?C0176
                                           ; SOURCE LINE # 138
006F         ?C0014:
                                           ; SOURCE LINE # 139
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 25  

006F 120000      R     LCALL   Oem_SysResumeSequence
                                           ; SOURCE LINE # 140
0072         ?C0174:
                                           ; SOURCE LINE # 141
0072 8008              SJMP    ?C0176
                                           ; SOURCE LINE # 143
0074         ?C0015:
                                           ; SOURCE LINE # 144
0074 120000      R     LCALL   Oem_SysSuspendSequence
                                           ; SOURCE LINE # 145
0077         ?C0175:
                                           ; SOURCE LINE # 146
0077 8003              SJMP    ?C0176
                                           ; SOURCE LINE # 148
0079         ?C0016:
                                           ; SOURCE LINE # 150
0079 120000      R     LCALL   Oem_SysOffSequence
                                           ; SOURCE LINE # 151
007C         ?C0176:
007C 020000      R     LJMP    Oem_PowSwOver5Sec_ForceShutdown
                                           ; SOURCE LINE # 152
                                           ; SOURCE LINE # 154
007F         ?C0017:
                                           ; SOURCE LINE # 155
007F E4                CLR     A
0080 900000      E     MOV     DPTR,#SysPowState
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 160
0084         ?C0018:
0084 22                RET     
             ; FUNCTION Oem_SysPowerContrl (END)

             ; FUNCTION Oem_ColdBootTester (BEGIN)
                                           ; SOURCE LINE # 166
                                           ; SOURCE LINE # 167
                                           ; SOURCE LINE # 168
0000 900000      E     MOV     DPTR,#AutoColdBootTimer
0003 E0                MOVX    A,@DPTR
0004 D3                SETB    C
0005 9400              SUBB    A,#00H
0007 4023              JC      ?C0025
                                           ; SOURCE LINE # 169
                                           ; SOURCE LINE # 170
0009 900000      E     MOV     DPTR,#SysPowState
000C E0                MOVX    A,@DPTR
000D B40514            CJNE    A,#05H,?C0020
                                           ; SOURCE LINE # 171
                                           ; SOURCE LINE # 172
0010 900000      E     MOV     DPTR,#ColdBootTimer
0013 E0                MOVX    A,@DPTR
0014 7002              JNZ     ?C0021
                                           ; SOURCE LINE # 173
                                           ; SOURCE LINE # 174
                                           ; SOURCE LINE # 175
0016 800C              SJMP    ?C0177
0018         ?C0021:
                                           ; SOURCE LINE # 177
                                           ; SOURCE LINE # 178
0018 900000      E     MOV     DPTR,#ColdBootTimer
001B E0                MOVX    A,@DPTR
001C 14                DEC     A
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 26  

001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 180
001E E0                MOVX    A,@DPTR
001F 700B              JNZ     ?C0025
                                           ; SOURCE LINE # 181
                                           ; SOURCE LINE # 182
0021 020000      R     LJMP    Oem_TriggerPowerOn
                                           ; SOURCE LINE # 183
                                           ; SOURCE LINE # 184
                                           ; SOURCE LINE # 186
0024         ?C0020:
                                           ; SOURCE LINE # 188
                                           ; SOURCE LINE # 189
0024         ?C0177:
0024 900000      E     MOV     DPTR,#AutoColdBootTimer
0027 E0                MOVX    A,@DPTR
0028 900000      E     MOV     DPTR,#ColdBootTimer
002B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 191
                                           ; SOURCE LINE # 192
                                           ; SOURCE LINE # 194
002C         ?C0025:
002C 22                RET     
             ; FUNCTION Oem_ColdBootTester (END)

             ; FUNCTION Oem_CheckPowSwitch (BEGIN)
                                           ; SOURCE LINE # 200
                                           ; SOURCE LINE # 201
                                           ; SOURCE LINE # 203
0000 D3                SETB    C
0001 900000      E     MOV     DPTR,#LockSwitchPowerOn+01H
0004 E0                MOVX    A,@DPTR
0005 9400              SUBB    A,#00H
0007 900000      E     MOV     DPTR,#LockSwitchPowerOn
000A E0                MOVX    A,@DPTR
000B 9400              SUBB    A,#00H
000D 4007              JC      ?C0026
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
000F 74FF              MOV     A,#0FFH
0011 F5F0              MOV     B,A
0013 020000      E     LJMP    ?C?IILDX
                                           ; SOURCE LINE # 207
0016         ?C0026:
                                           ; SOURCE LINE # 213
0016 900000      E     MOV     DPTR,#GPIO_4x
0019 E0                MOVX    A,@DPTR
001A 30E304            JNB     ACC.3,?C0028
001D 7F01              MOV     R7,#01H
001F 8002              SJMP    ?C0029
0021         ?C0028:
0021 7F00              MOV     R7,#00H
0023         ?C0029:
0023 120000      R     LCALL   L?0203
0026 120000      E     LCALL   _InputDebounce
;---- Variable 'BTemp' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 216
0029 EF                MOV     A,R7
002A B40203            CJNE    A,#02H,?C0027
                                           ; SOURCE LINE # 217
                                           ; SOURCE LINE # 218
002D 120000      R     LCALL   Oem_TriggerPowerOn
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 27  

                                           ; SOURCE LINE # 219
                                           ; SOURCE LINE # 221
0030         ?C0027:
0030 22                RET     
             ; FUNCTION Oem_CheckPowSwitch (END)

             ; FUNCTION Oem_TriggerPowerOn (BEGIN)
                                           ; SOURCE LINE # 227
                                           ; SOURCE LINE # 228
                                           ; SOURCE LINE # 229
                                           ; SOURCE LINE # 230
                                           ; SOURCE LINE # 231
0000 120000      R     LCALL   L?0199
0003 7406              MOV     A,#06H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 233
0006 22                RET     
             ; FUNCTION Oem_TriggerPowerOn (END)

             ; FUNCTION Oem_TriggerPowerOff (BEGIN)
                                           ; SOURCE LINE # 239
                                           ; SOURCE LINE # 240
                                           ; SOURCE LINE # 241
                                           ; SOURCE LINE # 242
                                           ; SOURCE LINE # 243
0000 120000      R     LCALL   L?0199
0003 7409              MOV     A,#09H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 244
0006 900000      E     MOV     DPTR,#LockSwitchPowerOn
0009 E4                CLR     A
000A F0                MOVX    @DPTR,A
000B A3                INC     DPTR
000C 74C8              MOV     A,#0C8H
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 246
000F 22                RET     
             ; FUNCTION Oem_TriggerPowerOff (END)

             ; FUNCTION Oem_PowSwToPWRBTN (BEGIN)
                                           ; SOURCE LINE # 252
                                           ; SOURCE LINE # 253
                                           ; SOURCE LINE # 261
0000 900000      E     MOV     DPTR,#GPIO_4x
0003 E0                MOVX    A,@DPTR
0004 30E304            JNB     ACC.3,?C0033
0007 7F01              MOV     R7,#01H
0009 8002              SJMP    ?C0034
000B         ?C0033:
000B 7F00              MOV     R7,#00H
000D         ?C0034:
000D 120000      R     LCALL   L?0203
0010 120000      E     LCALL   _InputDebounce
0013 900000      R     MOV     DPTR,#BTemp
0016 EF                MOV     A,R7
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 264
                                           ; SOURCE LINE # 265
                                           ; SOURCE LINE # 271
                                           ; SOURCE LINE # 273
                                           ; SOURCE LINE # 275
                                           ; SOURCE LINE # 277
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 28  

0018         ?C0037:
0018 22                RET     
             ; FUNCTION Oem_PowSwToPWRBTN (END)

             ; FUNCTION Oem_PowSwitchIntr (BEGIN)
                                           ; SOURCE LINE # 283
                                           ; SOURCE LINE # 284
                                           ; SOURCE LINE # 292
0000 900000      E     MOV     DPTR,#GPIO_4x
0003 E0                MOVX    A,@DPTR
0004 30E304            JNB     ACC.3,?C0038
0007 7F01              MOV     R7,#01H
0009 8002              SJMP    ?C0039
000B         ?C0038:
000B 7F00              MOV     R7,#00H
000D         ?C0039:
000D 7464              MOV     A,#064H
000F 120000      R     LCALL   L?0204
0012 120000      E     LCALL   _InputDebounce
;---- Variable 'BTemp' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 294
0015 EF                MOV     A,R7
0016 B40203            CJNE    A,#02H,?C0041
                                           ; SOURCE LINE # 295
                                           ; SOURCE LINE # 296
0019 120000      R     LCALL   Oem_TriggerPowerOff
                                           ; SOURCE LINE # 297
                                           ; SOURCE LINE # 299
001C         ?C0041:
001C 22                RET     
             ; FUNCTION Oem_PowSwitchIntr (END)

             ; FUNCTION Oem_PowSwOver5Sec (BEGIN)
                                           ; SOURCE LINE # 305
                                           ; SOURCE LINE # 306
                                           ; SOURCE LINE # 308
0000 900000      E     MOV     DPTR,#SysPowState
0003 E0                MOVX    A,@DPTR
0004 6404              XRL     A,#04H
0006 6036              JZ      ?C0044
0008 E0                MOVX    A,@DPTR
0009 6405              XRL     A,#05H
000B 6031              JZ      ?C0044
000D E0                MOVX    A,@DPTR
000E 602E              JZ      ?C0044
                                           ; SOURCE LINE # 309
                                           ; SOURCE LINE # 311
0010         ?C0042:
                                           ; SOURCE LINE # 317
0010 900000      E     MOV     DPTR,#GPIO_4x
0013 E0                MOVX    A,@DPTR
0014 30E304            JNB     ACC.3,?C0045
0017 7F01              MOV     R7,#01H
0019 8002              SJMP    ?C0046
001B         ?C0045:
001B 7F00              MOV     R7,#00H
001D         ?C0046:
001D 120000      R     LCALL   L?0210
0020 120000      E     LCALL   _InputDebounce
;---- Variable 'BTemp' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 320
0023 EF                MOV     A,R7
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 29  

0024 B40310            CJNE    A,#03H,?C0047
                                           ; SOURCE LINE # 321
                                           ; SOURCE LINE # 322
                                           ; SOURCE LINE # 323
0027 120000      R     LCALL   L?0205
002A 94E8              SUBB    A,#0E8H
002C 900000      E     MOV     DPTR,#PowSwOverTimer
002F E0                MOVX    A,@DPTR
0030 9403              SUBB    A,#03H
0032 400A              JC      ?C0044
                                           ; SOURCE LINE # 324
                                           ; SOURCE LINE # 325
0034 020000      R     LJMP    Oem_TriggerPowerOff
                                           ; SOURCE LINE # 326
                                           ; SOURCE LINE # 327
0037         ?C0047:
                                           ; SOURCE LINE # 329
                                           ; SOURCE LINE # 330
0037 E4                CLR     A
0038 900000      E     MOV     DPTR,#PowSwOverTimer
003B F0                MOVX    @DPTR,A
003C A3                INC     DPTR
003D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 331
                                           ; SOURCE LINE # 333
003E         ?C0044:
003E 22                RET     
             ; FUNCTION Oem_PowSwOver5Sec (END)

             ; FUNCTION Oem_ChkS5Shutdown (BEGIN)
                                           ; SOURCE LINE # 339
                                           ; SOURCE LINE # 340
                                           ; SOURCE LINE # 342
0000 900000      E     MOV     DPTR,#GPIO_5x
0003 E0                MOVX    A,@DPTR
0004 30E303            JNB     ACC.3,?C0050
0007 D3                SETB    C
0008 8001              SJMP    ?C0051
000A         ?C0050:
000A C3                CLR     C
000B         ?C0051:
000B 9200        R     MOV     bTemp,C
                                           ; SOURCE LINE # 343
000D 200003      R     JB      bTemp,?C0053
                                           ; SOURCE LINE # 344
                                           ; SOURCE LINE # 345
0010 120000      R     LCALL   Oem_TriggerPowerOff
                                           ; SOURCE LINE # 346
                                           ; SOURCE LINE # 348
0013         ?C0053:
0013 22                RET     
             ; FUNCTION Oem_ChkS5Shutdown (END)

             ; FUNCTION Oem_ChkS3Suspend (BEGIN)
                                           ; SOURCE LINE # 355
                                           ; SOURCE LINE # 356
                                           ; SOURCE LINE # 358
0000 900000      E     MOV     DPTR,#GPIO_4x
0003 E0                MOVX    A,@DPTR
0004 30E503            JNB     ACC.5,?C0054
0007 D3                SETB    C
0008 8001              SJMP    ?C0055
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 30  

000A         ?C0054:
000A C3                CLR     C
000B         ?C0055:
000B 9200        R     MOV     bTemp,C
                                           ; SOURCE LINE # 359
000D 200006      R     JB      bTemp,?C0057
                                           ; SOURCE LINE # 360
                                           ; SOURCE LINE # 361
                                           ; SOURCE LINE # 362
                                           ; SOURCE LINE # 364
0010 120000      R     LCALL   L?0200
0013 7408              MOV     A,#08H
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
                                           ; SOURCE LINE # 367
0016         ?C0057:
0016 22                RET     
             ; FUNCTION Oem_ChkS3Suspend (END)

             ; FUNCTION Oem_ChkS3WakeUp (BEGIN)
                                           ; SOURCE LINE # 374
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 377
0000 900000      E     MOV     DPTR,#GPIO_4x
0003 E0                MOVX    A,@DPTR
0004 30E503            JNB     ACC.5,?C0058
0007 D3                SETB    C
0008 8001              SJMP    ?C0059
000A         ?C0058:
000A C3                CLR     C
000B         ?C0059:
000B 9200        R     MOV     bTemp,C
                                           ; SOURCE LINE # 378
000D 300006      R     JNB     bTemp,?C0061
                                           ; SOURCE LINE # 379
                                           ; SOURCE LINE # 380
                                           ; SOURCE LINE # 381
                                           ; SOURCE LINE # 383
0010 120000      R     LCALL   L?0200
0013 7407              MOV     A,#07H
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 384
                                           ; SOURCE LINE # 386
0016         ?C0061:
0016 22                RET     
             ; FUNCTION Oem_ChkS3WakeUp (END)

             ; FUNCTION Oem_SysOnInit (BEGIN)
                                           ; SOURCE LINE # 392
                                           ; SOURCE LINE # 393
                                           ; SOURCE LINE # 395
0000 900000      E     MOV     DPTR,#SysPowState
0003 7401              MOV     A,#01H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 397
0006 E4                CLR     A
0007 900000      E     MOV     DPTR,#LED_S0_Status
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 398
000B 7800        E     MOV     R0,#LOW CORE_PMFLAG
000D F6                MOV     @R0,A
                                           ; SOURCE LINE # 399
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 31  

000E E6                MOV     A,@R0
000F 4401              ORL     A,#01H
0011 F6                MOV     @R0,A
                                           ; SOURCE LINE # 400
0012 020000      E     LJMP    EC_start
             ; FUNCTION Oem_SysOnInit (END)

             ; FUNCTION Oem_SysOffInit (BEGIN)
                                           ; SOURCE LINE # 408
                                           ; SOURCE LINE # 409
                                           ; SOURCE LINE # 410
0000 7405              MOV     A,#05H
                                           ; SOURCE LINE # 412
                                           ; SOURCE LINE # 413
0002 120000      R     LCALL   L?0206
0005 4410              ORL     A,#010H
0007 F6                MOV     @R0,A
                                           ; SOURCE LINE # 414
0008 E4                CLR     A
0009 900000      E     MOV     DPTR,#CtrlPowStep
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 415
000D 900000      E     MOV     DPTR,#PowSeqDelay
0010 F0                MOVX    @DPTR,A
0011 A3                INC     DPTR
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 435
0013 22                RET     
             ; FUNCTION Oem_SysOffInit (END)

             ; FUNCTION Oem_SysSuspendInit (BEGIN)
                                           ; SOURCE LINE # 441
                                           ; SOURCE LINE # 442
                                           ; SOURCE LINE # 443
0000 7403              MOV     A,#03H
                                           ; SOURCE LINE # 445
                                           ; SOURCE LINE # 446
0002 120000      R     LCALL   L?0206
0005 4404              ORL     A,#04H
0007 F6                MOV     @R0,A
                                           ; SOURCE LINE # 449
0008 22                RET     
             ; FUNCTION Oem_SysSuspendInit (END)

             ; FUNCTION Oem_SysResumeInit (BEGIN)
                                           ; SOURCE LINE # 455
                                           ; SOURCE LINE # 456
                                           ; SOURCE LINE # 457
0000 900000      E     MOV     DPTR,#SysPowState
0003 7401              MOV     A,#01H
                                           ; SOURCE LINE # 459
                                           ; SOURCE LINE # 460
0005 120000      R     LCALL   L?0207
0008 4401              ORL     A,#01H
000A F6                MOV     @R0,A
                                           ; SOURCE LINE # 461
000B 22                RET     
             ; FUNCTION Oem_SysResumeInit (END)

             ; FUNCTION InitShareMemory (BEGIN)
                                           ; SOURCE LINE # 466
                                           ; SOURCE LINE # 467
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 32  

                                           ; SOURCE LINE # 470
0000 900000      E     MOV     DPTR,#FMSSR
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 471
0006 900000      E     MOV     DPTR,#FPCFG
0009 E0                MOVX    A,@DPTR
000A 4410              ORL     A,#010H
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 473
000D 22                RET     
             ; FUNCTION InitShareMemory (END)

             ; FUNCTION Oem_SysOnSequence (BEGIN)
                                           ; SOURCE LINE # 479
                                           ; SOURCE LINE # 480
                                           ; SOURCE LINE # 484
0000 D3                SETB    C
0001 120000      R     LCALL   L?0198
0004 4009              JC      ?C0067
                                           ; SOURCE LINE # 485
                                           ; SOURCE LINE # 486
                                           ; SOURCE LINE # 487
0006 120000      R     LCALL   L?0196
0009 506C              JNC     ?C0070
                                           ; SOURCE LINE # 488
                                           ; SOURCE LINE # 489
000B E4                CLR     A
000C F0                MOVX    @DPTR,A
000D A3                INC     DPTR
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 490
                                           ; SOURCE LINE # 492
                                           ; SOURCE LINE # 494
                                           ; SOURCE LINE # 495
000F         ?C0067:
                                           ; SOURCE LINE # 499
000F 900000      E     MOV     DPTR,#CtrlPowStep
0012 E0                MOVX    A,@DPTR
0013 120000      E     LCALL   ?C?CCASE
0016 0000        R     DW      ?C0072
0018 00                DB      00H
0019 0000        R     DW      ?C0073
001B 01                DB      01H
001C 0000        R     DW      ?C0074
001E 02                DB      02H
001F 0000        R     DW      ?C0071
0021 03                DB      03H
0022 0000        R     DW      ?C0071
0024 04                DB      04H
0025 0000        R     DW      ?C0077
0027 05                DB      05H
0028 0000        R     DW      ?C0078
002A 06                DB      06H
002B 0000        R     DW      ?C0079
002D 07                DB      07H
002E 0000        R     DW      ?C0081
0030 08                DB      08H
0031 0000        R     DW      ?C0081
0033 09                DB      09H
0034 0000        R     DW      ?C0081
0036 0A                DB      0AH
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 33  

0037 0000        R     DW      ?C0083
0039 0B                DB      0BH
003A 0000              DW      00H
003C 0000        R     DW      ?C0084
                                           ; SOURCE LINE # 500
                                           ; SOURCE LINE # 502
003E         ?C0072:
                                           ; SOURCE LINE # 508
003E 120000      R     LCALL   L?0201
0041 740F              MOV     A,#0FH
0043 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 509
0044 802E              SJMP    ?C0071
                                           ; SOURCE LINE # 511
0046         ?C0073:
                                           ; SOURCE LINE # 517
0046 120000      R     LCALL   L?0201
0049 7496              MOV     A,#096H
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 518
004C 8026              SJMP    ?C0071
                                           ; SOURCE LINE # 521
004E         ?C0074:
                                           ; SOURCE LINE # 527
004E 120000      R     LCALL   L?0202
0051 7450              MOV     A,#050H
0053 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 528
0054 801E              SJMP    ?C0071
                                           ; SOURCE LINE # 530
                                           ; SOURCE LINE # 536
                                           ; SOURCE LINE # 538
                                           ; SOURCE LINE # 544
                                           ; SOURCE LINE # 546
0056         ?C0077:
                                           ; SOURCE LINE # 552
                                           ; SOURCE LINE # 553
0056 8002              SJMP    ?C0179
                                           ; SOURCE LINE # 555
0058         ?C0078:
                                           ; SOURCE LINE # 561
0058         ?C0178:
                                           ; SOURCE LINE # 562
0058 8000              SJMP    ?C0179
                                           ; SOURCE LINE # 564
005A         ?C0079:
                                           ; SOURCE LINE # 570
005A         ?C0179:
005A 120000      R     LCALL   L?0202
005D 7405              MOV     A,#05H
005F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 571
0060 8012              SJMP    ?C0071
                                           ; SOURCE LINE # 573
                                           ; SOURCE LINE # 582
0062         ?C0081:
                                           ; SOURCE LINE # 588
0062         ?C0180:
                                           ; SOURCE LINE # 590
                                           ; SOURCE LINE # 593
0062         ?C0181:
0062 120000      R     LCALL   L?0202
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 34  

0065 740A              MOV     A,#0AH
0067 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 600
0068 800A              SJMP    ?C0071
                                           ; SOURCE LINE # 604
006A         ?C0083:
                                           ; SOURCE LINE # 610
006A 120000      R     LCALL   Oem_SysOnInit
                                           ; SOURCE LINE # 613
006D 8005              SJMP    ?C0071
                                           ; SOURCE LINE # 615
006F         ?C0084:
                                           ; SOURCE LINE # 616
006F E4                CLR     A
0070 900000      E     MOV     DPTR,#CtrlPowStep
0073 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 617
                                           ; SOURCE LINE # 618
0074         ?C0071:
                                           ; SOURCE LINE # 622
0074 120000      R     LCALL   L?0208
                                           ; SOURCE LINE # 626
0077         ?C0070:
0077 22                RET     
             ; FUNCTION Oem_SysOnSequence (END)

             ; FUNCTION Oem_SysResumeSequence (BEGIN)
                                           ; SOURCE LINE # 633
                                           ; SOURCE LINE # 634
                                           ; SOURCE LINE # 638
0000 D3                SETB    C
0001 120000      R     LCALL   L?0198
0004 4009              JC      ?C0085
                                           ; SOURCE LINE # 639
                                           ; SOURCE LINE # 640
                                           ; SOURCE LINE # 642
0006 120000      R     LCALL   L?0196
0009 5050              JNC     ?C0088
                                           ; SOURCE LINE # 643
                                           ; SOURCE LINE # 644
000B E4                CLR     A
000C F0                MOVX    @DPTR,A
000D A3                INC     DPTR
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 645
                                           ; SOURCE LINE # 647
                                           ; SOURCE LINE # 649
                                           ; SOURCE LINE # 650
000F         ?C0085:
                                           ; SOURCE LINE # 654
000F 900000      E     MOV     DPTR,#CtrlPowStep
0012 E0                MOVX    A,@DPTR
0013 120000      E     LCALL   ?C?CCASE
0016 0000        R     DW      ?C0090
0018 00                DB      00H
0019 0000        R     DW      ?C0091
001B 01                DB      01H
001C 0000        R     DW      ?C0092
001E 02                DB      02H
001F 0000        R     DW      ?C0093
0021 03                DB      03H
0022 0000        R     DW      ?C0094
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 35  

0024 04                DB      04H
0025 0000        R     DW      ?C0094
0027 05                DB      05H
0028 0000        R     DW      ?C0089
002A 06                DB      06H
002B 0000        R     DW      ?C0089
002D 07                DB      07H
002E 0000        R     DW      ?C0089
0030 08                DB      08H
0031 0000        R     DW      ?C0099
0033 09                DB      09H
0034 0000              DW      00H
0036 0000        R     DW      ?C0100
                                           ; SOURCE LINE # 655
                                           ; SOURCE LINE # 657
0038         ?C0090:
                                           ; SOURCE LINE # 663
                                           ; SOURCE LINE # 665
0038 8004              SJMP    ?C0184
                                           ; SOURCE LINE # 668
003A         ?C0091:
                                           ; SOURCE LINE # 675
003A         ?C0182:
                                           ; SOURCE LINE # 677
003A 8002              SJMP    ?C0184
                                           ; SOURCE LINE # 680
003C         ?C0092:
                                           ; SOURCE LINE # 687
003C         ?C0183:
                                           ; SOURCE LINE # 689
003C 8000              SJMP    ?C0184
                                           ; SOURCE LINE # 691
003E         ?C0093:
                                           ; SOURCE LINE # 697
003E         ?C0184:
003E 120000      R     LCALL   L?0202
0041 7405              MOV     A,#05H
0043 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 699
0044 8012              SJMP    ?C0089
                                           ; SOURCE LINE # 701
0046         ?C0094:
                                           ; SOURCE LINE # 707
                                           ; SOURCE LINE # 709
                                           ; SOURCE LINE # 714
0046         ?C0185:
0046 120000      R     LCALL   L?0202
0049 740A              MOV     A,#0AH
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 722
004C 800A              SJMP    ?C0089
                                           ; SOURCE LINE # 724
                                           ; SOURCE LINE # 730
                                           ; SOURCE LINE # 732
                                           ; SOURCE LINE # 738
                                           ; SOURCE LINE # 741
                                           ; SOURCE LINE # 747
                                           ; SOURCE LINE # 750
004E         ?C0099:
                                           ; SOURCE LINE # 756
004E 120000      R     LCALL   Oem_SysOnInit
                                           ; SOURCE LINE # 758
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 36  

0051 8005              SJMP    ?C0089
                                           ; SOURCE LINE # 760
0053         ?C0100:
                                           ; SOURCE LINE # 761
0053 E4                CLR     A
0054 900000      E     MOV     DPTR,#CtrlPowStep
0057 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 762
                                           ; SOURCE LINE # 763
0058         ?C0089:
                                           ; SOURCE LINE # 767
0058 120000      R     LCALL   L?0208
                                           ; SOURCE LINE # 771
005B         ?C0088:
005B 22                RET     
             ; FUNCTION Oem_SysResumeSequence (END)

             ; FUNCTION Oem_ForceSystemOff (BEGIN)
                                           ; SOURCE LINE # 777
                                           ; SOURCE LINE # 778
                                           ; SOURCE LINE # 779
0000 E4                CLR     A
0001 900000      E     MOV     DPTR,#CtrlPowStep
0004 F0                MOVX    @DPTR,A
0005         ?C0101:
                                           ; SOURCE LINE # 780
                                           ; SOURCE LINE # 781
                                           ; SOURCE LINE # 782
0005 7F05              MOV     R7,#05H
0007 7E00              MOV     R6,#00H
0009 120000      E     LCALL   _vDelay1ms
                                           ; SOURCE LINE # 783
000C 120000      R     LCALL   Oem_SysOffSequence
                                           ; SOURCE LINE # 784
000F 900000      E     MOV     DPTR,#CtrlPowStep
0012 E0                MOVX    A,@DPTR
0013 70F0              JNZ     ?C0101
                                           ; SOURCE LINE # 785
                                           ; SOURCE LINE # 786
                                           ; SOURCE LINE # 787
                                           ; SOURCE LINE # 788
                                           ; SOURCE LINE # 790
0015         ?C0104:
0015 22                RET     
             ; FUNCTION Oem_ForceSystemOff (END)

             ; FUNCTION Oem_SysOffSequence (BEGIN)
                                           ; SOURCE LINE # 797
                                           ; SOURCE LINE # 798
                                           ; SOURCE LINE # 801
0000 D3                SETB    C
0001 120000      R     LCALL   L?0198
0004 4009              JC      ?C0105
                                           ; SOURCE LINE # 802
                                           ; SOURCE LINE # 803
                                           ; SOURCE LINE # 805
0006 120000      R     LCALL   L?0197
0009 505C              JNC     ?C0108
                                           ; SOURCE LINE # 806
                                           ; SOURCE LINE # 807
000B E4                CLR     A
000C F0                MOVX    @DPTR,A
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 37  

000D A3                INC     DPTR
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 808
                                           ; SOURCE LINE # 810
                                           ; SOURCE LINE # 812
                                           ; SOURCE LINE # 813
000F         ?C0105:
                                           ; SOURCE LINE # 817
000F 900000      E     MOV     DPTR,#CtrlPowStep
0012 E0                MOVX    A,@DPTR
0013 120000      E     LCALL   ?C?CCASE
0016 0000        R     DW      ?C0109
0018 00                DB      00H
0019 0000        R     DW      ?C0109
001B 01                DB      01H
001C 0000        R     DW      ?C0109
001E 02                DB      02H
001F 0000        R     DW      ?C0113
0021 03                DB      03H
0022 0000        R     DW      ?C0114
0024 04                DB      04H
0025 0000        R     DW      ?C0109
0027 05                DB      05H
0028 0000        R     DW      ?C0109
002A 06                DB      06H
002B 0000        R     DW      ?C0122
002D 07                DB      07H
002E 0000        R     DW      ?C0122
0030 08                DB      08H
0031 0000        R     DW      ?C0122
0033 09                DB      09H
0034 0000        R     DW      ?C0122
0036 0A                DB      0AH
0037 0000        R     DW      ?C0122
0039 0B                DB      0BH
003A 0000        R     DW      ?C0122
003C 0C                DB      0CH
003D 0000        R     DW      ?C0122
003F 0D                DB      0DH
0040 0000        R     DW      ?C0124
0042 0E                DB      0EH
0043 0000              DW      00H
0045 0000        R     DW      ?C0125
                                           ; SOURCE LINE # 818
                                           ; SOURCE LINE # 819
                                           ; SOURCE LINE # 825
                                           ; SOURCE LINE # 828
                                           ; SOURCE LINE # 834
                                           ; SOURCE LINE # 837
                                           ; SOURCE LINE # 843
                                           ; SOURCE LINE # 845
0047         ?C0113:
                                           ; SOURCE LINE # 852
                                           ; SOURCE LINE # 853
0047 8000              SJMP    ?C0186
                                           ; SOURCE LINE # 856
0049         ?C0114:
                                           ; SOURCE LINE # 864
0049         ?C0186:
0049 120000      R     LCALL   L?0202
004C 740A              MOV     A,#0AH
004E F0                MOVX    @DPTR,A
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 38  

                                           ; SOURCE LINE # 865
004F 8013              SJMP    ?C0109
                                           ; SOURCE LINE # 867
                                           ; SOURCE LINE # 875
                                           ; SOURCE LINE # 877
                                           ; SOURCE LINE # 884
                                           ; SOURCE LINE # 887
                                           ; SOURCE LINE # 897
                                           ; SOURCE LINE # 908
                                           ; SOURCE LINE # 919
                                           ; SOURCE LINE # 931
                                           ; SOURCE LINE # 943
0051         ?C0122:
                                           ; SOURCE LINE # 950
0051         ?C0191:
                                           ; SOURCE LINE # 952
                                           ; SOURCE LINE # 955
0051         ?C0192:
0051 120000      R     LCALL   L?0202
0054 7405              MOV     A,#05H
0056 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 964
0057 800B              SJMP    ?C0109
                                           ; SOURCE LINE # 967
0059         ?C0124:
                                           ; SOURCE LINE # 974
0059 120000      R     LCALL   Oem_SysOffInit
                                           ; SOURCE LINE # 976
005C 8006              SJMP    ?C0109
                                           ; SOURCE LINE # 978
005E         ?C0125:
                                           ; SOURCE LINE # 979
005E E4                CLR     A
005F 900000      E     MOV     DPTR,#CtrlPowStep
0062 F0                MOVX    @DPTR,A
0063 22                RET     
                                           ; SOURCE LINE # 981
0064         ?C0109:
                                           ; SOURCE LINE # 985
0064 120000      R     LCALL   L?0209
                                           ; SOURCE LINE # 989
0067         ?C0108:
0067 22                RET     
             ; FUNCTION Oem_SysOffSequence (END)

             ; FUNCTION Oem_SysSuspendSequence (BEGIN)
                                           ; SOURCE LINE # 996
                                           ; SOURCE LINE # 997
                                           ; SOURCE LINE # 1001
0000 D3                SETB    C
0001 120000      R     LCALL   L?0198
0004 4009              JC      ?C0126
                                           ; SOURCE LINE # 1002
                                           ; SOURCE LINE # 1003
                                           ; SOURCE LINE # 1005
0006 120000      R     LCALL   L?0197
0009 502E              JNC     ?C0129
                                           ; SOURCE LINE # 1006
                                           ; SOURCE LINE # 1007
000B E4                CLR     A
000C F0                MOVX    @DPTR,A
000D A3                INC     DPTR
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 39  

000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1008
                                           ; SOURCE LINE # 1010
                                           ; SOURCE LINE # 1012
                                           ; SOURCE LINE # 1013
000F         ?C0126:
                                           ; SOURCE LINE # 1017
000F 900000      E     MOV     DPTR,#CtrlPowStep
0012 E0                MOVX    A,@DPTR
0013 24FC              ADD     A,#0FCH
0015 600D              JZ      ?C0135
0017 14                DEC     A
0018 600A              JZ      ?C0135
001A 2405              ADD     A,#05H
001C 24F7              ADD     A,#0F7H
001E 5016              JNC     ?C0130
0020 600A              JZ      ?C0140
0022 800D              SJMP    ?C0141
                                           ; SOURCE LINE # 1018
                                           ; SOURCE LINE # 1020
                                           ; SOURCE LINE # 1027
                                           ; SOURCE LINE # 1029
                                           ; SOURCE LINE # 1037
                                           ; SOURCE LINE # 1039
                                           ; SOURCE LINE # 1045
                                           ; SOURCE LINE # 1047
                                           ; SOURCE LINE # 1054
                                           ; SOURCE LINE # 1056
0024         ?C0135:
                                           ; SOURCE LINE # 1063
                                           ; SOURCE LINE # 1064
                                           ; SOURCE LINE # 1066
0024         ?C0193:
0024 120000      R     LCALL   L?0202
0027 740A              MOV     A,#0AH
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1074
002A 800A              SJMP    ?C0130
                                           ; SOURCE LINE # 1076
                                           ; SOURCE LINE # 1083
                                           ; SOURCE LINE # 1085
                                           ; SOURCE LINE # 1093
                                           ; SOURCE LINE # 1095
                                           ; SOURCE LINE # 1103
                                           ; SOURCE LINE # 1105
002C         ?C0140:
                                           ; SOURCE LINE # 1111
002C 120000      R     LCALL   Oem_SysSuspendInit
                                           ; SOURCE LINE # 1113
002F 8005              SJMP    ?C0130
                                           ; SOURCE LINE # 1115
0031         ?C0141:
                                           ; SOURCE LINE # 1116
0031 E4                CLR     A
0032 900000      E     MOV     DPTR,#CtrlPowStep
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1117
                                           ; SOURCE LINE # 1118
0036         ?C0130:
                                           ; SOURCE LINE # 1122
0036 120000      R     LCALL   L?0209
                                           ; SOURCE LINE # 1126
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 40  

0039         ?C0129:
0039 22                RET     
             ; FUNCTION Oem_SysSuspendSequence (END)

             ; FUNCTION Oem_PowSwOver5Sec_ForceShutdown (BEGIN)
                                           ; SOURCE LINE # 1130
                                           ; SOURCE LINE # 1131
                                           ; SOURCE LINE # 1138
0000 900000      E     MOV     DPTR,#GPIO_4x
0003 E0                MOVX    A,@DPTR
0004 30E304            JNB     ACC.3,?C0142
0007 7F01              MOV     R7,#01H
0009 8002              SJMP    ?C0143
000B         ?C0142:
000B 7F00              MOV     R7,#00H
000D         ?C0143:
000D 120000      R     LCALL   L?0210
0010 120000      E     LCALL   _InputDebounce
;---- Variable 'BTemp' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1141
0013 EF                MOV     A,R7
0014 B40314            CJNE    A,#03H,?C0144
                                           ; SOURCE LINE # 1142
                                           ; SOURCE LINE # 1143
                                           ; SOURCE LINE # 1144
0017 120000      R     LCALL   L?0205
001A 94DC              SUBB    A,#0DCH
001C 900000      E     MOV     DPTR,#PowSwOverTimer
001F E0                MOVX    A,@DPTR
0020 9405              SUBB    A,#05H
0022 400E              JC      ?C0147
                                           ; SOURCE LINE # 1145
                                           ; SOURCE LINE # 1148
0024 E4                CLR     A
0025 F0                MOVX    @DPTR,A
0026 A3                INC     DPTR
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1149
0028 020000      R     LJMP    Oem_SysOffInit
                                           ; SOURCE LINE # 1150
                                           ; SOURCE LINE # 1151
002B         ?C0144:
                                           ; SOURCE LINE # 1153
                                           ; SOURCE LINE # 1154
002B E4                CLR     A
002C 900000      E     MOV     DPTR,#PowSwOverTimer
002F F0                MOVX    @DPTR,A
0030 A3                INC     DPTR
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1155
                                           ; SOURCE LINE # 1156
0032         ?C0147:
0032 22                RET     
             ; FUNCTION Oem_PowSwOver5Sec_ForceShutdown (END)

             ; FUNCTION Check_Power_State (BEGIN)
                                           ; SOURCE LINE # 1159
                                           ; SOURCE LINE # 1160
                                           ; SOURCE LINE # 1161
0000 900000      E     MOV     DPTR,#GPIO_5x
0003 E0                MOVX    A,@DPTR
0004 30E304            JNB     ACC.3,?C0149
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 41  

0007 7F01              MOV     R7,#01H
0009 8002              SJMP    ?C0150
000B         ?C0149:
000B 7F00              MOV     R7,#00H
000D         ?C0150:
000D EF                MOV     A,R7
000E 6401              XRL     A,#01H
0010 7059              JNZ     ?C0148
                                           ; SOURCE LINE # 1162
                                           ; SOURCE LINE # 1164
0012 900000      E     MOV     DPTR,#GPIO_4x
0015 E0                MOVX    A,@DPTR
0016 30E504            JNB     ACC.5,?C0152
0019 7F01              MOV     R7,#01H
001B 8002              SJMP    ?C0153
001D         ?C0152:
001D 7F00              MOV     R7,#00H
001F         ?C0153:
001F EF                MOV     A,R7
0020 6401              XRL     A,#01H
0022 702F              JNZ     ?C0151
                                           ; SOURCE LINE # 1165
                                           ; SOURCE LINE # 1166
0024 900000      E     MOV     DPTR,#SysPowState
0027 E0                MOVX    A,@DPTR
0028 6405              XRL     A,#05H
002A 6007              JZ      ?C0155
002C E0                MOVX    A,@DPTR
002D 6004              JZ      ?C0155
002F E0                MOVX    A,@DPTR
0030 B4040B            CJNE    A,#04H,?C0154
0033         ?C0155:
                                           ; SOURCE LINE # 1167
                                           ; SOURCE LINE # 1169
0033 120000      R     LCALL   Oem_SysOnInit
                                           ; SOURCE LINE # 1171
0036 900000      E     MOV     DPTR,#Index_23H
0039 E0                MOVX    A,@DPTR
003A 54FE              ANL     A,#0FEH
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1172
003D 22                RET     
003E         ?C0154:
                                           ; SOURCE LINE # 1173
003E 900000      E     MOV     DPTR,#SysPowState
0041 E0                MOVX    A,@DPTR
0042 6403              XRL     A,#03H
0044 7040              JNZ     ?C0165
                                           ; SOURCE LINE # 1174
                                           ; SOURCE LINE # 1175
0046 120000      R     LCALL   Oem_SysResumeInit
                                           ; SOURCE LINE # 1176
0049 900000      E     MOV     DPTR,#Index_23H
004C E0                MOVX    A,@DPTR
004D 54FE              ANL     A,#0FEH
004F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1178
0050 020000      E     LJMP    EC_start
                                           ; SOURCE LINE # 1181
                                           ; SOURCE LINE # 1183
0053         ?C0151:
                                           ; SOURCE LINE # 1185
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 42  

                                           ; SOURCE LINE # 1186
0053 900000      E     MOV     DPTR,#SysPowState
0056 E0                MOVX    A,@DPTR
0057 B40104            CJNE    A,#01H,?C0159
                                           ; SOURCE LINE # 1187
                                           ; SOURCE LINE # 1189
005A 740A              MOV     A,#0AH
005C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1195
005D 22                RET     
005E         ?C0159:
                                           ; SOURCE LINE # 1197
005E 900000      E     MOV     DPTR,#SysPowState
0061 E0                MOVX    A,@DPTR
0062 640A              XRL     A,#0AH
0064 7020              JNZ     ?C0165
                                           ; SOURCE LINE # 1198
                                           ; SOURCE LINE # 1199
0066 120000      R     LCALL   Oem_SysSuspendInit
                                           ; SOURCE LINE # 1200
                                           ; SOURCE LINE # 1201
                                           ; SOURCE LINE # 1204
                                           ; SOURCE LINE # 1206
0069 8014              SJMP    ?C0194
006B         ?C0148:
                                           ; SOURCE LINE # 1208
                                           ; SOURCE LINE # 1210
006B 900000      E     MOV     DPTR,#SysPowState
006E E0                MOVX    A,@DPTR
006F 6401              XRL     A,#01H
0071 6009              JZ      ?C0164
0073 E0                MOVX    A,@DPTR
0074 6403              XRL     A,#03H
0076 6004              JZ      ?C0164
0078 E0                MOVX    A,@DPTR
0079 B40A0A            CJNE    A,#0AH,?C0165
007C         ?C0164:
                                           ; SOURCE LINE # 1214
                                           ; SOURCE LINE # 1216
007C 120000      R     LCALL   Oem_SysOffInit
                                           ; SOURCE LINE # 1217
007F         ?C0194:
007F 900000      E     MOV     DPTR,#Index_23H
0082 E0                MOVX    A,@DPTR
0083 4401              ORL     A,#01H
0085 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1219
                                           ; SOURCE LINE # 1220
                                           ; SOURCE LINE # 1222
0086         ?C0165:
0086 22                RET     
             ; FUNCTION Check_Power_State (END)

             ; FUNCTION ProcessLED (BEGIN)
                                           ; SOURCE LINE # 1242
                                           ; SOURCE LINE # 1243
                                           ; SOURCE LINE # 1246
0000 900000      E     MOV     DPTR,#LED_FLASH_CNT
0003 E0                MOVX    A,@DPTR
0004 25E0              ADD     A,ACC
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1247
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 43  

0007 E0                MOVX    A,@DPTR
0008 7002              JNZ     ?C0166
                                           ; SOURCE LINE # 1248
000A 04                INC     A
000B F0                MOVX    @DPTR,A
000C         ?C0166:
                                           ; SOURCE LINE # 1251
;---- Variable 'pwr_index' assigned to Register 'R7' ----
000C E4                CLR     A
000D FF                MOV     R7,A
                                           ; SOURCE LINE # 1253
000E 900000      E     MOV     DPTR,#SysPowState
0011 E0                MOVX    A,@DPTR
0012 B40502            CJNE    A,#05H,?C0167
                                           ; SOURCE LINE # 1254
                                           ; SOURCE LINE # 1255
0015 7F03              MOV     R7,#03H
                                           ; SOURCE LINE # 1256
0017         ?C0167:
                                           ; SOURCE LINE # 1257
0017 900000      E     MOV     DPTR,#SysPowState
001A E0                MOVX    A,@DPTR
001B B40402            CJNE    A,#04H,?C0168
                                           ; SOURCE LINE # 1258
                                           ; SOURCE LINE # 1259
001E 7F02              MOV     R7,#02H
                                           ; SOURCE LINE # 1260
0020         ?C0168:
                                           ; SOURCE LINE # 1261
0020 900000      E     MOV     DPTR,#SysPowState
0023 E0                MOVX    A,@DPTR
0024 B40302            CJNE    A,#03H,?C0169
                                           ; SOURCE LINE # 1262
                                           ; SOURCE LINE # 1263
0027 7F01              MOV     R7,#01H
                                           ; SOURCE LINE # 1264
0029         ?C0169:
                                           ; SOURCE LINE # 1266
0029 EF                MOV     A,R7
002A 25E0              ADD     A,ACC
002C 2400        R     ADD     A,#LOW PowerLEDPattern
002E F582              MOV     DPL,A
0030 E4                CLR     A
0031 3400        R     ADDC    A,#HIGH PowerLEDPattern
0033 F583              MOV     DPH,A
0035 E4                CLR     A
0036 93                MOVC    A,@A+DPTR
0037 FE                MOV     R6,A
0038 7401              MOV     A,#01H
003A 93                MOVC    A,@A+DPTR
003B FF                MOV     R7,A
003C 900000      E     MOV     DPTR,#LED_FLASH_CNT
003F E0                MOVX    A,@DPTR
0040 FD                MOV     R5,A
0041 EF                MOV     A,R7
0042 5D                ANL     A,R5
0043 6003              JZ      ?C0170
                                           ; SOURCE LINE # 1267
                                           ; SOURCE LINE # 1268
0045 020000      E     LJMP    PWR_LED_ON
                                           ; SOURCE LINE # 1269
0048         ?C0170:
C51 COMPILER V7.50   OEM_POWER                                                             09/17/2020 21:06:55 PAGE 44  

                                           ; SOURCE LINE # 1271
                                           ; SOURCE LINE # 1272
0048 120000      E     LCALL   PWR_LED_OFF
                                           ; SOURCE LINE # 1273
                                           ; SOURCE LINE # 1276
004B         ?C0172:
004B 22                RET     
             ; FUNCTION ProcessLED (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1264    ----
   CONSTANT SIZE    =     12    ----
   XDATA SIZE       =   ----       2
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       3
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
