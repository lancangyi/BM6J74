C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE CORE_PECI
OBJECT MODULE PLACED IN Core\Core_PECI.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\c51.exe Core\Core_PECI.c LA WL(1) CD OT(9,SIZE) NOAREGS OR INCDIR(.\Core\Include\;.
                    -\Oem\Include\)

line level    source

   1          /*-----------------------------------------------------------------------------
   2           * Filename: CORE_PECI.C
   3           * Function: System Management SMBus Protocol drivers.
   4           *
   5           * Copyright (c) 2006-2013, ITE Tech. Inc. All Rights Reserved.
   6           *---------------------------------------------------------------------------*/
   7          #include "CORE_INC.H"
   8          #include "OEM_INC.H"
   9          
  10          
  11          // ----------------------------------------------------------------------------
  12          // The function of PECI3.0 Package power SKU unit read
  13          // Output:
  14          //          0 : Fail
  15          //          1 : OK
  16          // ----------------------------------------------------------------------------
  17          BYTE PECI_ReadPowerUnit(void)
  18          {
  19   1              BYTE result;
  20   1              if(PECI_RdPkgConfig(PECI_CPU_ADDR, &PECI_readBuffer[0], PECI_Domain_0, 0x00, PECI_Index_PPSU, 0x00, 0x00,
             - 0x05, 0x05))
  21   1              {
  22   2                      //
  23   2                      PECI_PowerUnit = (PECI_readBuffer[1]&0x0F);      // bit 0 ~ bit3
  24   2                      PECI_EnergyUnit = (PECI_readBuffer[2]&0x1F);     // bit 8 ~ bit12
  25   2                      PECI_TimeUnit = (PECI_readBuffer[3]&0x0F);       // bit 16 ~ bit19
  26   2                      result = 0x01;
  27   2              }
  28   1              else
  29   1              {
  30   2                      result = 0x00;
  31   2              }
  32   1              return(result);
  33   1      }
  34          
  35          
  36          
  37          //-----------------------------------------------------------------------
  38          // Read to the package configuration space (PCS) within the processor
  39          //  return : 
  40          //              1 : done
  41          //              0 : error
  42          //  Input : 
  43          //              (1) HostTargetAddr : The address of processor
  44          //              (2) *ReadData : the start address of variable to save data
  45          //              (3) Domain : 0 or 1¡C 
  46          //                           0 : Domain 0, 1 : Domain 1¡C
  47          //              (4) Retry   0 or 1
  48          //              (5) Index
  49          //              (6) LSB of parameter
  50          //              (7) MSB of parameter
  51          //              (8) ReadLen read length 2 or 3 or 5
  52          //              (9) WriteLen write length 5
  53          //-----------------------------------------------------------------------
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 2   

  54          //PECI_RdPkgConfig(0x30, &EC_PECI_RdPkgConfig_Buf, 0, 0, PECI_Index_TTR, 0, 0, 5, 5);
  55          // Tjmax : 4th byte, Tcontrol_offset : 3rd byte
  56          //-----------------------------------------------------------------------
  57          BYTE PECI_RdPkgConfig(BYTE HostTargetAddr, XBYTE *ReadData, BYTE Domain, BYTE Retry,BYTE Index, BYTE LSB, 
             -BYTE MSB, BYTE ReadLen, BYTE WriteLen)
  58          {
  59   1              BYTE iTemp;
  60   1              BYTE done;
  61   1      
  62   1              // Initialize the host
  63   1              if(AWFCS_EN == 0x01)
  64   1              {
  65   2                      IF_SELECT_REG = 0x65 ;
  66   2      
  67   2              }
  68   1              else
  69   1              {
  70   2                      IF_SELECT_REG = 0x64 ;
  71   2      
  72   2              }
  73   1      
  74   1              // Reset Data FIFO Pointer
  75   1              SET_BIT(PECI_HOST_CTRL, 3);
  76   1              
  77   1              PECI_HOST_CTRL = 0x00; 
  78   1              PECI_HOST_STS = 0xFF ;
  79   1      
  80   1              PECI_TARGET_ADDR = HostTargetAddr ;
  81   1              PECI_WR_LENGTH = WriteLen ;     //Write Len = 05h
  82   1              PECI_RD_LENGTH = ReadLen ;      //Read Len = 05h
  83   1      
  84   1              if(Domain<2)
  85   1              {
  86   2                      PECI_WR_DATA_1 = PECI_CMD_RdPkgConfig+Domain;
  87   2              }
  88   1              else
  89   1              {
  90   2                      PECI_WR_DATA_1 = PECI_CMD_RdPkgConfig;
  91   2              }
  92   1      
  93   1              if(Retry<2)
  94   1              {
  95   2                      PECI_WR_DATA_2_TO_8 = (PECI_HostID<<1)+Retry;
  96   2              }
  97   1              else
  98   1              {
  99   2                      PECI_WR_DATA_2_TO_8 = (PECI_HostID<<1);
 100   2              }
 101   1      
 102   1              PECI_WR_DATA_2_TO_8= Index ;    //Index PECI_Index_TTR = 16
 103   1              PECI_WR_DATA_2_TO_8= LSB ;      //LSB
 104   1              PECI_WR_DATA_2_TO_8= MSB ;      //MSB
 105   1      
 106   1              // Waiting for start
 107   1              Set_T1_Timeout(T_Timer_85ms);   //Reset TF1
 108   1              while( (IS_BIT_SET(PECI_HOST_STS, 0))&& (TF1 == 0) ) ;
 109   1              if(TF1 == 1)    //Timeout
 110   1                      return 0;       //Fail
 111   1              
 112   1              // Start
 113   1              PECI_HOST_CTRL = 0x01 ;
 114   1      
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 3   

 115   1              if(IS_BIT_SET(PECI_HOST_STS, 6)) return 0x0;
 116   1      
 117   1      
 118   1              Set_T1_Timeout(T_Timer_85ms);   //Reset TF1
 119   1              while( (!(IS_BIT_SET(PECI_HOST_STS, 1) )) && (TF1 == 0) ) ;
 120   1              if(TF1 == 1)    //Timeout
 121   1                      return 0;       //Fail
 122   1      
 123   1      
 124   1              if(  (PECI_HOST_STS&0x6C)!=0 ) return 0x00;
 125   1              
 126   1              for(iTemp = 0x00;iTemp < ReadLen;iTemp++)
 127   1              {
 128   2              
 129   2                      *(ReadData+iTemp) = PECI_FIFO;
 130   2              }
 131   1              
 132   1      
 133   1              // Reset Data FIFO Pointer
 134   1              SET_BIT(PECI_HOST_CTRL, 3);
 135   1              PECI_HOST_CTRL = 0x00;
 136   1              PECI_HOST_STS = 0xFE ;
 137   1      
 138   1              if(*ReadData == PECI_CC_Valid)
 139   1              {
 140   2                      done = 0x01;
 141   2              }
 142   1              else
 143   1              {
 144   2                      done = 0x00;
 145   2              }
 146   1      
 147   1              return done;
 148   1              
 149   1      }
 150          
 151          
 152          
 153          //-----------------------------------------------------------------------
 154          // Write to the package configuration space (PCS) within the processor
 155          //  return : 
 156          //              1 : done
 157          //              0 : error
 158          //  Input : 
 159          //              (1) HostTargetAddr : The address of processor
 160          //              (2) *WriteData : the start address of variable to wirte data
 161          //              (3) Domain : 0 or 1¡C 
 162          //                           0 : Domain 0, 1 : Domain 1¡C
 163          //              (4) Retry   0 or 1
 164          //              (5) Index
 165          //              (6) LSB of parameter
 166          //              (7) MSB of parameter
 167          //              (8) ReadLen read length 1
 168          //              (9) WriteLen write length 0x07 or 0x08 or 0x0A
 169          //-----------------------------------------------------------------------
 170          BYTE PECI_WrPkgConfig(BYTE HostTargetAddr, XBYTE *WriteData, BYTE Domain, BYTE Retry,BYTE Index, BYTE LSB,
             - BYTE MSB, BYTE ReadLen, BYTE WriteLen)
 171          {
 172   1      
 173   1              BYTE iTemp;
 174   1              BYTE done;
 175   1      
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 4   

 176   1              if(AWFCS_EN == 0x01)
 177   1              {
 178   2                      IF_SELECT_REG = 0x65 ;
 179   2              }
 180   1              else
 181   1              {
 182   2                      IF_SELECT_REG = 0x64 ;
 183   2              }
 184   1              
 185   1              // Reset Data FIFO Pointer
 186   1              SET_BIT(PECI_HOST_CTRL, 3);
 187   1              
 188   1              PECI_HOST_CTRL = 0x00; 
 189   1              PECI_HOST_STS = 0xFF ;
 190   1      
 191   1              PECI_TARGET_ADDR = HostTargetAddr ;
 192   1              PECI_WR_LENGTH = WriteLen ;     //Write Len = 05h
 193   1              PECI_RD_LENGTH = ReadLen ;      //Read Len = 01h
 194   1      
 195   1              if(Domain<2)
 196   1              {
 197   2                      PECI_WR_DATA_1 = PECI_CMD_WrPkgConfig+Domain;
 198   2              }
 199   1              else
 200   1              {
 201   2                      PECI_WR_DATA_1 = PECI_CMD_RdPkgConfig;
 202   2              }
 203   1      
 204   1              if(Retry<2)
 205   1              {
 206   2                      PECI_WR_DATA_2_TO_8 = (PECI_HostID<<1)+Retry;
 207   2              }
 208   1              else
 209   1              {
 210   2                      PECI_WR_DATA_2_TO_8 = (PECI_HostID<<1);
 211   2              }
 212   1      
 213   1              PECI_WR_DATA_2_TO_8= Index ;    //Index PECI_Index_TTR = 16
 214   1              PECI_WR_DATA_2_TO_8= LSB ;      //LSB
 215   1              PECI_WR_DATA_2_TO_8= MSB ;      //MSB
 216   1              for(iTemp=0x00; iTemp<(WriteLen-6); iTemp++)
 217   1              {
 218   2                      PECI_WR_DATA_2_TO_8 = *(WriteData+iTemp);
 219   2              }
 220   1      
 221   1              // Waiting for start
 222   1              Set_T1_Timeout(T_Timer_85ms);   //Reset TF1
 223   1              while( (IS_BIT_SET(PECI_HOST_STS, 0)) && (TF1 == 0) ) ;
 224   1              if(TF1 == 1)    //Timeout
 225   1                      return 0;       //Fail
 226   1      
 227   1              // Start
 228   1              PECI_HOST_CTRL = 0x01 ;
 229   1              
 230   1              if(IS_BIT_SET(PECI_HOST_STS, 6)) return 0x00;
 231   1      
 232   1      
 233   1              Set_T1_Timeout(T_Timer_85ms);   //Reset TF1
 234   1              while( (!(IS_BIT_SET(PECI_HOST_STS, 1) )) && (TF1 == 0) ) ;
 235   1              if(TF1 == 1)    //Timeout
 236   1                      return 0;       //Fail
 237   1      
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 5   

 238   1              if(  (PECI_HOST_STS&0x6C)!=0 ) return 0x00;
 239   1      
 240   1              iTemp = PECI_FIFO;
 241   1      
 242   1              // Reset Data FIFO Pointer
 243   1              SET_BIT(PECI_HOST_CTRL, 3);
 244   1              PECI_HOST_CTRL = 0x00;
 245   1              PECI_HOST_STS = 0xFE ;
 246   1      
 247   1              if(iTemp == PECI_CC_Valid )
 248   1              {
 249   2                      done = 0x01;
 250   2              }
 251   1              else
 252   1              {
 253   2                      done = 0x00;
 254   2              }
 255   1      
 256   1              return done;
 257   1      }
 258          
 259          
 260          
 261          BYTE PECI_Host_Access_GetTemp(BYTE HostTargetAddr)
 262          {
 263   1      
 264   1              // Change LDN to Environment Controller Page
 265   1              //Index_07H = 0x04 ;
 266   1      
 267   1              //
 268   1              // Initialize the host
 269   1              //AWFCS_EN = 0x01;
 270   1              
 271   1              if(AWFCS_EN == 0x01)
 272   1              {
 273   2                      IF_SELECT_REG = 0x65 ;          
 274   2                      
 275   2              }
 276   1              else
 277   1              {
 278   2                      IF_SELECT_REG = 0x64 ;  
 279   2              }
 280   1      
 281   1              // Reset Data FIFO Pointer
 282   1              SET_BIT(PECI_HOST_CTRL, 3);
 283   1              
 284   1              PECI_HOST_CTRL = 0x00; 
 285   1              PECI_HOST_STS = 0xFF ;
 286   1      
 287   1              PECI_TARGET_ADDR = HostTargetAddr ;
 288   1              PECI_WR_LENGTH = 0x01 ;
 289   1              PECI_RD_LENGTH = 0x02 ;
 290   1      
 291   1              PECI_WR_DATA_1 = 0x01 ;
 292   1              PECI_WR_DATA_2_TO_8= 0x00 ;
 293   1      
 294   1              // Waiting for start
 295   1              Set_T1_Timeout(T_Timer_85ms);   //Reset TF1
 296   1              while( (IS_BIT_SET(PECI_HOST_STS, 0))&& (TF1 == 0) ) ;
 297   1              if(TF1 == 1)    //Timeout
 298   1                      return 0;       //Fail
 299   1              // Start
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 6   

 300   1              PECI_HOST_CTRL = 0x01 ;
 301   1      
 302   1              if(IS_BIT_SET(PECI_HOST_STS, 6)) return 0x00;
 303   1      
 304   1              Set_T1_Timeout(T_Timer_85ms);   //Reset TF1
 305   1              while( (!(IS_BIT_SET(PECI_HOST_STS, 1) )) && (TF1 == 0) ) ;
 306   1              if(TF1 == 1)    //Timeout
 307   1                      return 0;       //Fail
 308   1              
 309   1              if(  (PECI_HOST_STS&0x6C)!=0 ) return 0x00;
 310   1              
 311   1              PECI_FIFO_LB = PECI_FIFO ;
 312   1              PECI_FIFO_HB = PECI_FIFO ;
 313   1      
 314   1              // Reset Data FIFO Pointer
 315   1              SET_BIT(PECI_HOST_CTRL, 3);
 316   1              PECI_HOST_CTRL = 0x00;
 317   1              PECI_HOST_STS = 0xFE ;
 318   1      
 319   1              return 0x01;
 320   1              
 321   1      }
 322          
 323          
 324          void Calc_Update_PECI_Temp(void)
 325          {
 326   1      
 327   1              WORD cpu_temperature ;
 328   1              BYTE temp_offset ;
 329   1              BYTE temp2;
 330   1      
 331   1              temp2 = PECI_Host_Access_GetTemp(0x30) ;
 332   1      
 333   1              /////////////////////////////////////////////////////////////////////
 334   1              // START : GETTING CPU TEMPERATURE FROM THE PECI FIRMWARE PROCEDURE
 335   1              /////////////////////////////////////////////////////////////////////
 336   1              
 337   1              if(temp2 == 0x01)
 338   1              {
 339   2      
 340   2                      //Else we can get the temperature of the CPU from the PECI firmware procedure as follows:
 341   2                      cpu_temperature =  (PECI_FIFO_HB <<8) + PECI_FIFO_LB ;
 342   2                      cpu_temperature = (~cpu_temperature)+1 ;
 343   2                      temp_offset = cpu_temperature>>6 ;
 344   2      
 345   2                      if(CPUTjmax == 0)
 346   2                      {
 347   3                              CPUTjmax = _PECI_CPU_Tjmax;
 348   3                      }
 349   2      
 350   2      
 351   2                      if(temp_offset <= CPUTjmax )
 352   2                      {
 353   3                              CPUTemperature = ( CPUTjmax - temp_offset ) ;
 354   3                      }
 355   2      
 356   2              }
 357   1              else
 358   1              {
 359   2                      //PECI Fail
 360   2              }
 361   1      
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 7   

 362   1              ///////////////////////////////////////////////////////////////////
 363   1              // END : GETTING CPU TEMPERATURE FROM THE PECI FIRMWARE PROCEDURE
 364   1              ///////////////////////////////////////////////////////////////////
 365   1                      
 366   1      }
 367          
 368          
 369          // ----------------------------------------------------------------------------
 370          // The function of PECI3.0 Read the Maximum Allowed Processor Temperature
 371          // ----------------------------------------------------------------------------
 372          void PECI_ReadTargetTemp(void)
 373          {
 374   1              if(PECI_RdPkgConfig(PECI_CPU_ADDR, &PECI_readBuffer[0], PECI_Domain_0, 0, PECI_Index_TTR, 0x00, 0x00, 0x0
             -5, 0x05))
 375   1              {
 376   2                      CPUTcontrol = PECI_readBuffer[2];
 377   2                      CPUTjmax = PECI_readBuffer[3];
 378   2              }
 379   1              else
 380   1              {
 381   2                      CPUTjmax = _PECI_CPU_Tjmax ; 
 382   2                      CPUTcontrol = _PECI_CPU_Tcontrol ;
 383   2              }
 384   1              
 385   1      }
 386          
 387          // ----------------------------------------------------------------------------
 388          // The function of PECI3.0 Thermal Margin read
 389          // ----------------------------------------------------------------------------
 390          void PECI_ReadThermMargin(void)
 391          {       
 392   1          if(PECI_RdPkgConfig(PECI_CPU_ADDR, &PECI_readBuffer[0], PECI_Domain_0, 0, PECI_Index_TMR, 0x00, 0x00, 
             -0x05, 0x05))
 393   1              //if(PECI_RdPkgConfig(_PECI_CPU_ADDR, &PECI_readBuffer[0], _PECI_Domain_0, 0, PECI_Index_PTR, 0xFF, 0x00,
             - 0x05, 0x05))
 394   1          {
 395   2                      CPUTermMargin = PECI_readBuffer[2];                                                             // Integer
 396   2          }
 397   1          else
 398   1          {
 399   2              ;
 400   2          }
 401   1      }
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 8   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION Com0049 (BEGIN)
0000         L?0074:
0000 F0                MOVX    @DPTR,A
0001         L?0075:
0001 900000      E     MOV     DPTR,#PECI_HOST_CTRL
0004 E0                MOVX    A,@DPTR
0005 4408              ORL     A,#08H
0007 F0                MOVX    @DPTR,A
0008 E4                CLR     A
0009 F0                MOVX    @DPTR,A
000A 900000      E     MOV     DPTR,#PECI_HOST_STS
000D 22                RET     
000E         L?0076:
000E A3                INC     DPTR
000F         L?0077:
000F F0                MOVX    @DPTR,A
0010 E4                CLR     A
0011 A3                INC     DPTR
0012 F0                MOVX    @DPTR,A
0013 A3                INC     DPTR
0014 F0                MOVX    @DPTR,A
0015 A3                INC     DPTR
0016 7405              MOV     A,#05H
0018 F0                MOVX    @DPTR,A
0019 A3                INC     DPTR
001A F0                MOVX    @DPTR,A
001B E4                CLR     A
001C FB                MOV     R3,A
001D 7F30              MOV     R7,#030H
001F 22                RET     
0020         L?0078:
0020         L?0079:
0020 900000      E     MOV     DPTR,#PECI_HOST_CTRL
0023 7401              MOV     A,#01H
0025 F0                MOVX    @DPTR,A
0026 900000      E     MOV     DPTR,#PECI_HOST_STS
0029 E0                MOVX    A,@DPTR
002A 22                RET     
002B         L?0080:
002B         L?0081:
002B 7C00        E     MOV     R4,#HIGH PECI_readBuffer
002D 7D00        E     MOV     R5,#LOW PECI_readBuffer
002F E4                CLR     A
0030 900000      R     MOV     DPTR,#?_PECI_RdPkgConfig?BYTE+04H
0033 F0                MOVX    @DPTR,A
0034 22                RET     
0035         L?0082:
0035 CD                XCH     A,R5
0036 EF                MOV     A,R7
0037 CD                XCH     A,R5
0038         L?0083:
0038 900000      E     MOV     DPTR,#AWFCS_EN
003B E0                MOVX    A,@DPTR
003C 900000      E     MOV     DPTR,#IF_SELECT_REG
003F 22                RET     
0040         L?0084:
0040 3E                ADDC    A,R6
0041 900000      R     MOV     DPTR,#cpu_temperature
0044 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 9   

0045 A3                INC     DPTR
0046 EF                MOV     A,R7
0047 F0                MOVX    @DPTR,A
0048 900000      R     MOV     DPTR,#cpu_temperature
004B 22                RET     
004C         L?0085:
004C         L?0086:
004C 74FF              MOV     A,#0FFH
004E F0                MOVX    @DPTR,A
004F 900000      E     MOV     DPTR,#PECI_TARGET_ADDR
0052 22                RET     
0053         L?0087:
0053 E0                MOVX    A,@DPTR
0054 900000      E     MOV     DPTR,#PECI_RD_LENGTH
0057 F0                MOVX    @DPTR,A
0058 EB                MOV     A,R3
0059 C3                CLR     C
005A 9402              SUBB    A,#02H
005C 22                RET     
005D         L?0088:
005D         L?0089:
005D 900000      E     MOV     DPTR,#PECI_HOST_STS
0060 E0                MOVX    A,@DPTR
0061 546C              ANL     A,#06CH
0063 22                RET     
             ; FUNCTION Com0049 (END)

             ; FUNCTION PECI_ReadPowerUnit (BEGIN)
                                           ; SOURCE LINE # 17
                                           ; SOURCE LINE # 18
                                           ; SOURCE LINE # 20
0000 120000      R     LCALL   L?0080
0003 741E              MOV     A,#01EH
0005 120000      R     LCALL   L?0076
0008 120000      R     LCALL   _PECI_RdPkgConfig
000B EF                MOV     A,R7
000C 6026              JZ      ?C0001
                                           ; SOURCE LINE # 21
                                           ; SOURCE LINE # 23
000E 900000      E     MOV     DPTR,#PECI_readBuffer+01H
0011 E0                MOVX    A,@DPTR
0012 540F              ANL     A,#0FH
0014 900000      E     MOV     DPTR,#PECI_PowerUnit
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 24
0018 900000      E     MOV     DPTR,#PECI_readBuffer+02H
001B E0                MOVX    A,@DPTR
001C 541F              ANL     A,#01FH
001E 900000      E     MOV     DPTR,#PECI_EnergyUnit
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 25
0022 900000      E     MOV     DPTR,#PECI_readBuffer+03H
0025 E0                MOVX    A,@DPTR
0026 540F              ANL     A,#0FH
0028 900000      E     MOV     DPTR,#PECI_TimeUnit
002B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 26
002C 900000      R     MOV     DPTR,#result
002F 7401              MOV     A,#01H
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 27
0032 8005              SJMP    ?C0002
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 10  

0034         ?C0001:
                                           ; SOURCE LINE # 29
                                           ; SOURCE LINE # 30
0034 E4                CLR     A
0035 900000      R     MOV     DPTR,#result
0038 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 31
0039         ?C0002:
                                           ; SOURCE LINE # 32
0039 900000      R     MOV     DPTR,#result
003C E0                MOVX    A,@DPTR
003D FF                MOV     R7,A
                                           ; SOURCE LINE # 33
003E         ?C0003:
003E 22                RET     
             ; FUNCTION PECI_ReadPowerUnit (END)

             ; FUNCTION _PECI_RdPkgConfig (BEGIN)
                                           ; SOURCE LINE # 57
0000 900000      R     MOV     DPTR,#ReadData
0003 EC                MOV     A,R4
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
;---- Variable 'HostTargetAddr' assigned to Register 'R5' ----
;---- Variable 'Domain' assigned to Register 'R3' ----
                                           ; SOURCE LINE # 58
                                           ; SOURCE LINE # 63
0008 120000      R     LCALL   L?0082
000B B40105            CJNE    A,#01H,?C0004
                                           ; SOURCE LINE # 64
                                           ; SOURCE LINE # 65
000E 7465              MOV     A,#065H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 67
0011 8003              SJMP    ?C0005
0013         ?C0004:
                                           ; SOURCE LINE # 69
                                           ; SOURCE LINE # 70
0013 7464              MOV     A,#064H
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 72
0016         ?C0005:
                                           ; SOURCE LINE # 75
                                           ; SOURCE LINE # 77
                                           ; SOURCE LINE # 78
0016 120000      R     LCALL   L?0075
                                           ; SOURCE LINE # 80
0019 120000      R     LCALL   L?0085
001C ED                MOV     A,R5
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 81
001E 900000      R     MOV     DPTR,#WriteLen
0021 E0                MOVX    A,@DPTR
0022 900000      E     MOV     DPTR,#PECI_WR_LENGTH
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 82
0026 900000      R     MOV     DPTR,#ReadLen
                                           ; SOURCE LINE # 84
0029 120000      R     LCALL   L?0087
002C 5009              JNC     ?C0006
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 11  

                                           ; SOURCE LINE # 85
                                           ; SOURCE LINE # 86
002E EB                MOV     A,R3
002F 24A1              ADD     A,#0A1H
0031 900000      E     MOV     DPTR,#PECI_WR_DATA_1
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 87
0035 8006              SJMP    ?C0007
0037         ?C0006:
                                           ; SOURCE LINE # 89
                                           ; SOURCE LINE # 90
0037 900000      E     MOV     DPTR,#PECI_WR_DATA_1
003A 74A1              MOV     A,#0A1H
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 91
003D         ?C0007:
                                           ; SOURCE LINE # 93
003D 900000      R     MOV     DPTR,#Retry
0040 E0                MOVX    A,@DPTR
0041 FF                MOV     R7,A
0042 C3                CLR     C
0043 9402              SUBB    A,#02H
0045 5009              JNC     ?C0008
                                           ; SOURCE LINE # 94
                                           ; SOURCE LINE # 95
0047 EF                MOV     A,R7
0048 2402              ADD     A,#02H
004A 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 96
004E 8006              SJMP    ?C0009
0050         ?C0008:
                                           ; SOURCE LINE # 98
                                           ; SOURCE LINE # 99
0050 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
0053 7402              MOV     A,#02H
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 100
0056         ?C0009:
                                           ; SOURCE LINE # 102
0056 900000      R     MOV     DPTR,#Index
0059 E0                MOVX    A,@DPTR
005A 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 103
005E 900000      R     MOV     DPTR,#LSB
0061 E0                MOVX    A,@DPTR
0062 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
0065 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 104
0066 900000      R     MOV     DPTR,#MSB
0069 E0                MOVX    A,@DPTR
006A 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
006D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 107
006E 7F01              MOV     R7,#01H
0070 7E00              MOV     R6,#00H
0072 120000      E     LCALL   _Set_T1_Timeout
0075         ?C0010:
                                           ; SOURCE LINE # 108
0075 900000      E     MOV     DPTR,#PECI_HOST_STS
0078 E0                MOVX    A,@DPTR
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 12  

0079 30E003            JNB     ACC.0,?C0011
007C 308FF6            JNB     TF1,?C0010
007F         ?C0011:
                                           ; SOURCE LINE # 109
007F 308F03            JNB     TF1,?C0012
                                           ; SOURCE LINE # 110
0082 7F00              MOV     R7,#00H
0084 22                RET     
0085         ?C0012:
                                           ; SOURCE LINE # 113
                                           ; SOURCE LINE # 115
0085 120000      R     LCALL   L?0078
0088 30E603            JNB     ACC.6,?C0014
008B 7F00              MOV     R7,#00H
008D 22                RET     
008E         ?C0014:
                                           ; SOURCE LINE # 118
008E 7F01              MOV     R7,#01H
0090 7E00              MOV     R6,#00H
0092 120000      E     LCALL   _Set_T1_Timeout
0095         ?C0015:
                                           ; SOURCE LINE # 119
0095 900000      E     MOV     DPTR,#PECI_HOST_STS
0098 E0                MOVX    A,@DPTR
0099 30E103            JNB     ACC.1,?C0017
009C D3                SETB    C
009D 8001              SJMP    ?C0018
009F         ?C0017:
009F C3                CLR     C
00A0         ?C0018:
00A0 4003              JC      ?C0016
00A2 308FF0            JNB     TF1,?C0015
00A5         ?C0016:
                                           ; SOURCE LINE # 120
00A5 308F03            JNB     TF1,?C0019
                                           ; SOURCE LINE # 121
00A8 7F00              MOV     R7,#00H
00AA 22                RET     
00AB         ?C0019:
                                           ; SOURCE LINE # 124
00AB 120000      R     LCALL   L?0088
00AE 6003              JZ      ?C0020
00B0 7F00              MOV     R7,#00H
00B2 22                RET     
00B3         ?C0020:
                                           ; SOURCE LINE # 126
;---- Variable 'iTemp' assigned to Register 'R7' ----
00B3 E4                CLR     A
00B4 FF                MOV     R7,A
00B5         ?C0021:
00B5 900000      R     MOV     DPTR,#ReadLen
00B8 E0                MOVX    A,@DPTR
00B9 FE                MOV     R6,A
00BA EF                MOV     A,R7
00BB C3                CLR     C
00BC 9E                SUBB    A,R6
00BD 5018              JNC     ?C0022
                                           ; SOURCE LINE # 127
                                           ; SOURCE LINE # 129
00BF 900000      E     MOV     DPTR,#PECI_FIFO
00C2 E0                MOVX    A,@DPTR
00C3 FE                MOV     R6,A
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 13  

00C4 900000      R     MOV     DPTR,#ReadData
00C7 E0                MOVX    A,@DPTR
00C8 FC                MOV     R4,A
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB 2F                ADD     A,R7
00CC F582              MOV     DPL,A
00CE E4                CLR     A
00CF 3C                ADDC    A,R4
00D0 F583              MOV     DPH,A
00D2 EE                MOV     A,R6
00D3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 130
00D4 0F                INC     R7
00D5 80DE              SJMP    ?C0021
00D7         ?C0022:
                                           ; SOURCE LINE # 134
                                           ; SOURCE LINE # 135
                                           ; SOURCE LINE # 136
00D7 120000      R     LCALL   L?0075
00DA 74FE              MOV     A,#0FEH
00DC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 138
00DD 900000      R     MOV     DPTR,#ReadData
00E0 E0                MOVX    A,@DPTR
00E1 FE                MOV     R6,A
00E2 A3                INC     DPTR
00E3 E0                MOVX    A,@DPTR
00E4 F582              MOV     DPL,A
00E6 8E83              MOV     DPH,R6
00E8 E0                MOVX    A,@DPTR
00E9 B44008            CJNE    A,#040H,?C0024
                                           ; SOURCE LINE # 139
                                           ; SOURCE LINE # 140
00EC 900000      R     MOV     DPTR,#done
00EF 7401              MOV     A,#01H
00F1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 141
00F2 8005              SJMP    ?C0025
00F4         ?C0024:
                                           ; SOURCE LINE # 143
                                           ; SOURCE LINE # 144
00F4 E4                CLR     A
00F5 900000      R     MOV     DPTR,#done
00F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 145
00F9         ?C0025:
                                           ; SOURCE LINE # 147
00F9 900000      R     MOV     DPTR,#done
00FC E0                MOVX    A,@DPTR
00FD FF                MOV     R7,A
                                           ; SOURCE LINE # 149
00FE         ?C0013:
00FE 22                RET     
             ; FUNCTION _PECI_RdPkgConfig (END)

             ; FUNCTION _PECI_WrPkgConfig (BEGIN)
                                           ; SOURCE LINE # 170
;---- Variable 'HostTargetAddr' assigned to Register 'R2' ----
0000 CA                XCH     A,R2
0001 EF                MOV     A,R7
0002 CA                XCH     A,R2
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 14  

;---- Variable 'Domain' assigned to Register 'R3' ----
;---- Variable 'WriteData' assigned to Register 'R4/R5' ----
                                           ; SOURCE LINE # 171
                                           ; SOURCE LINE # 176
0003 120000      R     LCALL   L?0083
0006 B40105            CJNE    A,#01H,?C0026
                                           ; SOURCE LINE # 177
                                           ; SOURCE LINE # 178
0009 7465              MOV     A,#065H
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 179
000C 8003              SJMP    ?C0027
000E         ?C0026:
                                           ; SOURCE LINE # 181
                                           ; SOURCE LINE # 182
000E 7464              MOV     A,#064H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 183
0011         ?C0027:
                                           ; SOURCE LINE # 186
                                           ; SOURCE LINE # 188
                                           ; SOURCE LINE # 189
0011 120000      R     LCALL   L?0075
                                           ; SOURCE LINE # 191
0014 120000      R     LCALL   L?0085
0017 EA                MOV     A,R2
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 192
0019 900000      R     MOV     DPTR,#WriteLen
001C E0                MOVX    A,@DPTR
001D 900000      E     MOV     DPTR,#PECI_WR_LENGTH
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 193
0021 900000      R     MOV     DPTR,#ReadLen
                                           ; SOURCE LINE # 195
0024 120000      R     LCALL   L?0087
0027 5009              JNC     ?C0028
                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 197
0029 EB                MOV     A,R3
002A 24A5              ADD     A,#0A5H
002C 900000      E     MOV     DPTR,#PECI_WR_DATA_1
002F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 198
0030 8006              SJMP    ?C0029
0032         ?C0028:
                                           ; SOURCE LINE # 200
                                           ; SOURCE LINE # 201
0032 900000      E     MOV     DPTR,#PECI_WR_DATA_1
0035 74A1              MOV     A,#0A1H
0037 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 202
0038         ?C0029:
                                           ; SOURCE LINE # 204
0038 900000      R     MOV     DPTR,#Retry
003B E0                MOVX    A,@DPTR
003C FF                MOV     R7,A
003D C3                CLR     C
003E 9402              SUBB    A,#02H
0040 5009              JNC     ?C0030
                                           ; SOURCE LINE # 205
                                           ; SOURCE LINE # 206
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 15  

0042 EF                MOV     A,R7
0043 2402              ADD     A,#02H
0045 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
0048 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 207
0049 8006              SJMP    ?C0031
004B         ?C0030:
                                           ; SOURCE LINE # 209
                                           ; SOURCE LINE # 210
004B 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
004E 7402              MOV     A,#02H
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 211
0051         ?C0031:
                                           ; SOURCE LINE # 213
0051 900000      R     MOV     DPTR,#Index
0054 E0                MOVX    A,@DPTR
0055 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
0058 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 214
0059 900000      R     MOV     DPTR,#LSB
005C E0                MOVX    A,@DPTR
005D 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
0060 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 215
0061 900000      R     MOV     DPTR,#MSB
0064 E0                MOVX    A,@DPTR
0065 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 216
0069 E4                CLR     A
006A 900000      R     MOV     DPTR,#iTemp
006D F0                MOVX    @DPTR,A
006E         ?C0032:
006E 900000      R     MOV     DPTR,#WriteLen
0071 E0                MOVX    A,@DPTR
0072 24FA              ADD     A,#0FAH
0074 FF                MOV     R7,A
0075 A3                INC     DPTR
0076 E0                MOVX    A,@DPTR
0077 FE                MOV     R6,A
0078 C3                CLR     C
0079 9F                SUBB    A,R7
007A 5015              JNC     ?C0033
                                           ; SOURCE LINE # 217
                                           ; SOURCE LINE # 218
007C ED                MOV     A,R5
007D 2E                ADD     A,R6
007E F582              MOV     DPL,A
0080 E4                CLR     A
0081 3C                ADDC    A,R4
0082 F583              MOV     DPH,A
0084 E0                MOVX    A,@DPTR
0085 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
0088 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 219
0089 900000      R     MOV     DPTR,#iTemp
008C E0                MOVX    A,@DPTR
008D 04                INC     A
008E F0                MOVX    @DPTR,A
008F 80DD              SJMP    ?C0032
0091         ?C0033:
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 16  

                                           ; SOURCE LINE # 222
0091 7F01              MOV     R7,#01H
0093 7E00              MOV     R6,#00H
0095 120000      E     LCALL   _Set_T1_Timeout
0098         ?C0035:
                                           ; SOURCE LINE # 223
0098 900000      E     MOV     DPTR,#PECI_HOST_STS
009B E0                MOVX    A,@DPTR
009C 30E003            JNB     ACC.0,?C0036
009F 308FF6            JNB     TF1,?C0035
00A2         ?C0036:
                                           ; SOURCE LINE # 224
00A2 308F03            JNB     TF1,?C0037
                                           ; SOURCE LINE # 225
00A5 7F00              MOV     R7,#00H
00A7 22                RET     
00A8         ?C0037:
                                           ; SOURCE LINE # 228
                                           ; SOURCE LINE # 230
00A8 120000      R     LCALL   L?0078
00AB 30E603            JNB     ACC.6,?C0039
00AE 7F00              MOV     R7,#00H
00B0 22                RET     
00B1         ?C0039:
                                           ; SOURCE LINE # 233
00B1 7F01              MOV     R7,#01H
00B3 7E00              MOV     R6,#00H
00B5 120000      E     LCALL   _Set_T1_Timeout
00B8         ?C0040:
                                           ; SOURCE LINE # 234
00B8 900000      E     MOV     DPTR,#PECI_HOST_STS
00BB E0                MOVX    A,@DPTR
00BC 30E103            JNB     ACC.1,?C0042
00BF D3                SETB    C
00C0 8001              SJMP    ?C0043
00C2         ?C0042:
00C2 C3                CLR     C
00C3         ?C0043:
00C3 4003              JC      ?C0041
00C5 308FF0            JNB     TF1,?C0040
00C8         ?C0041:
                                           ; SOURCE LINE # 235
00C8 308F03            JNB     TF1,?C0044
                                           ; SOURCE LINE # 236
00CB 7F00              MOV     R7,#00H
00CD 22                RET     
00CE         ?C0044:
                                           ; SOURCE LINE # 238
00CE 120000      R     LCALL   L?0088
00D1 6003              JZ      ?C0045
00D3 7F00              MOV     R7,#00H
00D5 22                RET     
00D6         ?C0045:
                                           ; SOURCE LINE # 240
00D6 900000      E     MOV     DPTR,#PECI_FIFO
00D9 E0                MOVX    A,@DPTR
00DA 900000      R     MOV     DPTR,#iTemp
                                           ; SOURCE LINE # 243
                                           ; SOURCE LINE # 244
                                           ; SOURCE LINE # 245
00DD 120000      R     LCALL   L?0074
00E0 74FE              MOV     A,#0FEH
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 17  

00E2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 247
00E3 900000      R     MOV     DPTR,#iTemp
00E6 E0                MOVX    A,@DPTR
00E7 B44006            CJNE    A,#040H,?C0046
                                           ; SOURCE LINE # 248
                                           ; SOURCE LINE # 249
00EA A3                INC     DPTR
00EB 7401              MOV     A,#01H
00ED F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 250
00EE 8005              SJMP    ?C0047
00F0         ?C0046:
                                           ; SOURCE LINE # 252
                                           ; SOURCE LINE # 253
00F0 E4                CLR     A
00F1 900000      R     MOV     DPTR,#done
00F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 254
00F5         ?C0047:
                                           ; SOURCE LINE # 256
00F5 900000      R     MOV     DPTR,#done
00F8 E0                MOVX    A,@DPTR
00F9 FF                MOV     R7,A
                                           ; SOURCE LINE # 257
00FA         ?C0038:
00FA 22                RET     
             ; FUNCTION _PECI_WrPkgConfig (END)

             ; FUNCTION _PECI_Host_Access_GetTemp (BEGIN)
                                           ; SOURCE LINE # 261
;---- Variable 'HostTargetAddr' assigned to Register 'R5' ----
                                           ; SOURCE LINE # 262
                                           ; SOURCE LINE # 271
0000 120000      R     LCALL   L?0082
0003 B40105            CJNE    A,#01H,?C0048
                                           ; SOURCE LINE # 272
                                           ; SOURCE LINE # 273
0006 7465              MOV     A,#065H
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 275
0009 8003              SJMP    ?C0049
000B         ?C0048:
                                           ; SOURCE LINE # 277
                                           ; SOURCE LINE # 278
000B 7464              MOV     A,#064H
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 279
000E         ?C0049:
                                           ; SOURCE LINE # 282
                                           ; SOURCE LINE # 284
                                           ; SOURCE LINE # 285
000E 120000      R     LCALL   L?0075
                                           ; SOURCE LINE # 287
0011 120000      R     LCALL   L?0086
0014 ED                MOV     A,R5
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 288
0016 900000      E     MOV     DPTR,#PECI_WR_LENGTH
0019 7401              MOV     A,#01H
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 289
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 18  

001C 900000      E     MOV     DPTR,#PECI_RD_LENGTH
001F 04                INC     A
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 291
0021 900000      E     MOV     DPTR,#PECI_WR_DATA_1
0024 14                DEC     A
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
0026 E4                CLR     A
0027 900000      E     MOV     DPTR,#PECI_WR_DATA_2_TO_8
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 295
002B 7F01              MOV     R7,#01H
002D FE                MOV     R6,A
002E 120000      E     LCALL   _Set_T1_Timeout
0031         ?C0050:
                                           ; SOURCE LINE # 296
0031 900000      E     MOV     DPTR,#PECI_HOST_STS
0034 E0                MOVX    A,@DPTR
0035 30E003            JNB     ACC.0,?C0051
0038 308FF6            JNB     TF1,?C0050
003B         ?C0051:
                                           ; SOURCE LINE # 297
003B 308F03            JNB     TF1,?C0052
                                           ; SOURCE LINE # 298
003E 7F00              MOV     R7,#00H
0040 22                RET     
0041         ?C0052:
                                           ; SOURCE LINE # 300
                                           ; SOURCE LINE # 302
0041 120000      R     LCALL   L?0079
0044 30E603            JNB     ACC.6,?C0054
0047 7F00              MOV     R7,#00H
0049 22                RET     
004A         ?C0054:
                                           ; SOURCE LINE # 304
004A 7F01              MOV     R7,#01H
004C 7E00              MOV     R6,#00H
004E 120000      E     LCALL   _Set_T1_Timeout
0051         ?C0055:
                                           ; SOURCE LINE # 305
0051 900000      E     MOV     DPTR,#PECI_HOST_STS
0054 E0                MOVX    A,@DPTR
0055 30E103            JNB     ACC.1,?C0057
0058 D3                SETB    C
0059 8001              SJMP    ?C0058
005B         ?C0057:
005B C3                CLR     C
005C         ?C0058:
005C 4003              JC      ?C0056
005E 308FF0            JNB     TF1,?C0055
0061         ?C0056:
                                           ; SOURCE LINE # 306
0061 308F03            JNB     TF1,?C0059
                                           ; SOURCE LINE # 307
0064 7F00              MOV     R7,#00H
0066 22                RET     
0067         ?C0059:
                                           ; SOURCE LINE # 309
0067 120000      R     LCALL   L?0089
006A 6003              JZ      ?C0060
006C 7F00              MOV     R7,#00H
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 19  

006E 22                RET     
006F         ?C0060:
                                           ; SOURCE LINE # 311
006F 900000      E     MOV     DPTR,#PECI_FIFO
0072 E0                MOVX    A,@DPTR
0073 900000      E     MOV     DPTR,#PECI_FIFO_LB
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 312
0077 900000      E     MOV     DPTR,#PECI_FIFO
007A E0                MOVX    A,@DPTR
007B 900000      E     MOV     DPTR,#PECI_FIFO_HB
                                           ; SOURCE LINE # 315
                                           ; SOURCE LINE # 316
                                           ; SOURCE LINE # 317
007E 120000      R     LCALL   L?0074
0081 74FE              MOV     A,#0FEH
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 319
0084 7F01              MOV     R7,#01H
                                           ; SOURCE LINE # 321
0086         ?C0053:
0086 22                RET     
             ; FUNCTION _PECI_Host_Access_GetTemp (END)

             ; FUNCTION Calc_Update_PECI_Temp (BEGIN)
                                           ; SOURCE LINE # 324
                                           ; SOURCE LINE # 325
                                           ; SOURCE LINE # 331
0000 7F30              MOV     R7,#030H
0002 120000      R     LCALL   _PECI_Host_Access_GetTemp
;---- Variable 'temp2' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 337
0005 EF                MOV     A,R7
0006 6401              XRL     A,#01H
0008 704B              JNZ     ?C0065
                                           ; SOURCE LINE # 338
                                           ; SOURCE LINE # 341
000A 900000      E     MOV     DPTR,#PECI_FIFO_HB
000D E0                MOVX    A,@DPTR
000E FE                MOV     R6,A
000F 900000      E     MOV     DPTR,#PECI_FIFO_LB
0012 E0                MOVX    A,@DPTR
0013 7C00              MOV     R4,#00H
0015 2400              ADD     A,#00H
0017 FF                MOV     R7,A
0018 EC                MOV     A,R4
                                           ; SOURCE LINE # 342
0019 120000      R     LCALL   L?0084
001C E0                MOVX    A,@DPTR
001D FE                MOV     R6,A
001E A3                INC     DPTR
001F E0                MOVX    A,@DPTR
0020 F4                CPL     A
0021 FF                MOV     R7,A
0022 EE                MOV     A,R6
0023 F4                CPL     A
0024 FE                MOV     R6,A
0025 EF                MOV     A,R7
0026 2401              ADD     A,#01H
0028 FF                MOV     R7,A
0029 E4                CLR     A
                                           ; SOURCE LINE # 343
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 20  

002A 120000      R     LCALL   L?0084
002D E0                MOVX    A,@DPTR
002E FE                MOV     R6,A
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
0031 7806              MOV     R0,#06H
0033         ?C0072:
0033 CE                XCH     A,R6
0034 C3                CLR     C
0035 13                RRC     A
0036 CE                XCH     A,R6
0037 13                RRC     A
0038 D8F9              DJNZ    R0,?C0072
003A FF                MOV     R7,A
;---- Variable 'temp_offset' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 345
003B 900000      E     MOV     DPTR,#CPUTjmax
003E E0                MOVX    A,@DPTR
003F 7003              JNZ     ?C0062
                                           ; SOURCE LINE # 346
                                           ; SOURCE LINE # 347
0041 7464              MOV     A,#064H
0043 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 348
0044         ?C0062:
                                           ; SOURCE LINE # 351
0044 900000      E     MOV     DPTR,#CPUTjmax
0047 E0                MOVX    A,@DPTR
0048 FE                MOV     R6,A
0049 EF                MOV     A,R7
004A D3                SETB    C
004B 9E                SUBB    A,R6
004C 5007              JNC     ?C0065
                                           ; SOURCE LINE # 352
                                           ; SOURCE LINE # 353
004E E0                MOVX    A,@DPTR
004F C3                CLR     C
0050 9F                SUBB    A,R7
0051 900000      E     MOV     DPTR,#CPUTemperature
0054 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 354
                                           ; SOURCE LINE # 356
                                           ; SOURCE LINE # 358
                                           ; SOURCE LINE # 360
                                           ; SOURCE LINE # 366
0055         ?C0065:
0055 22                RET     
             ; FUNCTION Calc_Update_PECI_Temp (END)

             ; FUNCTION PECI_ReadTargetTemp (BEGIN)
                                           ; SOURCE LINE # 372
                                           ; SOURCE LINE # 373
                                           ; SOURCE LINE # 374
0000 120000      R     LCALL   L?0080
0003 7410              MOV     A,#010H
0005 120000      R     LCALL   L?0076
0008 120000      R     LCALL   _PECI_RdPkgConfig
000B EF                MOV     A,R7
000C 6011              JZ      ?C0066
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 376
000E 900000      E     MOV     DPTR,#PECI_readBuffer+02H
C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 21  

0011 E0                MOVX    A,@DPTR
0012 900000      E     MOV     DPTR,#CPUTcontrol
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 377
0016 900000      E     MOV     DPTR,#PECI_readBuffer+03H
0019 E0                MOVX    A,@DPTR
001A 900000      E     MOV     DPTR,#CPUTjmax
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 378
001E 22                RET     
001F         ?C0066:
                                           ; SOURCE LINE # 380
                                           ; SOURCE LINE # 381
001F 900000      E     MOV     DPTR,#CPUTjmax
0022 7464              MOV     A,#064H
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 382
0025 900000      E     MOV     DPTR,#CPUTcontrol
0028 7410              MOV     A,#010H
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 383
                                           ; SOURCE LINE # 385
002B         ?C0068:
002B 22                RET     
             ; FUNCTION PECI_ReadTargetTemp (END)

             ; FUNCTION PECI_ReadThermMargin (BEGIN)
                                           ; SOURCE LINE # 390
                                           ; SOURCE LINE # 391
                                           ; SOURCE LINE # 392
0000 120000      R     LCALL   L?0081
0003 A3                INC     DPTR
0004 740A              MOV     A,#0AH
0006 120000      R     LCALL   L?0077
0009 120000      R     LCALL   _PECI_RdPkgConfig
000C EF                MOV     A,R7
000D 6008              JZ      ?C0071
                                           ; SOURCE LINE # 394
                                           ; SOURCE LINE # 395
000F 900000      E     MOV     DPTR,#PECI_readBuffer+02H
0012 E0                MOVX    A,@DPTR
0013 900000      E     MOV     DPTR,#CPUTermMargin
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 396
                                           ; SOURCE LINE # 398
                                           ; SOURCE LINE # 400
                                           ; SOURCE LINE # 401
0017         ?C0071:
0017 22                RET     
             ; FUNCTION PECI_ReadThermMargin (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    958    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      26
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V7.50   CORE_PECI                                                             09/17/2020 21:06:53 PAGE 22  


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
