C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE CORE_FLASH
OBJECT MODULE PLACED IN Core\Core_Flash.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\c51.exe Core\Core_Flash.c LA WL(1) CD OT(9,SIZE) NOAREGS OR INCDIR(.\Core\Include\;
                    -.\Oem\Include\)

line level    source

   1          /*-----------------------------------------------------------------------------
   2           * TITLE: CORE_FLASH.C
   3           *
   4           * Copyright (c) ITE INC. All Rights Reserved.
   5           *
   6           *---------------------------------------------------------------------------*/
   7           
   8          #include "Core_Inc.h"
   9          #include "Oem_Inc.h"
  10          
  11          //-----------------------------------------------------------------------------
  12          // The function start address always at 0xFE00 (refer to link file)
  13          //-----------------------------------------------------------------------------
  14          void FuncAt_0xFE00(void)
  15          {
  16   1          _nop_();
  17   1          _nop_();
  18   1          _nop_();
  19   1          _nop_();
  20   1          _nop_();
  21   1          _nop_();
  22   1          _nop_();
  23   1          _nop_();
  24   1          FlashECCode();
  25   1      }
  26          
  27          
  28          //-----------------------------------------------------------------------------
  29          // The function of EC flash
  30          //-----------------------------------------------------------------------------
  31          void FlashECCode(void)
  32          {
  33   1              _FlashCMD = 0x00;
  34   1              _SEND = 0x00;
  35   1      
  36   1              PM1DO = 0x33;           // ACK
  37   1      
  38   1              while(1) 
  39   1              {       
  40   2                      #if SUPPORT_SWKBC
                              if( IsFlag1(KBHISR,IBF) )
                              {
                                      _FlashCMD = KBHIDIR;
                                      continue;
                              }
                              #endif
  47   2                      if( IsFlag0(PM1STS,P_IBF) ) continue;
  48   2                      if( IsFlag0(PM1STS,P_C_D) ) continue;
  49   2                      _FlashCMD = PM1DI;
  50   2      
  51   2                      if(_SEND==1)
  52   2                      {
  53   3                              ECINDDR = _FlashCMD;
  54   3                              _SEND = 0x00;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 2   

  55   3                              continue;
  56   3                      }
  57   2      
  58   2                      if(_FlashCMD==0x01)
  59   2                      {
  60   3                              ECINDAR3 = 0x0F;        // Enter follow mode
  61   3                              ECINDAR2 = 0xFF;
  62   3                              ECINDAR1 = 0xFE;
  63   3                              ECINDAR0 = 0x00;                // FFFFExx = 0xFF   
  64   3                              ECINDDR = 0x00;                 // SCE# high level
  65   3                      }
  66   2                      else if(_FlashCMD==0x02)
  67   2                      {                                                       // Send SPI command
  68   3                              ECINDAR1 = 0xFD;
  69   3                              _SEND = 1;
  70   3                      }
  71   2                      else if(_FlashCMD==0x03)
  72   2                      {                                                       // write byte to spi
  73   3                              _SEND = 1;
  74   3                      }
  75   2                      else if(_FlashCMD==0x04)
  76   2                      {       
  77   3                              PM1DO=ECINDDR;                  // Read byte from spi                   
  78   3                      }
  79   2                      else if(_FlashCMD==0x05)
  80   2                      {       
  81   3                              ECINDAR3 = 0x00;        //Exit follow mode
  82   3                              ECINDAR2 = 0x00;
  83   3                      }
  84   2                      else if(_FlashCMD==0xFC)
  85   2                      {       
  86   3                              ExitRamCodeCommand=0xAA;
  87   3                              break;
  88   3                      }
  89   2                      else if(_FlashCMD==0xFD)
  90   2                      {
  91   3                              WDTCON |= 0x01;     /* WDTRST = 1 Reset watch dog timer.*/
  92   3                              WDTCON |= 0x02;     /* WDTEN  = 1 Enable watch dog.     */
  93   3                      while(1);                               // Wait for watch dog time-out                          
  94   3                      }
  95   2                      else if(_FlashCMD==0xFE)
  96   2                      {       
  97   3                          //BRAM[63]=0x55;
  98   3                              BRAM[60]=0x55;  //J74_001A++ 
  99   3                              WDTCON |= 0x01;     /* WDTRST = 1 Reset watch dog timer.*/
 100   3                              WDTCON |= 0x02;     /* WDTEN  = 1 Enable watch dog.     */
 101   3                      while(1);                               // Wait for watch dog time-out
 102   3                      }
 103   2              }
 104   1              main();
 105   1      }
 106          
 107          
 108          //-----------------------------------------------------------------------------
 109          // The function of reading SPI status ( command 0x05)
 110          //      After this function, spi status will save to SPIReadStatus
 111          //-----------------------------------------------------------------------------
 112          void SPI_Read_Status(void)
 113          {
 114   1              ECINDAR3 = 0x0F; 
 115   1              ECINDAR2 = 0xFF;
 116   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 3   

 117   1      
 118   1              ECINDAR1 = 0xFE;
 119   1              ECINDDR = 0xFF;                                 // SCE# high level
 120   1              ECINDAR1 = 0xFD;
 121   1              ECINDDR = SPICmd_ReadStatus;    // Read status command
 122   1      
 123   1              SPIReadStatus = ECINDDR;                // Save status Register to SPIReadStatus
 124   1              
 125   1              ECINDAR3 = 0x00;                        //Exit follow mode
 126   1              ECINDAR2 = 0x00;
 127   1      }
 128          
 129          //-----------------------------------------------------------------------------
 130          // The function of Write SPI status ( command 0x01)
 131          //      After this function, the value of SPIWriteStatus will write to spi status
 132          //-----------------------------------------------------------------------------
 133          void SPI_Write_Status(void)
 134          {
 135   1              ECINDAR3 = 0x0F; 
 136   1              ECINDAR2 = 0xFF;
 137   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 138   1      
 139   1              ECINDAR1 = 0xFE;
 140   1              ECINDDR = 0xFF;                                 // SCE# high level
 141   1              ECINDAR1 = 0xFD;
 142   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 143   1              while(1)                                                // waiting spi free
 144   1              {
 145   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 146   2              {
 147   3                  break;
 148   3              } 
 149   2              }                                                               
 150   1      
 151   1              ECINDAR1 = 0xFE;
 152   1              ECINDDR = 0xFF;                                 // SCE# high level
 153   1              ECINDAR1 = 0xFD;
 154   1              ECINDDR = SPICmd_WREN;                  // Write enable 
 155   1              
 156   1          if(SPIID==SSTID)
 157   1              {
 158   2                      ECINDAR1 = 0xFE;
 159   2                      ECINDDR = 0xFF;                         // SCE# high level
 160   2                      ECINDAR1 = 0xFD;
 161   2                      ECINDDR = SPICmd_EWSR;          // Enable Write Status Register
 162   2              }    
 163   1              
 164   1              ECINDAR1 = 0xFE;
 165   1              ECINDDR = 0xFF;                                 // SCE# high level
 166   1              ECINDAR1 = 0xFD;
 167   1              ECINDDR = SPICmd_WRSR;                  // Write status command
 168   1              ECINDDR = SPIWriteStatus;               // Write SPIWriteStatus to spi status register
 169   1      
 170   1              ECINDAR1 = 0xFE;
 171   1              ECINDDR = 0xFF;                                 // SCE# high level
 172   1              ECINDAR1 = 0xFD;
 173   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 174   1              while(1)                                                // waiting spi free
 175   1              {
 176   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 177   2              {
 178   3                  break;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 4   

 179   3              } 
 180   2              }
 181   1              
 182   1              ECINDAR3 = 0x00;                        //Exit follow mode
 183   1              ECINDAR2 = 0x00;
 184   1      }
 185          
 186          //-----------------------------------------------------------------------------
 187          // The function of reading SPI ID (command 0x9F)
 188          //      After this function, spi id will save to array SPIIDBuf[] 
 189          //-----------------------------------------------------------------------------
 190          void SPI_Read_ID(void)
 191          {
 192   1              ECINDAR3 = 0x0F; 
 193   1              ECINDAR2 = 0xFF;
 194   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 195   1              
 196   1              ECINDAR1 = 0xFE;
 197   1              ECINDDR = 0xFF;                                 // SCE# high level
 198   1              ECINDAR1 = 0xFD;
 199   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 200   1              while(1)                                                // waiting spi free
 201   1              {
 202   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 203   2              {
 204   3                  break;
 205   3              } 
 206   2              }                                                               
 207   1      
 208   1              ECINDAR1 = 0xFE;
 209   1              ECINDDR = 0xFF;                                 // SCE# high level
 210   1              ECINDAR1 = 0xFD;
 211   1              ECINDDR = SPICmd_DeviceID;  // Manufacture ID command
 212   1              for(SPIIndex=0x00;SPIIndex<4;SPIIndex++)
 213   1              {
 214   2                      SPIIDBuf[SPIIndex] = ECINDDR;
 215   2              }
 216   1              SPIID = SPIIDBuf[0];    
 217   1      
 218   1              ECINDAR1 = 0xFE;
 219   1              ECINDDR = 0xFF;                                 // SCE# high level
 220   1              ECINDAR1 = 0xFD;
 221   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 222   1      
 223   1              while(1)                                                // waiting spi free
 224   1              {
 225   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 226   2              {
 227   3                  break;
 228   3              } 
 229   2              }
 230   1              ECINDAR3 = 0x00;        //Exit follow mode
 231   1              ECINDAR2 = 0x00;
 232   1      }
 233          
 234          //-----------------------------------------------------------------------------
 235          // The function of reading SPI ID (command 0xAB)
 236          //      After this function, spi id will save to array SPIIDBuf[] 
 237          //-----------------------------------------------------------------------------
 238          void SPI_Read_ID_CmdAB(void)
 239          {
 240   1              ECINDAR3 = 0x0F; 
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 5   

 241   1              ECINDAR2 = 0xFF;
 242   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 243   1              
 244   1              ECINDAR1 = 0xFE;
 245   1              ECINDDR = 0xFF;                                 // SCE# high level
 246   1              ECINDAR1 = 0xFD;
 247   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 248   1              while(1)                                                // waiting spi free
 249   1              {
 250   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 251   2              {
 252   3                  break;
 253   3              } 
 254   2              }                                                               
 255   1      
 256   1              ECINDAR1 = 0xFE;
 257   1              ECINDDR = 0xFF;                                 // SCE# high level
 258   1              ECINDAR1 = 0xFD;
 259   1              ECINDDR = SPICmd_RDID;              // Read ID command
 260   1          ECINDDR = 0x00;                         // Read ID command addr2
 261   1          ECINDDR = 0x00;                         // Read ID command addr1
 262   1          ECINDDR = 0x00;                         // Read ID command addr0
 263   1          
 264   1              for(SPIIndex=0x00;SPIIndex<4;SPIIndex++)
 265   1              {
 266   2                      SPIIDBuf[SPIIndex] = ECINDDR; 
 267   2              }
 268   1              SPIID = SPIIDBuf[0];    
 269   1      
 270   1              ECINDAR1 = 0xFE;
 271   1              ECINDDR = 0xFF;                                 // SCE# high level
 272   1              ECINDAR1 = 0xFD;
 273   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 274   1      
 275   1              while(1)                                                // waiting spi free
 276   1              {
 277   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 278   2              {
 279   3                  break;
 280   3              } 
 281   2              }
 282   1              ECINDAR3 = 0x00;        //Exit follow mode
 283   1              ECINDAR2 = 0x00;
 284   1      }
 285          
 286          //-----------------------------------------------------------------------------
 287          // The function of Erasing SPI
 288          //-----------------------------------------------------------------------------
 289          void SPI_Erase(void)
 290          {
 291   1              ECINDAR3 = 0x0F; 
 292   1              ECINDAR2 = 0xFF;
 293   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 294   1              
 295   1              ECINDAR1 = 0xFE;
 296   1              ECINDDR = 0xFF;                                 // SCE# high level
 297   1              ECINDAR1 = 0xFD;
 298   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 299   1              while(1)                                                // waiting spi free
 300   1              {
 301   2                      if((ECINDDR&(SPIStatus_BUSY+SPIStatus_WEL))==SPIStatus_WriteEnable)
 302   2              {
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 6   

 303   3                  break;
 304   3              } 
 305   2              }                                                               
 306   1      
 307   1              ECINDAR1 = 0xFE;
 308   1              ECINDDR = 0xFF;                                 // SCE# high level
 309   1              ECINDAR1 = 0xFD;
 310   1              ECINDDR = SPIAEraseCmd;                 // Send erase command
 311   1              for(SPIIndex=0x00;SPIIndex<3;SPIIndex++)
 312   1              {
 313   2                      ECINDDR = SPIAddrCycle[SPIIndex];
 314   2              }                                                               // Send address cycle
 315   1      
 316   1              ECINDAR1 = 0xFE;
 317   1              ECINDDR = 0xFF;                                 // SCE# high level
 318   1      
 319   1              ECINDAR1 = 0xFD;
 320   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 321   1      
 322   1              while(1)                                                // waiting spi free
 323   1              {
 324   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 325   2              {
 326   3                  break;
 327   3              } 
 328   2              }
 329   1              ECINDAR3 = 0x00;                        //Exit follow mode
 330   1              ECINDAR2 = 0x00;
 331   1      }
 332          
 333          //-----------------------------------------------------------------------------
 334          // The function of SPI write enable
 335          //-----------------------------------------------------------------------------
 336          void SPI_Write_Enable(void)
 337          {
 338   1              ECINDAR3 = 0x0F; 
 339   1              ECINDAR2 = 0xFF;
 340   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 341   1              
 342   1              ECINDAR1 = 0xFE;
 343   1              ECINDDR = 0xFF;                                 // SCE# high level
 344   1              ECINDAR1 = 0xFD;
 345   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 346   1              while(1)                                                // waiting spi free
 347   1              {
 348   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 349   2              {
 350   3                  break;
 351   3              } 
 352   2              }                                                               
 353   1      
 354   1              ECINDAR1 = 0xFE;
 355   1              ECINDDR = 0xFF;                                 // SCE# high level
 356   1              ECINDAR1 = 0xFD;
 357   1              ECINDDR = SPICmd_WREN;                  // Write enable 
 358   1              
 359   1          if(SPIID==SSTID)
 360   1          {
 361   2              ECINDAR1 = 0xFE;
 362   2              ECINDDR = 0xFF;                         // SCE# high level
 363   2              ECINDAR1 = 0xFD;
 364   2              ECINDDR = SPICmd_EWSR;          // Enable Write Status Register
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 7   

 365   2          }
 366   1          
 367   1              ECINDAR1 = 0xFE;
 368   1              ECINDDR = 0xFF;                                 // SCE# high level
 369   1              ECINDAR1 = 0xFD;
 370   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 371   1              while(1)                                                // waiting spi free
 372   1              {
 373   2                      if((ECINDDR&(SPIStatus_WEL+SPIStatus_BUSY))==0x02) // Check write enable and spi not busy
 374   2              {
 375   3                  break;
 376   3              } 
 377   2              }
 378   1      
 379   1              ECINDAR3 = 0x00;                        //Exit follow mode
 380   1              ECINDAR2 = 0x00;
 381   1      }
 382          
 383          //-----------------------------------------------------------------------------
 384          // The function of SPI write disable
 385          //-----------------------------------------------------------------------------
 386          void SPI_Write_Disable(void)
 387          {
 388   1              ECINDAR3 = 0x0F; 
 389   1              ECINDAR2 = 0xFF;
 390   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 391   1              
 392   1              ECINDAR1 = 0xFE;
 393   1              ECINDDR = 0xFF;                                 // SCE# high level
 394   1              ECINDAR1 = 0xFD;
 395   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 396   1              while(1)                                                // waiting spi free
 397   1              {
 398   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 399   2              {
 400   3                  break;
 401   3              } 
 402   2              }                                                               
 403   1      
 404   1              ECINDAR1 = 0xFE;
 405   1              ECINDDR = 0xFF;                                 // SCE# high level
 406   1              ECINDAR1 = 0xFD;
 407   1              ECINDDR = SPICmd_WRDI;                  // Write disable        
 408   1      
 409   1              ECINDAR1 = 0xFE;
 410   1              ECINDDR = 0xFF;                                 // SCE# high level
 411   1              ECINDAR1 = 0xFD;
 412   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 413   1              while(1)                                                // waiting spi free
 414   1              {
 415   2                      if((ECINDDR&(SPIStatus_WEL+SPIStatus_BUSY))==0x00) // Check write disable and spi not busy
 416   2              {
 417   3                  break;
 418   3              } 
 419   2              }
 420   1      
 421   1              ECINDAR3 = 0x00;                        //Exit follow mode
 422   1              ECINDAR2 = 0x00;
 423   1      }
 424          
 425          //-----------------------------------------------------------------------------
 426          // The function of other SPI write 256 bytes
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 8   

 427          //-----------------------------------------------------------------------------
 428          void Other_SPI_Write_256Bytes(void)
 429          {
 430   1              ECINDAR3 = 0x0F; 
 431   1              ECINDAR2 = 0xFF;
 432   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 433   1              
 434   1              ECINDAR1 = 0xFE;
 435   1              ECINDDR = 0xFF;                                 // SCE# high level
 436   1              ECINDAR1 = 0xFD;
 437   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 438   1              while(1)                                                // waiting spi free
 439   1              {
 440   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 441   2              {
 442   3                  break;
 443   3              } 
 444   2              }                                                               
 445   1      
 446   1              ECINDAR1 = 0xFE;
 447   1              ECINDDR = 0xFF;                             // SCE# high level
 448   1              ECINDAR1 = 0xFD;
 449   1          ECINDDR = SPICmd_BYTEProgram;   // Send Program One Data Byte command
 450   1      
 451   1              ECINDDR = SPIAddrCycle[0];          // For 256 bytes function limite
 452   1              ECINDDR = SPIAddrCycle[1];
 453   1              ECINDDR = SPIAddrCycle[2];
 454   1              
 455   1              SPIIndex = 0x00;
 456   1              do
 457   1              {
 458   2                      ECINDDR = *SPIDataPointer;
 459   2                      SPIIndex++;
 460   2                      SPIDataPointerLowByte++;
 461   2              }while(SPIIndex!=0x00);             // Send 256 bytes
 462   1      
 463   1              ECINDAR1 = 0xFE;
 464   1              ECINDDR = 0xFF;                                 // SCE# high level
 465   1              ECINDAR1 = 0xFD;
 466   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 467   1              while(1)                                                // waiting spi free
 468   1              {
 469   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 470   2              {
 471   3                  break;
 472   3              } 
 473   2              }       
 474   1      
 475   1              ECINDAR3 = 0x00;                        // Exit follow mode
 476   1              ECINDAR2 = 0x00;                                // For 256 bytes function limite
 477   1      }
 478          
 479          //-----------------------------------------------------------------------------
 480          // The function of SST SPI write 256 bytes (for Word AAI command)
 481          //-----------------------------------------------------------------------------
 482          void SST_SPI_Write_256Bytes(void)
 483          {
 484   1              ECINDAR3 = 0x0F; 
 485   1              ECINDAR2 = 0xFF;
 486   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 487   1              
 488   1              ECINDAR1 = 0xFE;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 9   

 489   1              ECINDDR = 0xFF;                                 // SCE# high level
 490   1              ECINDAR1 = 0xFD;
 491   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 492   1              while(1)                                                // waiting spi free
 493   1              {
 494   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 495   2              {
 496   3                  break;
 497   3              } 
 498   2              }                                                               
 499   1      
 500   1              ECINDAR1 = 0xFE;
 501   1              ECINDDR = 0xFF;                             // SCE# high level
 502   1              ECINDAR1 = 0xFD;
 503   1          ECINDDR = SPICmd_AAIWordProgram;    // Auto Address Increment Programming
 504   1      
 505   1              ECINDDR = SPIAddrCycle[0];          // For 256 bytes function limite
 506   1              ECINDDR = SPIAddrCycle[1];
 507   1              ECINDDR = SPIAddrCycle[2];
 508   1              
 509   1              SPIIndex = 0x00;
 510   1              do
 511   1              { 
 512   2                      ECINDDR = *SPIDataPointer;
 513   2                      SPIIndex++;
 514   2                      SPIDataPointerLowByte++;
 515   2      
 516   2                  if((SPIIndex%2)==0x00)
 517   2                  {
 518   3                          ECINDAR1 = 0xFE;
 519   3                          ECINDDR = 0xFF;                                     // SCE# high level
 520   3                          ECINDAR1 = 0xFD;
 521   3                          ECINDDR = SPICmd_ReadStatus;        // Read Status Register
 522   3                          while(1)                                            // waiting spi free
 523   3                          {
 524   4                                  if((ECINDDR&SPIStatus_BUSY)==0x00)
 525   4                          {
 526   5                          break;
 527   5                      } 
 528   4                          }   
 529   3                      
 530   3                  if(SPIIndex!=0x00)
 531   3                  {
 532   4                              ECINDAR1 = 0xFE;
 533   4                              ECINDDR = 0xFF;                                             // SCE# high level
 534   4                              ECINDAR1 = 0xFD;
 535   4                              ECINDDR = SPICmd_AAIWordProgram;                // Auto Address Increment Programming
 536   4                  }
 537   3                  }
 538   2              }while(SPIIndex!=0x00);                                 // Send 256 bytes
 539   1      
 540   1              ECINDAR1 = 0xFE;
 541   1              ECINDDR = 0xFF;                             // SCE# high level
 542   1              ECINDAR1 = 0xFD;
 543   1          ECINDDR = SPICmd_WRDI;          // Write disable
 544   1      
 545   1          WNCKR = 0x00;                   // Delay 15.26 us
 546   1          WNCKR = 0x00;                   // Delay 15.26 us
 547   1          WNCKR = 0x00;                   // Delay 15.26 us
 548   1          WNCKR = 0x00;                   // Delay 15.26 us
 549   1      
 550   1              ECINDAR3 = 0x00;                        // Exit follow mode
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 10  

 551   1              ECINDAR2 = 0x00;                                // For 256 bytes function limite
 552   1      }
 553          
 554          //-----------------------------------------------------------------------------
 555          // The function of old SST SPI write 256 bytes
 556          //-----------------------------------------------------------------------------
 557          void Old_SST_SPI_Write_256Bytes(void)
 558          {
 559   1              ECINDAR3 = 0x0F; 
 560   1              ECINDAR2 = 0xFF;
 561   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 562   1              
 563   1              ECINDAR1 = 0xFE;
 564   1              ECINDDR = 0xFF;                                 // SCE# high level
 565   1              ECINDAR1 = 0xFD;
 566   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 567   1              while(1)                                                // waiting spi free
 568   1              {
 569   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 570   2              {
 571   3                  break;
 572   3              } 
 573   2              }                                                               
 574   1      
 575   1              ECINDAR1 = 0xFE;
 576   1              ECINDDR = 0xFF;                             // SCE# high level
 577   1              ECINDAR1 = 0xFD;
 578   1          ECINDDR = SPICmd_AAIProgram;    // Auto Address Increment Programming
 579   1      
 580   1              ECINDDR = SPIAddrCycle[0];          // For 256 bytes function limite
 581   1              ECINDDR = SPIAddrCycle[1];
 582   1              ECINDDR = SPIAddrCycle[2];
 583   1              
 584   1              SPIIndex = 0x00;
 585   1              do
 586   1              {
 587   2                      ECINDDR = *SPIDataPointer;
 588   2                      SPIIndex++;
 589   2                      SPIDataPointerLowByte++;
 590   2      
 591   2                  ECINDAR1 = 0xFE;
 592   2                  ECINDDR = 0xFF;                                     // SCE# high level
 593   2                  ECINDAR1 = 0xFD;
 594   2                  ECINDDR = SPICmd_ReadStatus;        // Read Status Register
 595   2                  while(1)                                            // waiting spi free
 596   2                  {
 597   3                          if((ECINDDR&SPIStatus_BUSY)==0x00)
 598   3                  {
 599   4                      break;
 600   4                  } 
 601   3                  }   
 602   2      
 603   2              if(SPIIndex!=0x00)
 604   2              {
 605   3                      ECINDAR1 = 0xFE;
 606   3                      ECINDDR = 0xFF;                     // SCE# high level
 607   3                      ECINDAR1 = 0xFD;       
 608   3                  ECINDDR = SPICmd_AAIProgram;    // Auto Address Increment Programming
 609   3              }
 610   2              }while(SPIIndex!=0x00);             // Send 256 bytes
 611   1      
 612   1              ECINDAR1 = 0xFE;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 11  

 613   1              ECINDDR = 0xFF;                             // SCE# high level
 614   1              ECINDAR1 = 0xFD;
 615   1          ECINDDR = SPICmd_WRDI;          // Write disable
 616   1      
 617   1      
 618   1          WNCKR = 0x00;                   // Delay 15.26 us
 619   1          WNCKR = 0x00;                   // Delay 15.26 us
 620   1          WNCKR = 0x00;                   // Delay 15.26 us
 621   1          WNCKR = 0x00;                   // Delay 15.26 us
 622   1              //ECINDAR1 = 0xFE;
 623   1              //ECINDDR = 0xFF;                                       // SCE# high level
 624   1              //ECINDAR1 = 0xFD;
 625   1              //ECINDDR = SPICmd_ReadStatus;  // Read Status Register
 626   1              //while(1)                                              // waiting spi free
 627   1              //{
 628   1              //      if((ECINDDR&(SPIStatus_BUSY+SSTSPIStatus_AAI))==0x00)
 629   1          //    {
 630   1          //        break;
 631   1          //    } 
 632   1              //}     
 633   1      
 634   1              ECINDAR3 = 0x00;                        // Exit follow mode
 635   1              ECINDAR2 = 0x00;                                // For 256 bytes function limite
 636   1      }
 637          
 638          
 639          
 640          
 641          
 642          
 643          //-----------------------------------------------------------------------------
 644          // The function of SPI write 256 bytes
 645          //-----------------------------------------------------------------------------
 646          void SPI_Write_256Bytes(void)
 647          {
 648   1          if(SPIID==SSTID)
 649   1          {
 650   2              if(SSTDeviceID==SSTID_Old) 
 651   2              {
 652   3                  LoadSPIFucnToRam(Old_SST_SPI_Write_256Bytes);   // Load function to ram
 653   3              }
 654   2              else
 655   2              {
 656   3                      LoadSPIFucnToRam(SST_SPI_Write_256Bytes);       // Load function to ram
 657   3              }
 658   2          }
 659   1          else
 660   1          {
 661   2                  LoadSPIFucnToRam(Other_SPI_Write_256Bytes); // Load function to ram
 662   2          }  
 663   1      }
 664          
 665          
 666          
 667          
 668          //-----------------------------------------------------------------------------
 669          // The function of SPI read 256 bytes
 670          //-----------------------------------------------------------------------------
 671          void SPI_Read_256Bytes(void)
 672          {
 673   1              ECINDAR3 = 0x0F; 
 674   1              ECINDAR2 = 0xFF;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 12  

 675   1              ECINDAR0 = 0x00;                                // FFFFExx = 0xFF  
 676   1              
 677   1              ECINDAR1 = 0xFE;
 678   1              ECINDDR = 0xFF;                                 // SCE# high level
 679   1              ECINDAR1 = 0xFD;
 680   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 681   1              while(1)                                                // waiting spi free
 682   1              {
 683   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 684   2              {
 685   3                  break;
 686   3              } 
 687   2              }                                                               
 688   1      
 689   1              ECINDAR1 = 0xFE;
 690   1              ECINDDR = 0xFF;                                         // SCE# high level
 691   1              ECINDAR1 = 0xFD;
 692   1              ECINDDR = SPICmd_HighSpeedRead;         // High-Speed Read
 693   1      
 694   1              ECINDDR = SPIAddrCycle[0];                      // For 256 bytes function limite
 695   1              ECINDDR = SPIAddrCycle[1];
 696   1              ECINDDR = SPIAddrCycle[2];
 697   1              ECINDDR = 0x00;                                         // dummy byte
 698   1              
 699   1              SPIIndex = 0x00;
 700   1              do
 701   1              {
 702   2                      *SPIDataPointer = ECINDDR;;
 703   2                      SPIIndex++;
 704   2                      SPIDataPointerLowByte++;
 705   2              }while(SPIIndex!=0x00);                                 // Send 256 bytes
 706   1      
 707   1              ECINDAR1 = 0xFE;
 708   1              ECINDDR = 0xFF;                                 // SCE# high level
 709   1              ECINDAR1 = 0xFD;
 710   1              ECINDDR = SPICmd_ReadStatus;    // Read Status Register
 711   1              while(1)                                                // waiting spi free
 712   1              {
 713   2                      if((ECINDDR&SPIStatus_BUSY)==0x00)
 714   2              {
 715   3                  break;
 716   3              } 
 717   2              }       
 718   1      
 719   1              ECINDAR3 = 0x00;                        // Exit follow mode
 720   1              ECINDAR2 = 0x00;                                // For 256 bytes function limite
 721   1      }
 722          
 723          
 724          
 725          
 726          
 727          //-----------------------------------------------------------------------------
 728          // The function of loading function to external ram 0x600 ~ 0x6FF
 729          //                                                                              LoadSPIFucnToRam_Address in Core_Flash.h
 730          //-----------------------------------------------------------------------------
 731          void LoadSPIFucnToRam(FUNCT_PTR_V_V funcpoint)
 732          {
 733   1              Tmp_XPntr = LoadSPIFucnToRam_Address;
 734   1              Tmp_code_pointer = funcpoint;
 735   1      
 736   1              _R2= 0x00;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 13  

 737   1              do
 738   1              {
 739   2                      *Tmp_XPntr = *Tmp_code_pointer;
 740   2                      Tmp_XPntr++;
 741   2                      Tmp_code_pointer++;
 742   2                      _R2++;
 743   2              }while(_R2!=0x00);
 744   1      
 745   1      }
 746          
 747          //-----------------------------------------------------------------------------
 748          // The function for ITE flash utility
 749          //-----------------------------------------------------------------------------
 750          #pragma ot(7, SIZE)
 751          void ITE_Flash_Utility(void)
 752          {
 753   1              DisableAllInterrupt();                          // Disable all interrupt 
 754   1              LoadSPIFucnToRam(FlashECCode);          // Load function to ram
 755   1              SET_MASK(FBCFG,SSMC);                   // enable scatch ROM
 756   1              FuncAt_0xFE00();                                        // do function in extern ram 0x600
 757   1      }
 758          
 759          
 760          //*****************************************************************************
 761          // OEM FUNCTION CALL
 762          //*****************************************************************************
 763          //-----------------------------------------------------------------------------
 764          // The function for oem code write spi status
 765          //-----------------------------------------------------------------------------
 766          #pragma ot(7, SIZE)
 767          void Do_SPI_Write_Status(BYTE statusvalue)
 768          {
 769   1              SPIWriteStatus = statusvalue;
 770   1              
 771   1              DisableAllInterrupt();                          // Disable all interrupt 
 772   1              LoadSPIFucnToRam(SPI_Write_Status);     // Load function to ram
 773   1              SET_MASK(FBCFG,SSMC);                   // enable scatch ROM
 774   1              FuncAt_0xFE00();                                        // do function in extern ram 0x600
 775   1              EnableAllInterrupt();                           // Enable all interrupt 
 776   1              CLEAR_MASK(FBCFG,SSMC);                 // disable scatch ROM
 777   1      }
 778          
 779          //-----------------------------------------------------------------------------
 780          // The function for oem code read spi status
 781          //              Note : SPI status always save to SPIReadStatus
 782          //-----------------------------------------------------------------------------
 783          #pragma ot(7, SIZE)
 784          void Do_SPI_Read_Status(void)
 785          {
 786   1              DisableAllInterrupt();                          // Disable all interrupt 
 787   1              LoadSPIFucnToRam(SPI_Read_Status);      // Load function to ram
 788   1              SET_MASK(FBCFG,SSMC);                   // enable scatch ROM
 789   1              FuncAt_0xFE00();                                        // do function in extern ram 0x600
 790   1              EnableAllInterrupt();                           // Enable all interrupt 
 791   1              CLEAR_MASK(FBCFG,SSMC);                 // disable scatch ROM
 792   1      }
 793          
 794          //-----------------------------------------------------------------------------
 795          // The function for oem code read spi ID (command 0x9F)   
 796          //              Note : SPI ID always save to array SPIIDBuf[]
 797          //-----------------------------------------------------------------------------
 798          #pragma ot(7, SIZE)
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 14  

 799          void Do_SPI_Read_ID(void)
 800          {
 801   1              DisableAllInterrupt();                  // Disable all interrupt 
 802   1              LoadSPIFucnToRam(SPI_Read_ID);  // Load function to ram
 803   1              SET_MASK(FBCFG,SSMC);           // enable scatch ROM
 804   1              FuncAt_0xFE00();                                // do function in extern ram 0x600
 805   1              EnableAllInterrupt();               // Enable all interrupt 
 806   1              CLEAR_MASK(FBCFG,SSMC);         // disable scatch ROM
 807   1      }
 808          
 809          //-----------------------------------------------------------------------------
 810          // The function for oem code read spi ID (command 0xAB)
 811          //              Note : SPI ID always save to array SPIIDBuf[]
 812          //-----------------------------------------------------------------------------
 813          #pragma ot(7, SIZE)
 814          void Do_SPI_Read_ID_CmdAB(void)
 815          {
 816   1              DisableAllInterrupt();                  // Disable all interrupt 
 817   1              LoadSPIFucnToRam(SPI_Read_ID_CmdAB);    // Load function to ram
 818   1              SET_MASK(FBCFG,SSMC);           // enable scatch ROM
 819   1              FuncAt_0xFE00();                                // do function in extern ram 0x600
 820   1              EnableAllInterrupt();               // Enable all interrupt 
 821   1              CLEAR_MASK(FBCFG,SSMC);         // disable scatch ROM
 822   1      }
 823          
 824          //-----------------------------------------------------------------------------
 825          // The function for oem code erase spi
 826          //              Input : 1 EraseCmd --> Only support SPICmd_Erase4KByte, 
 827          //                                                              SPICmd_Erase32KByte, and SPICmd_Erase64KByte.
 828          //                              2 Addr2    --> A23 ~ A16
 829          //                              3 Addr1    --> A15 ~ A8
 830          //                              4 Addr0    --> A7  ~ A0
 831          //-----------------------------------------------------------------------------
 832          #pragma ot(7, SIZE)
 833          void Do_SPI_Erase(BYTE EraseCmd, BYTE Addr2, BYTE Addr1, BYTE Addr0)
 834          {
 835   1              SPIAEraseCmd = EraseCmd;
 836   1              SPIAddrCycle[0] = Addr2;
 837   1              SPIAddrCycle[1] = Addr1;
 838   1              SPIAddrCycle[2] = Addr0;
 839   1                              
 840   1              DisableAllInterrupt();                  // Disable all interrupt 
 841   1              LoadSPIFucnToRam(SPI_Erase);    // Load function to ram
 842   1              SET_MASK(FBCFG,SSMC);           // enable scatch ROM
 843   1              FuncAt_0xFE00();                                // do function in extern ram 0x600
 844   1              EnableAllInterrupt();               // Enable all interrupt 
 845   1              CLEAR_MASK(FBCFG,SSMC);         // disable scatch ROM
 846   1      }
 847          
 848          //-----------------------------------------------------------------------------
 849          // The function for oem code write spi 256 bytes
 850          //              Input : 1 DataPointer --> Pointe to external memory
 851          //                              2 Addr2    --> A23 ~ A16
 852          //                              3 Addr1    --> A15 ~ A8
 853          //                              4 Addr0    --> A7  ~ A0
 854          //-----------------------------------------------------------------------------
 855          #pragma ot(7, SIZE)
 856          void Do_SPI_Write_256Bytes(XBYTE *DataPointer, BYTE Addr2, BYTE Addr1, BYTE Addr0)
 857          {
 858   1              SPIDataPointer = DataPointer;
 859   1              SPIAddrCycle[0] = Addr2;
 860   1              SPIAddrCycle[1] = Addr1;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 15  

 861   1              SPIAddrCycle[2] = Addr0;
 862   1                              
 863   1              DisableAllInterrupt();                          // Disable all interrupt 
 864   1              SPI_Write_256Bytes();               // Load function to ram
 865   1              SET_MASK(FBCFG,SSMC);                   // enable scatch ROM
 866   1              FuncAt_0xFE00();                                        // do function in extern ram 0x600
 867   1              EnableAllInterrupt();                           // Enable all interrupt 
 868   1              CLEAR_MASK(FBCFG,SSMC);                 // disable scatch ROM
 869   1      }
 870          
 871          //-----------------------------------------------------------------------------
 872          // The function for oem code read spi 256 bytes to external memory
 873          //              Input : 1 DataPointer --> Pointe to external memory
 874          //                              2 Addr2    --> A23 ~ A16
 875          //                              3 Addr1    --> A15 ~ A8
 876          //                              4 Addr0    --> A7  ~ A0
 877          //-----------------------------------------------------------------------------
 878          #pragma ot(7, SIZE)
 879          void Do_SPI_Read_256Bytes(XBYTE *DataPointer, BYTE Addr2, BYTE Addr1, BYTE Addr0)
 880          {
 881   1              SPIDataPointer = DataPointer;
 882   1              SPIAddrCycle[0] = Addr2;
 883   1              SPIAddrCycle[1] = Addr1;
 884   1              SPIAddrCycle[2] = Addr0;
 885   1                              
 886   1              DisableAllInterrupt();                          // Disable all interrupt 
 887   1              LoadSPIFucnToRam(SPI_Read_256Bytes);    // Load function to ram
 888   1              SET_MASK(FBCFG,SSMC);                   // enable scatch ROM
 889   1              FuncAt_0xFE00();                                        // do function in extern ram 0x600
 890   1              EnableAllInterrupt();                           // Enable all interrupt 
 891   1              CLEAR_MASK(FBCFG,SSMC);                 // disable scatch ROM
 892   1      }
 893          
 894          
 895          
 896          //-----------------------------------------------------------------------------
 897          // The function for oem code spi write enable
 898          //-----------------------------------------------------------------------------
 899          #pragma ot(7, SIZE)
 900          void Do_SPI_Write_Enable(void)
 901          {
 902   1              DisableAllInterrupt();                          // Disable all interrupt 
 903   1              LoadSPIFucnToRam(SPI_Write_Enable);     // Load function to ram
 904   1              SET_MASK(FBCFG,SSMC);                   // enable scatch ROM
 905   1              FuncAt_0xFE00();                                        // do function in extern ram 0x600
 906   1              EnableAllInterrupt();                           // Enable all interrupt 
 907   1              CLEAR_MASK(FBCFG,SSMC);                 // disable scatch ROM
 908   1      }
 909          
 910          //-----------------------------------------------------------------------------
 911          // The function for oem code spi write disable
 912          //-----------------------------------------------------------------------------
 913          #pragma ot(7, SIZE)
 914          void Do_SPI_Write_Disable(void)
 915          {
 916   1              DisableAllInterrupt();                          // Disable all interrupt 
 917   1              LoadSPIFucnToRam(SPI_Write_Disable);    // Load function to ram
 918   1              SET_MASK(FBCFG,SSMC);                   // enable scatch ROM
 919   1              FuncAt_0xFE00();                                        // do function in extern ram 0x600
 920   1              EnableAllInterrupt();                           // Enable all interrupt 
 921   1              CLEAR_MASK(FBCFG,SSMC);                 // disable scatch ROM
 922   1      }
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 16  

 923          
 924          
 925          
 926          
 927          //-----------------------------------------------------------------------------
 928          //                              2 Addr2    --> A23 ~ A16
 929          //                              3 Addr1    --> A15 ~ A8
 930          //                              4 Addr0    --> A7  ~ A0
 931          //-----------------------------------------------------------------------------
 932          //----------------------------------------------------------------------------
 933          // The example of reading SPI ROM 0x010000 ~ 0x0100FF to external ram 0x200 ~ 0x2FF
 934          //----------------------------------------------------------------------------
 935          
 936          void OEM_Read_SPI_256Bytes(BYTE Addr2, BYTE Addr1, BYTE Addr0)
 937          {
 938   1              Do_SPI_Read_256Bytes(0x800,Addr2,Addr1,Addr0);
 939   1              //Note: 0x800 is buffer Ram address
 940   1      }
 941          
 942          
 943          //----------------------------------------------------------------------------
 944          // The example of writing external ram 0x200 ~ 0x2FF to SPI ROM 0x010000 ~ 0x0100FF
 945          //----------------------------------------------------------------------------
 946          void OEM_Write_SPI_256Bytes(BYTE Addr2, BYTE Addr1, BYTE Addr0)
 947          {
 948   1              Do_SPI_Write_Status(SPIStatus_UnlockAll);
 949   1              Do_SPI_Write_Enable();
 950   1              Do_SPI_Erase(SPICmd_Erase4KByte,Addr2,Addr1,Addr0);
 951   1              Do_SPI_Write_Enable();
 952   1              Do_SPI_Write_256Bytes(0x800,Addr2,Addr1,Addr0);
 953   1              Do_SPI_Write_Disable();
 954   1      }
 955          
 956          
 957          //-----------------------------------------------------------------------------
 958          // The function of DMA for scratch sram
 959          //
 960          //-----------------------------------------------------------------------------
 961          const sDMAScratchSRAM code asDMAScratchSRAM[]=
 962          {
 963              { &SCAR1H, &SCAR1M, &SCAR1L },  //1024bytes(externl ram 0x800~BFF)
 964              { &SCAR2H, &SCAR2M, &SCAR2L },  // 512bytes(externl ram 0xC00~DFF)
 965              { &SCAR3H, &SCAR3M, &SCAR3L },  // 256bytes(externl ram 0xE00~EFF)
 966              { &SCAR4H, &SCAR4M, &SCAR4L }   // 256bytes(externl ram 0xF00~FFF)
 967          
 968          };
 969          
 970          //-----------------------------------------------------------------------------
 971          void  CacheDma( BYTE sramnum, WORD addr )
 972          {
 973   1              *asDMAScratchSRAM[sramnum].scarh = 0x80;
 974   1              
 975   1              /* high byte of function address.   */
 976   1              *asDMAScratchSRAM[sramnum].scarm = (WORD) addr >> 8;
 977   1              //*asDMAScratchSRAM[sramnum].scarm = 0xFE;      //For Test
 978   1              
 979   1              /* low byte of function address.    */
 980   1              *asDMAScratchSRAM[sramnum].scarl = (WORD) addr & 0xff;
 981   1              //*asDMAScratchSRAM[sramnum].scarl = 0x00;      //For Test
 982   1              
 983   1              /* start cache dma                  */
 984   1              *asDMAScratchSRAM[sramnum].scarh = 0x00;
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 17  

 985   1      
 986   1      }
 987          
 988          //----------------------------------------------------------------------------
 989          // Read SPI use EC-Indirect fast read
 990          //----------------------------------------------------------------------------
 991          BYTE EC_Indirect_Read_SPI(BYTE Addr2, BYTE Addr1, BYTE Addr0)
 992          {
 993   1              BYTE itemp, SPI_Data;
 994   1              itemp = ECINDAR3;       //save ECINDAR3
 995   1              ECINDAR3 = 0;
 996   1              ECINDAR2 = Addr2;       //High Byte
 997   1              ECINDAR1 = Addr1;       //Middle Byte
 998   1              ECINDAR0 = Addr0;       //Low Byte
 999   1              SPI_Data = ECINDDR;
1000   1              ECINDAR3 = itemp;       //restore ECINDAR3
1001   1      
1002   1              return SPI_Data;
1003   1      }
1004          
1005          
1006          #if     COMPARE_CHECKSUM
              void CalculateChecksum(void)
              {
                      BYTE code * data_pntr;
                      
                      data_pntr = 0;
                      Calc_Checksum=0x00;
              
                      while(data_pntr!=0xFFFE)        // End address ~0xFFFD
                      {
                              Calc_Checksum+= *data_pntr;  // To calculate checksum
                              data_pntr++;
              
                      }
                      
                      Calc_Checksum+=0x1FE;           // address == 0xFFFE,0xFFFF
              
              }
              
              
              WORD Get_Checksum(void)
              {
                      WORD code * data_pntr;
              
                      data_pntr = 0xFFFE;
                      
                      return(*data_pntr);
              
              }
              
              void ClearSRamF(void)
              {
                      PORT_BYTE_PNTR byte_register_pntr;
                      byte_register_pntr=0x0F00;
              
                      while(byte_register_pntr<0x1000)// Clear external ram (0x000~0xFFF)
                      {
                          *byte_register_pntr=0;
                          byte_register_pntr ++;
                      }
                              
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 18  

              }
              
              #endif          //COMPARE_CHECKSUM
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 19  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION FuncAt_0xFE00 (BEGIN)
                                           ; SOURCE LINE # 14
                                           ; SOURCE LINE # 15
                                           ; SOURCE LINE # 16
0000 00                NOP     
                                           ; SOURCE LINE # 17
0001 00                NOP     
                                           ; SOURCE LINE # 18
0002 00                NOP     
                                           ; SOURCE LINE # 19
0003 00                NOP     
                                           ; SOURCE LINE # 20
0004 00                NOP     
                                           ; SOURCE LINE # 21
0005 00                NOP     
                                           ; SOURCE LINE # 22
0006 00                NOP     
                                           ; SOURCE LINE # 23
0007 00                NOP     
                                           ; SOURCE LINE # 24
0008 020000      R     LJMP    FlashECCode
             ; FUNCTION FuncAt_0xFE00 (END)

             ; FUNCTION FlashECCode (BEGIN)
                                           ; SOURCE LINE # 31
                                           ; SOURCE LINE # 32
                                           ; SOURCE LINE # 33
0000 E4                CLR     A
0001 F500        E     MOV     _FlashCMD,A
                                           ; SOURCE LINE # 34
0003 F500        E     MOV     _SEND,A
                                           ; SOURCE LINE # 36
0005 900000      E     MOV     DPTR,#PM1DO
0008 7433              MOV     A,#033H
000A F0                MOVX    @DPTR,A
000B         ?C0002:
                                           ; SOURCE LINE # 38
                                           ; SOURCE LINE # 39
                                           ; SOURCE LINE # 47
000B 900000      E     MOV     DPTR,#PM1STS
000E E0                MOVX    A,@DPTR
000F 30E1F9            JNB     ACC.1,?C0002
0012         ?C0004:
                                           ; SOURCE LINE # 48
0012 900000      E     MOV     DPTR,#PM1STS
0015 E0                MOVX    A,@DPTR
0016 30E3F2            JNB     ACC.3,?C0002
0019         ?C0005:
                                           ; SOURCE LINE # 49
0019 900000      E     MOV     DPTR,#PM1DI
001C E0                MOVX    A,@DPTR
001D F500        E     MOV     _FlashCMD,A
                                           ; SOURCE LINE # 51
001F E500        E     MOV     A,_SEND
0021 B4010B            CJNE    A,#01H,?C0006
                                           ; SOURCE LINE # 52
                                           ; SOURCE LINE # 53
0024 900000      E     MOV     DPTR,#ECINDDR
0027 E500        E     MOV     A,_FlashCMD
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 20  

0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 54
002A E4                CLR     A
002B F500        E     MOV     _SEND,A
                                           ; SOURCE LINE # 55
002D 80DC              SJMP    ?C0002
                                           ; SOURCE LINE # 56
002F         ?C0006:
                                           ; SOURCE LINE # 58
002F E500        E     MOV     A,_FlashCMD
0031 B4011C            CJNE    A,#01H,?C0007
                                           ; SOURCE LINE # 59
                                           ; SOURCE LINE # 60
0034 900000      E     MOV     DPTR,#ECINDAR3
0037 740F              MOV     A,#0FH
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 61
003A 900000      E     MOV     DPTR,#ECINDAR2
003D 74FF              MOV     A,#0FFH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 62
0040 900000      E     MOV     DPTR,#ECINDAR1
0043 14                DEC     A
0044 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 63
0045 E4                CLR     A
0046 900000      E     MOV     DPTR,#ECINDAR0
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 64
004A 900000      E     MOV     DPTR,#ECINDDR
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 65
004E 80BB              SJMP    ?C0002
0050         ?C0007:
                                           ; SOURCE LINE # 66
0050 E500        E     MOV     A,_FlashCMD
0052 B40208            CJNE    A,#02H,?C0009
                                           ; SOURCE LINE # 67
                                           ; SOURCE LINE # 68
0055 900000      E     MOV     DPTR,#ECINDAR1
0058 74FD              MOV     A,#0FDH
005A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 69
                                           ; SOURCE LINE # 70
005B 8005              SJMP    ?C0149
005D         ?C0009:
                                           ; SOURCE LINE # 71
005D E500        E     MOV     A,_FlashCMD
005F B40305            CJNE    A,#03H,?C0011
                                           ; SOURCE LINE # 72
                                           ; SOURCE LINE # 73
0062         ?C0149:
0062 750001      E     MOV     _SEND,#01H
                                           ; SOURCE LINE # 74
0065 80A4              SJMP    ?C0002
0067         ?C0011:
                                           ; SOURCE LINE # 75
0067 E500        E     MOV     A,_FlashCMD
0069 B4040A            CJNE    A,#04H,?C0013
                                           ; SOURCE LINE # 76
                                           ; SOURCE LINE # 77
006C 900000      E     MOV     DPTR,#ECINDDR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 21  

006F E0                MOVX    A,@DPTR
0070 900000      E     MOV     DPTR,#PM1DO
0073 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 78
0074 8095              SJMP    ?C0002
0076         ?C0013:
                                           ; SOURCE LINE # 79
0076 E500        E     MOV     A,_FlashCMD
0078 B4050B            CJNE    A,#05H,?C0015
                                           ; SOURCE LINE # 80
                                           ; SOURCE LINE # 81
007B E4                CLR     A
007C 900000      E     MOV     DPTR,#ECINDAR3
007F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 82
0080 900000      E     MOV     DPTR,#ECINDAR2
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 83
0084 8085              SJMP    ?C0002
0086         ?C0015:
                                           ; SOURCE LINE # 84
0086 E500        E     MOV     A,_FlashCMD
0088 B4FC05            CJNE    A,#0FCH,?C0017
                                           ; SOURCE LINE # 85
                                           ; SOURCE LINE # 86
008B 7500AA      E     MOV     ExitRamCodeCommand,#0AAH
                                           ; SOURCE LINE # 87
008E 8024              SJMP    ?C0003
                                           ; SOURCE LINE # 88
0090         ?C0017:
                                           ; SOURCE LINE # 89
0090 E500        E     MOV     A,_FlashCMD
0092 B4FD08            CJNE    A,#0FDH,?C0019
                                           ; SOURCE LINE # 90
                                           ; SOURCE LINE # 91
0095 43D801            ORL     WDTCON,#01H
                                           ; SOURCE LINE # 92
0098 43D802            ORL     WDTCON,#02H
009B         ?C0020:
                                           ; SOURCE LINE # 93
009B 80FE              SJMP    ?C0020
                                           ; SOURCE LINE # 94
009D         ?C0019:
                                           ; SOURCE LINE # 95
009D E500        E     MOV     A,_FlashCMD
009F 64FE              XRL     A,#0FEH
00A1 6003              JZ      $ + 5H
00A3 020000      R     LJMP    ?C0002
                                           ; SOURCE LINE # 96
                                           ; SOURCE LINE # 98
00A6 900000      E     MOV     DPTR,#BRAM+03CH
00A9 7455              MOV     A,#055H
00AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 99
00AC 43D801            ORL     WDTCON,#01H
                                           ; SOURCE LINE # 100
00AF 43D802            ORL     WDTCON,#02H
00B2         ?C0024:
                                           ; SOURCE LINE # 101
00B2 80FE              SJMP    ?C0024
                                           ; SOURCE LINE # 102
                                           ; SOURCE LINE # 103
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 22  

00B4         ?C0003:
                                           ; SOURCE LINE # 104
00B4 020000      E     LJMP    main
             ; FUNCTION FlashECCode (END)

             ; FUNCTION SPI_Read_Status (BEGIN)
                                           ; SOURCE LINE # 112
                                           ; SOURCE LINE # 113
                                           ; SOURCE LINE # 114
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 115
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 116
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 118
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 119
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 120
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 121
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 123
0028 E0                MOVX    A,@DPTR
0029 900000      E     MOV     DPTR,#SPIReadStatus
002C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 125
002D E4                CLR     A
002E 900000      E     MOV     DPTR,#ECINDAR3
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 126
0032 900000      E     MOV     DPTR,#ECINDAR2
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 127
0036 22                RET     
             ; FUNCTION SPI_Read_Status (END)

             ; FUNCTION SPI_Write_Status (BEGIN)
                                           ; SOURCE LINE # 133
                                           ; SOURCE LINE # 134
                                           ; SOURCE LINE # 135
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 136
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 23  

                                           ; SOURCE LINE # 137
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 139
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 140
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 141
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 142
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0028:
                                           ; SOURCE LINE # 143
                                           ; SOURCE LINE # 144
                                           ; SOURCE LINE # 145
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0028
                                           ; SOURCE LINE # 146
                                           ; SOURCE LINE # 147
                                           ; SOURCE LINE # 148
                                           ; SOURCE LINE # 149
002F         ?C0029:
                                           ; SOURCE LINE # 151
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 152
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 153
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 154
0040 900000      E     MOV     DPTR,#ECINDDR
0043 7406              MOV     A,#06H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 156
0046 900000      E     MOV     DPTR,#SPIID
0049 E0                MOVX    A,@DPTR
004A B4BF17            CJNE    A,#0BFH,?C0031
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 158
004D 900000      E     MOV     DPTR,#ECINDAR1
0050 74FE              MOV     A,#0FEH
0052 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 159
0053 900000      E     MOV     DPTR,#ECINDDR
0056 04                INC     A
0057 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 160
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 24  

0058 900000      E     MOV     DPTR,#ECINDAR1
005B 74FD              MOV     A,#0FDH
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 161
005E 900000      E     MOV     DPTR,#ECINDDR
0061 7450              MOV     A,#050H
0063 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 162
0064         ?C0031:
                                           ; SOURCE LINE # 164
0064 900000      E     MOV     DPTR,#ECINDAR1
0067 74FE              MOV     A,#0FEH
0069 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 165
006A 900000      E     MOV     DPTR,#ECINDDR
006D 04                INC     A
006E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 166
006F 900000      E     MOV     DPTR,#ECINDAR1
0072 74FD              MOV     A,#0FDH
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 167
0075 900000      E     MOV     DPTR,#ECINDDR
0078 7401              MOV     A,#01H
007A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 168
007B 900000      E     MOV     DPTR,#SPIWriteStatus
007E E0                MOVX    A,@DPTR
007F 900000      E     MOV     DPTR,#ECINDDR
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 170
0083 900000      E     MOV     DPTR,#ECINDAR1
0086 74FE              MOV     A,#0FEH
0088 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 171
0089 900000      E     MOV     DPTR,#ECINDDR
008C 04                INC     A
008D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 172
008E 900000      E     MOV     DPTR,#ECINDAR1
0091 74FD              MOV     A,#0FDH
0093 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 173
0094 900000      E     MOV     DPTR,#ECINDDR
0097 7405              MOV     A,#05H
0099 F0                MOVX    @DPTR,A
009A         ?C0032:
                                           ; SOURCE LINE # 174
                                           ; SOURCE LINE # 175
                                           ; SOURCE LINE # 176
009A 900000      E     MOV     DPTR,#ECINDDR
009D E0                MOVX    A,@DPTR
009E 20E0F9            JB      ACC.0,?C0032
                                           ; SOURCE LINE # 177
                                           ; SOURCE LINE # 178
                                           ; SOURCE LINE # 179
                                           ; SOURCE LINE # 180
00A1         ?C0033:
                                           ; SOURCE LINE # 182
00A1 E4                CLR     A
00A2 900000      E     MOV     DPTR,#ECINDAR3
00A5 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 25  

                                           ; SOURCE LINE # 183
00A6 900000      E     MOV     DPTR,#ECINDAR2
00A9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 184
00AA 22                RET     
             ; FUNCTION SPI_Write_Status (END)

             ; FUNCTION SPI_Read_ID (BEGIN)
                                           ; SOURCE LINE # 190
                                           ; SOURCE LINE # 191
                                           ; SOURCE LINE # 192
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 193
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 194
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 196
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 197
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 198
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 199
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0036:
                                           ; SOURCE LINE # 200
                                           ; SOURCE LINE # 201
                                           ; SOURCE LINE # 202
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0036
                                           ; SOURCE LINE # 203
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
                                           ; SOURCE LINE # 206
002F         ?C0037:
                                           ; SOURCE LINE # 208
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 209
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 210
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 26  

                                           ; SOURCE LINE # 211
0040 900000      E     MOV     DPTR,#ECINDDR
0043 749F              MOV     A,#09FH
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 212
0046 E4                CLR     A
0047 900000      E     MOV     DPTR,#SPIIndex
004A F0                MOVX    @DPTR,A
004B         ?C0039:
                                           ; SOURCE LINE # 213
                                           ; SOURCE LINE # 214
004B 900000      E     MOV     DPTR,#ECINDDR
004E E0                MOVX    A,@DPTR
004F FF                MOV     R7,A
0050 900000      E     MOV     DPTR,#SPIIndex
0053 E0                MOVX    A,@DPTR
0054 2400        E     ADD     A,#LOW SPIIDBuf
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH SPIIDBuf
005B F583              MOV     DPH,A
005D EF                MOV     A,R7
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 215
005F 900000      E     MOV     DPTR,#SPIIndex
0062 E0                MOVX    A,@DPTR
0063 04                INC     A
0064 F0                MOVX    @DPTR,A
0065 E0                MOVX    A,@DPTR
0066 B404E2            CJNE    A,#04H,?C0039
0069         ?C0040:
                                           ; SOURCE LINE # 216
0069 900000      E     MOV     DPTR,#SPIIDBuf
006C E0                MOVX    A,@DPTR
006D 900000      E     MOV     DPTR,#SPIID
0070 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 218
0071 900000      E     MOV     DPTR,#ECINDAR1
0074 74FE              MOV     A,#0FEH
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 219
0077 900000      E     MOV     DPTR,#ECINDDR
007A 04                INC     A
007B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 220
007C 900000      E     MOV     DPTR,#ECINDAR1
007F 74FD              MOV     A,#0FDH
0081 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 221
0082 900000      E     MOV     DPTR,#ECINDDR
0085 7405              MOV     A,#05H
0087 F0                MOVX    @DPTR,A
0088         ?C0042:
                                           ; SOURCE LINE # 223
                                           ; SOURCE LINE # 224
                                           ; SOURCE LINE # 225
0088 900000      E     MOV     DPTR,#ECINDDR
008B E0                MOVX    A,@DPTR
008C 20E0F9            JB      ACC.0,?C0042
                                           ; SOURCE LINE # 226
                                           ; SOURCE LINE # 227
                                           ; SOURCE LINE # 228
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 27  

                                           ; SOURCE LINE # 229
008F         ?C0043:
                                           ; SOURCE LINE # 230
008F E4                CLR     A
0090 900000      E     MOV     DPTR,#ECINDAR3
0093 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 231
0094 900000      E     MOV     DPTR,#ECINDAR2
0097 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 232
0098 22                RET     
             ; FUNCTION SPI_Read_ID (END)

             ; FUNCTION SPI_Read_ID_CmdAB (BEGIN)
                                           ; SOURCE LINE # 238
                                           ; SOURCE LINE # 239
                                           ; SOURCE LINE # 240
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 241
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 242
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 244
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 245
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 246
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 247
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0046:
                                           ; SOURCE LINE # 248
                                           ; SOURCE LINE # 249
                                           ; SOURCE LINE # 250
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0046
                                           ; SOURCE LINE # 251
                                           ; SOURCE LINE # 252
                                           ; SOURCE LINE # 253
                                           ; SOURCE LINE # 254
002F         ?C0047:
                                           ; SOURCE LINE # 256
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 257
0035 900000      E     MOV     DPTR,#ECINDDR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 28  

0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 258
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 259
0040 900000      E     MOV     DPTR,#ECINDDR
0043 74AB              MOV     A,#0ABH
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 260
0046 E4                CLR     A
0047 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 261
0048 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 262
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 264
004A 900000      E     MOV     DPTR,#SPIIndex
004D F0                MOVX    @DPTR,A
004E         ?C0049:
                                           ; SOURCE LINE # 265
                                           ; SOURCE LINE # 266
004E 900000      E     MOV     DPTR,#ECINDDR
0051 E0                MOVX    A,@DPTR
0052 FF                MOV     R7,A
0053 900000      E     MOV     DPTR,#SPIIndex
0056 E0                MOVX    A,@DPTR
0057 2400        E     ADD     A,#LOW SPIIDBuf
0059 F582              MOV     DPL,A
005B E4                CLR     A
005C 3400        E     ADDC    A,#HIGH SPIIDBuf
005E F583              MOV     DPH,A
0060 EF                MOV     A,R7
0061 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 267
0062 900000      E     MOV     DPTR,#SPIIndex
0065 E0                MOVX    A,@DPTR
0066 04                INC     A
0067 F0                MOVX    @DPTR,A
0068 E0                MOVX    A,@DPTR
0069 B404E2            CJNE    A,#04H,?C0049
006C         ?C0050:
                                           ; SOURCE LINE # 268
006C 900000      E     MOV     DPTR,#SPIIDBuf
006F E0                MOVX    A,@DPTR
0070 900000      E     MOV     DPTR,#SPIID
0073 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 270
0074 900000      E     MOV     DPTR,#ECINDAR1
0077 74FE              MOV     A,#0FEH
0079 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 271
007A 900000      E     MOV     DPTR,#ECINDDR
007D 04                INC     A
007E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 272
007F 900000      E     MOV     DPTR,#ECINDAR1
0082 74FD              MOV     A,#0FDH
0084 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 273
0085 900000      E     MOV     DPTR,#ECINDDR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 29  

0088 7405              MOV     A,#05H
008A F0                MOVX    @DPTR,A
008B         ?C0052:
                                           ; SOURCE LINE # 275
                                           ; SOURCE LINE # 276
                                           ; SOURCE LINE # 277
008B 900000      E     MOV     DPTR,#ECINDDR
008E E0                MOVX    A,@DPTR
008F 20E0F9            JB      ACC.0,?C0052
                                           ; SOURCE LINE # 278
                                           ; SOURCE LINE # 279
                                           ; SOURCE LINE # 280
                                           ; SOURCE LINE # 281
0092         ?C0053:
                                           ; SOURCE LINE # 282
0092 E4                CLR     A
0093 900000      E     MOV     DPTR,#ECINDAR3
0096 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 283
0097 900000      E     MOV     DPTR,#ECINDAR2
009A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 284
009B 22                RET     
             ; FUNCTION SPI_Read_ID_CmdAB (END)

             ; FUNCTION SPI_Erase (BEGIN)
                                           ; SOURCE LINE # 289
                                           ; SOURCE LINE # 290
                                           ; SOURCE LINE # 291
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 293
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 295
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 296
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 297
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 298
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0056:
                                           ; SOURCE LINE # 299
                                           ; SOURCE LINE # 300
                                           ; SOURCE LINE # 301
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 30  

002C 5403              ANL     A,#03H
002E FF                MOV     R7,A
002F BF02F6            CJNE    R7,#02H,?C0056
                                           ; SOURCE LINE # 302
                                           ; SOURCE LINE # 303
                                           ; SOURCE LINE # 304
                                           ; SOURCE LINE # 305
0032         ?C0057:
                                           ; SOURCE LINE # 307
0032 900000      E     MOV     DPTR,#ECINDAR1
0035 74FE              MOV     A,#0FEH
0037 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 308
0038 900000      E     MOV     DPTR,#ECINDDR
003B 04                INC     A
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 309
003D 900000      E     MOV     DPTR,#ECINDAR1
0040 74FD              MOV     A,#0FDH
0042 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 310
0043 900000      E     MOV     DPTR,#SPIAEraseCmd
0046 E0                MOVX    A,@DPTR
0047 900000      E     MOV     DPTR,#ECINDDR
004A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 311
004B E4                CLR     A
004C 900000      E     MOV     DPTR,#SPIIndex
004F F0                MOVX    @DPTR,A
0050         ?C0059:
                                           ; SOURCE LINE # 312
                                           ; SOURCE LINE # 313
0050 900000      E     MOV     DPTR,#SPIIndex
0053 E0                MOVX    A,@DPTR
0054 2400        E     ADD     A,#LOW SPIAddrCycle
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH SPIAddrCycle
005B F583              MOV     DPH,A
005D E0                MOVX    A,@DPTR
005E 900000      E     MOV     DPTR,#ECINDDR
0061 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 314
0062 900000      E     MOV     DPTR,#SPIIndex
0065 E0                MOVX    A,@DPTR
0066 04                INC     A
0067 F0                MOVX    @DPTR,A
0068 E0                MOVX    A,@DPTR
0069 B403E4            CJNE    A,#03H,?C0059
006C         ?C0060:
                                           ; SOURCE LINE # 316
006C 900000      E     MOV     DPTR,#ECINDAR1
006F 74FE              MOV     A,#0FEH
0071 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 317
0072 900000      E     MOV     DPTR,#ECINDDR
0075 04                INC     A
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 319
0077 900000      E     MOV     DPTR,#ECINDAR1
007A 74FD              MOV     A,#0FDH
007C F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 31  

                                           ; SOURCE LINE # 320
007D 900000      E     MOV     DPTR,#ECINDDR
0080 7405              MOV     A,#05H
0082 F0                MOVX    @DPTR,A
0083         ?C0062:
                                           ; SOURCE LINE # 322
                                           ; SOURCE LINE # 323
                                           ; SOURCE LINE # 324
0083 900000      E     MOV     DPTR,#ECINDDR
0086 E0                MOVX    A,@DPTR
0087 20E0F9            JB      ACC.0,?C0062
                                           ; SOURCE LINE # 325
                                           ; SOURCE LINE # 326
                                           ; SOURCE LINE # 327
                                           ; SOURCE LINE # 328
008A         ?C0063:
                                           ; SOURCE LINE # 329
008A E4                CLR     A
008B 900000      E     MOV     DPTR,#ECINDAR3
008E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 330
008F 900000      E     MOV     DPTR,#ECINDAR2
0092 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 331
0093 22                RET     
             ; FUNCTION SPI_Erase (END)

             ; FUNCTION SPI_Write_Enable (BEGIN)
                                           ; SOURCE LINE # 336
                                           ; SOURCE LINE # 337
                                           ; SOURCE LINE # 338
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 339
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 340
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 342
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 343
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 344
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 345
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0066:
                                           ; SOURCE LINE # 346
                                           ; SOURCE LINE # 347
                                           ; SOURCE LINE # 348
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 32  

0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0066
                                           ; SOURCE LINE # 349
                                           ; SOURCE LINE # 350
                                           ; SOURCE LINE # 351
                                           ; SOURCE LINE # 352
002F         ?C0067:
                                           ; SOURCE LINE # 354
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 355
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 356
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 357
0040 900000      E     MOV     DPTR,#ECINDDR
0043 7406              MOV     A,#06H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 359
0046 900000      E     MOV     DPTR,#SPIID
0049 E0                MOVX    A,@DPTR
004A B4BF17            CJNE    A,#0BFH,?C0069
                                           ; SOURCE LINE # 360
                                           ; SOURCE LINE # 361
004D 900000      E     MOV     DPTR,#ECINDAR1
0050 74FE              MOV     A,#0FEH
0052 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 362
0053 900000      E     MOV     DPTR,#ECINDDR
0056 04                INC     A
0057 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 363
0058 900000      E     MOV     DPTR,#ECINDAR1
005B 74FD              MOV     A,#0FDH
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 364
005E 900000      E     MOV     DPTR,#ECINDDR
0061 7450              MOV     A,#050H
0063 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
0064         ?C0069:
                                           ; SOURCE LINE # 367
0064 900000      E     MOV     DPTR,#ECINDAR1
0067 74FE              MOV     A,#0FEH
0069 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 368
006A 900000      E     MOV     DPTR,#ECINDDR
006D 04                INC     A
006E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 369
006F 900000      E     MOV     DPTR,#ECINDAR1
0072 74FD              MOV     A,#0FDH
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 370
0075 900000      E     MOV     DPTR,#ECINDDR
0078 7405              MOV     A,#05H
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 33  

007A F0                MOVX    @DPTR,A
007B         ?C0070:
                                           ; SOURCE LINE # 371
                                           ; SOURCE LINE # 372
                                           ; SOURCE LINE # 373
007B 900000      E     MOV     DPTR,#ECINDDR
007E E0                MOVX    A,@DPTR
007F 5403              ANL     A,#03H
0081 FF                MOV     R7,A
0082 BF02F6            CJNE    R7,#02H,?C0070
                                           ; SOURCE LINE # 374
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 376
                                           ; SOURCE LINE # 377
0085         ?C0071:
                                           ; SOURCE LINE # 379
0085 E4                CLR     A
0086 900000      E     MOV     DPTR,#ECINDAR3
0089 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 380
008A 900000      E     MOV     DPTR,#ECINDAR2
008D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 381
008E 22                RET     
             ; FUNCTION SPI_Write_Enable (END)

             ; FUNCTION SPI_Write_Disable (BEGIN)
                                           ; SOURCE LINE # 386
                                           ; SOURCE LINE # 387
                                           ; SOURCE LINE # 388
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 389
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 390
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 392
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 393
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 394
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 395
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0074:
                                           ; SOURCE LINE # 396
                                           ; SOURCE LINE # 397
                                           ; SOURCE LINE # 398
0028 900000      E     MOV     DPTR,#ECINDDR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 34  

002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0074
                                           ; SOURCE LINE # 399
                                           ; SOURCE LINE # 400
                                           ; SOURCE LINE # 401
                                           ; SOURCE LINE # 402
002F         ?C0075:
                                           ; SOURCE LINE # 404
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 405
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 406
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 407
0040 900000      E     MOV     DPTR,#ECINDDR
0043 7404              MOV     A,#04H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 409
0046 900000      E     MOV     DPTR,#ECINDAR1
0049 74FE              MOV     A,#0FEH
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 410
004C 900000      E     MOV     DPTR,#ECINDDR
004F 04                INC     A
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 411
0051 900000      E     MOV     DPTR,#ECINDAR1
0054 74FD              MOV     A,#0FDH
0056 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 412
0057 900000      E     MOV     DPTR,#ECINDDR
005A 7405              MOV     A,#05H
005C F0                MOVX    @DPTR,A
005D         ?C0077:
                                           ; SOURCE LINE # 413
                                           ; SOURCE LINE # 414
                                           ; SOURCE LINE # 415
005D 900000      E     MOV     DPTR,#ECINDDR
0060 E0                MOVX    A,@DPTR
0061 5403              ANL     A,#03H
0063 70F8              JNZ     ?C0077
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 417
                                           ; SOURCE LINE # 418
                                           ; SOURCE LINE # 419
0065         ?C0078:
                                           ; SOURCE LINE # 421
0065 E4                CLR     A
0066 900000      E     MOV     DPTR,#ECINDAR3
0069 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 422
006A 900000      E     MOV     DPTR,#ECINDAR2
006D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 423
006E 22                RET     
             ; FUNCTION SPI_Write_Disable (END)
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 35  


             ; FUNCTION Other_SPI_Write_256Bytes (BEGIN)
                                           ; SOURCE LINE # 428
                                           ; SOURCE LINE # 429
                                           ; SOURCE LINE # 430
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 431
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 432
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 434
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 435
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 436
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 437
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0081:
                                           ; SOURCE LINE # 438
                                           ; SOURCE LINE # 439
                                           ; SOURCE LINE # 440
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0081
                                           ; SOURCE LINE # 441
                                           ; SOURCE LINE # 442
                                           ; SOURCE LINE # 443
                                           ; SOURCE LINE # 444
002F         ?C0082:
                                           ; SOURCE LINE # 446
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 447
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 448
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 449
0040 900000      E     MOV     DPTR,#ECINDDR
0043 7402              MOV     A,#02H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 451
0046 900000      E     MOV     DPTR,#SPIAddrCycle
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 36  

0049 E0                MOVX    A,@DPTR
004A 900000      E     MOV     DPTR,#ECINDDR
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 452
004E 900000      E     MOV     DPTR,#SPIAddrCycle+01H
0051 E0                MOVX    A,@DPTR
0052 900000      E     MOV     DPTR,#ECINDDR
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 453
0056 900000      E     MOV     DPTR,#SPIAddrCycle+02H
0059 E0                MOVX    A,@DPTR
005A 900000      E     MOV     DPTR,#ECINDDR
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 455
005E E4                CLR     A
005F 900000      E     MOV     DPTR,#SPIIndex
0062 F0                MOVX    @DPTR,A
0063         ?C0086:
                                           ; SOURCE LINE # 457
                                           ; SOURCE LINE # 458
0063 900000      E     MOV     DPTR,#SPIDataPointer
0066 E0                MOVX    A,@DPTR
0067 FE                MOV     R6,A
0068 A3                INC     DPTR
0069 E0                MOVX    A,@DPTR
006A F582              MOV     DPL,A
006C 8E83              MOV     DPH,R6
006E E0                MOVX    A,@DPTR
006F 900000      E     MOV     DPTR,#ECINDDR
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 459
0073 900000      E     MOV     DPTR,#SPIIndex
0076 E0                MOVX    A,@DPTR
0077 04                INC     A
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 460
0079 90009C            MOV     DPTR,#09CH
007C E0                MOVX    A,@DPTR
007D 04                INC     A
007E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 461
007F 900000      E     MOV     DPTR,#SPIIndex
0082 E0                MOVX    A,@DPTR
0083 70DE              JNZ     ?C0086
                                           ; SOURCE LINE # 463
0085 900000      E     MOV     DPTR,#ECINDAR1
0088 74FE              MOV     A,#0FEH
008A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 464
008B 900000      E     MOV     DPTR,#ECINDDR
008E 04                INC     A
008F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 465
0090 900000      E     MOV     DPTR,#ECINDAR1
0093 74FD              MOV     A,#0FDH
0095 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 466
0096 900000      E     MOV     DPTR,#ECINDDR
0099 7405              MOV     A,#05H
009B F0                MOVX    @DPTR,A
009C         ?C0087:
                                           ; SOURCE LINE # 467
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 37  

                                           ; SOURCE LINE # 468
                                           ; SOURCE LINE # 469
009C 900000      E     MOV     DPTR,#ECINDDR
009F E0                MOVX    A,@DPTR
00A0 20E0F9            JB      ACC.0,?C0087
                                           ; SOURCE LINE # 470
                                           ; SOURCE LINE # 471
                                           ; SOURCE LINE # 472
                                           ; SOURCE LINE # 473
00A3         ?C0088:
                                           ; SOURCE LINE # 475
00A3 E4                CLR     A
00A4 900000      E     MOV     DPTR,#ECINDAR3
00A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 476
00A8 900000      E     MOV     DPTR,#ECINDAR2
00AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 477
00AC 22                RET     
             ; FUNCTION Other_SPI_Write_256Bytes (END)

             ; FUNCTION SST_SPI_Write_256Bytes (BEGIN)
                                           ; SOURCE LINE # 482
                                           ; SOURCE LINE # 483
                                           ; SOURCE LINE # 484
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 485
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 486
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 488
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 489
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 490
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 491
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0091:
                                           ; SOURCE LINE # 492
                                           ; SOURCE LINE # 493
                                           ; SOURCE LINE # 494
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0091
                                           ; SOURCE LINE # 495
                                           ; SOURCE LINE # 496
                                           ; SOURCE LINE # 497
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 38  

                                           ; SOURCE LINE # 498
002F         ?C0092:
                                           ; SOURCE LINE # 500
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 501
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 502
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 503
0040 900000      E     MOV     DPTR,#ECINDDR
0043 74AD              MOV     A,#0ADH
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 505
0046 900000      E     MOV     DPTR,#SPIAddrCycle
0049 E0                MOVX    A,@DPTR
004A 900000      E     MOV     DPTR,#ECINDDR
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 506
004E 900000      E     MOV     DPTR,#SPIAddrCycle+01H
0051 E0                MOVX    A,@DPTR
0052 900000      E     MOV     DPTR,#ECINDDR
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 507
0056 900000      E     MOV     DPTR,#SPIAddrCycle+02H
0059 E0                MOVX    A,@DPTR
005A 900000      E     MOV     DPTR,#ECINDDR
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 509
005E E4                CLR     A
005F 900000      E     MOV     DPTR,#SPIIndex
0062 F0                MOVX    @DPTR,A
0063         ?C0096:
                                           ; SOURCE LINE # 511
                                           ; SOURCE LINE # 512
0063 900000      E     MOV     DPTR,#SPIDataPointer
0066 E0                MOVX    A,@DPTR
0067 FE                MOV     R6,A
0068 A3                INC     DPTR
0069 E0                MOVX    A,@DPTR
006A F582              MOV     DPL,A
006C 8E83              MOV     DPH,R6
006E E0                MOVX    A,@DPTR
006F 900000      E     MOV     DPTR,#ECINDDR
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 513
0073 900000      E     MOV     DPTR,#SPIIndex
0076 E0                MOVX    A,@DPTR
0077 04                INC     A
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 514
0079 90009C            MOV     DPTR,#09CH
007C E0                MOVX    A,@DPTR
007D 04                INC     A
007E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 516
007F 900000      E     MOV     DPTR,#SPIIndex
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 39  

0082 E0                MOVX    A,@DPTR
0083 20E03B            JB      ACC.0,?C0094
                                           ; SOURCE LINE # 517
                                           ; SOURCE LINE # 518
0086 900000      E     MOV     DPTR,#ECINDAR1
0089 74FE              MOV     A,#0FEH
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 519
008C 900000      E     MOV     DPTR,#ECINDDR
008F 04                INC     A
0090 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 520
0091 900000      E     MOV     DPTR,#ECINDAR1
0094 74FD              MOV     A,#0FDH
0096 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 521
0097 900000      E     MOV     DPTR,#ECINDDR
009A 7405              MOV     A,#05H
009C F0                MOVX    @DPTR,A
009D         ?C0098:
                                           ; SOURCE LINE # 522
                                           ; SOURCE LINE # 523
                                           ; SOURCE LINE # 524
009D 900000      E     MOV     DPTR,#ECINDDR
00A0 E0                MOVX    A,@DPTR
00A1 20E0F9            JB      ACC.0,?C0098
                                           ; SOURCE LINE # 525
                                           ; SOURCE LINE # 526
                                           ; SOURCE LINE # 527
                                           ; SOURCE LINE # 528
00A4         ?C0099:
                                           ; SOURCE LINE # 530
00A4 900000      E     MOV     DPTR,#SPIIndex
00A7 E0                MOVX    A,@DPTR
00A8 6017              JZ      ?C0094
                                           ; SOURCE LINE # 531
                                           ; SOURCE LINE # 532
00AA 900000      E     MOV     DPTR,#ECINDAR1
00AD 74FE              MOV     A,#0FEH
00AF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 533
00B0 900000      E     MOV     DPTR,#ECINDDR
00B3 04                INC     A
00B4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 534
00B5 900000      E     MOV     DPTR,#ECINDAR1
00B8 74FD              MOV     A,#0FDH
00BA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 535
00BB 900000      E     MOV     DPTR,#ECINDDR
00BE 74AD              MOV     A,#0ADH
00C0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 536
                                           ; SOURCE LINE # 537
                                           ; SOURCE LINE # 538
00C1         ?C0094:
00C1 900000      E     MOV     DPTR,#SPIIndex
00C4 E0                MOVX    A,@DPTR
00C5 709C              JNZ     ?C0096
                                           ; SOURCE LINE # 540
00C7 900000      E     MOV     DPTR,#ECINDAR1
00CA 74FE              MOV     A,#0FEH
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 40  

00CC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 541
00CD 900000      E     MOV     DPTR,#ECINDDR
00D0 04                INC     A
00D1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 542
00D2 900000      E     MOV     DPTR,#ECINDAR1
00D5 74FD              MOV     A,#0FDH
00D7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 543
00D8 900000      E     MOV     DPTR,#ECINDDR
00DB 7404              MOV     A,#04H
00DD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 545
00DE E4                CLR     A
00DF 900000      E     MOV     DPTR,#WNCKR
00E2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 546
00E3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 547
00E4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 548
00E5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 550
00E6 900000      E     MOV     DPTR,#ECINDAR3
00E9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 551
00EA 900000      E     MOV     DPTR,#ECINDAR2
00ED F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 552
00EE 22                RET     
             ; FUNCTION SST_SPI_Write_256Bytes (END)

             ; FUNCTION Old_SST_SPI_Write_256Bytes (BEGIN)
                                           ; SOURCE LINE # 557
                                           ; SOURCE LINE # 558
                                           ; SOURCE LINE # 559
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 560
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 561
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 563
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 564
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 565
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 566
0022 900000      E     MOV     DPTR,#ECINDDR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 41  

0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0103:
                                           ; SOURCE LINE # 567
                                           ; SOURCE LINE # 568
                                           ; SOURCE LINE # 569
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0103
                                           ; SOURCE LINE # 570
                                           ; SOURCE LINE # 571
                                           ; SOURCE LINE # 572
                                           ; SOURCE LINE # 573
002F         ?C0104:
                                           ; SOURCE LINE # 575
002F 900000      E     MOV     DPTR,#ECINDAR1
0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 576
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 577
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 578
0040 900000      E     MOV     DPTR,#ECINDDR
0043 74AF              MOV     A,#0AFH
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 580
0046 900000      E     MOV     DPTR,#SPIAddrCycle
0049 E0                MOVX    A,@DPTR
004A 900000      E     MOV     DPTR,#ECINDDR
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 581
004E 900000      E     MOV     DPTR,#SPIAddrCycle+01H
0051 E0                MOVX    A,@DPTR
0052 900000      E     MOV     DPTR,#ECINDDR
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 582
0056 900000      E     MOV     DPTR,#SPIAddrCycle+02H
0059 E0                MOVX    A,@DPTR
005A 900000      E     MOV     DPTR,#ECINDDR
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 584
005E E4                CLR     A
005F 900000      E     MOV     DPTR,#SPIIndex
0062 F0                MOVX    @DPTR,A
0063         ?C0108:
                                           ; SOURCE LINE # 586
                                           ; SOURCE LINE # 587
0063 900000      E     MOV     DPTR,#SPIDataPointer
0066 E0                MOVX    A,@DPTR
0067 FE                MOV     R6,A
0068 A3                INC     DPTR
0069 E0                MOVX    A,@DPTR
006A F582              MOV     DPL,A
006C 8E83              MOV     DPH,R6
006E E0                MOVX    A,@DPTR
006F 900000      E     MOV     DPTR,#ECINDDR
0072 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 42  

                                           ; SOURCE LINE # 588
0073 900000      E     MOV     DPTR,#SPIIndex
0076 E0                MOVX    A,@DPTR
0077 04                INC     A
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 589
0079 90009C            MOV     DPTR,#09CH
007C E0                MOVX    A,@DPTR
007D 04                INC     A
007E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 591
007F 900000      E     MOV     DPTR,#ECINDAR1
0082 74FE              MOV     A,#0FEH
0084 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 592
0085 900000      E     MOV     DPTR,#ECINDDR
0088 04                INC     A
0089 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 593
008A 900000      E     MOV     DPTR,#ECINDAR1
008D 74FD              MOV     A,#0FDH
008F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 594
0090 900000      E     MOV     DPTR,#ECINDDR
0093 7405              MOV     A,#05H
0095 F0                MOVX    @DPTR,A
0096         ?C0109:
                                           ; SOURCE LINE # 595
                                           ; SOURCE LINE # 596
                                           ; SOURCE LINE # 597
0096 900000      E     MOV     DPTR,#ECINDDR
0099 E0                MOVX    A,@DPTR
009A 20E0F9            JB      ACC.0,?C0109
                                           ; SOURCE LINE # 598
                                           ; SOURCE LINE # 599
                                           ; SOURCE LINE # 600
                                           ; SOURCE LINE # 601
009D         ?C0110:
                                           ; SOURCE LINE # 603
009D 900000      E     MOV     DPTR,#SPIIndex
00A0 E0                MOVX    A,@DPTR
00A1 6017              JZ      ?C0106
                                           ; SOURCE LINE # 604
                                           ; SOURCE LINE # 605
00A3 900000      E     MOV     DPTR,#ECINDAR1
00A6 74FE              MOV     A,#0FEH
00A8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 606
00A9 900000      E     MOV     DPTR,#ECINDDR
00AC 04                INC     A
00AD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 607
00AE 900000      E     MOV     DPTR,#ECINDAR1
00B1 74FD              MOV     A,#0FDH
00B3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 608
00B4 900000      E     MOV     DPTR,#ECINDDR
00B7 74AF              MOV     A,#0AFH
00B9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 609
                                           ; SOURCE LINE # 610
00BA         ?C0106:
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 43  

00BA 900000      E     MOV     DPTR,#SPIIndex
00BD E0                MOVX    A,@DPTR
00BE 70A3              JNZ     ?C0108
                                           ; SOURCE LINE # 612
00C0 900000      E     MOV     DPTR,#ECINDAR1
00C3 74FE              MOV     A,#0FEH
00C5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 613
00C6 900000      E     MOV     DPTR,#ECINDDR
00C9 04                INC     A
00CA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 614
00CB 900000      E     MOV     DPTR,#ECINDAR1
00CE 74FD              MOV     A,#0FDH
00D0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 615
00D1 900000      E     MOV     DPTR,#ECINDDR
00D4 7404              MOV     A,#04H
00D6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 618
00D7 E4                CLR     A
00D8 900000      E     MOV     DPTR,#WNCKR
00DB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 619
00DC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 620
00DD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 621
00DE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 634
00DF 900000      E     MOV     DPTR,#ECINDAR3
00E2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 635
00E3 900000      E     MOV     DPTR,#ECINDAR2
00E6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 636
00E7 22                RET     
             ; FUNCTION Old_SST_SPI_Write_256Bytes (END)

             ; FUNCTION SPI_Write_256Bytes (BEGIN)
                                           ; SOURCE LINE # 646
                                           ; SOURCE LINE # 647
                                           ; SOURCE LINE # 648
0000 900000      E     MOV     DPTR,#SPIID
0003 E0                MOVX    A,@DPTR
0004 B4BF13            CJNE    A,#0BFH,?C0114
                                           ; SOURCE LINE # 649
                                           ; SOURCE LINE # 650
0007 900000      E     MOV     DPTR,#SSTDeviceID
000A E0                MOVX    A,@DPTR
000B B40106            CJNE    A,#01H,?C0115
                                           ; SOURCE LINE # 651
                                           ; SOURCE LINE # 652
000E 7E00        R     MOV     R6,#HIGH Old_SST_SPI_Write_256Bytes
0010 7F00        R     MOV     R7,#LOW Old_SST_SPI_Write_256Bytes
                                           ; SOURCE LINE # 653
0012 800A              SJMP    ?C0151
0014         ?C0115:
                                           ; SOURCE LINE # 655
                                           ; SOURCE LINE # 656
0014 7E00        R     MOV     R6,#HIGH SST_SPI_Write_256Bytes
0016 7F00        R     MOV     R7,#LOW SST_SPI_Write_256Bytes
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 44  

0018         ?C0150:
                                           ; SOURCE LINE # 657
                                           ; SOURCE LINE # 658
0018 8004              SJMP    ?C0151
001A         ?C0114:
                                           ; SOURCE LINE # 660
                                           ; SOURCE LINE # 661
001A 7E00        R     MOV     R6,#HIGH Other_SPI_Write_256Bytes
001C 7F00        R     MOV     R7,#LOW Other_SPI_Write_256Bytes
001E         ?C0151:
001E 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 662
                                           ; SOURCE LINE # 663
0021         ?C0118:
0021 22                RET     
             ; FUNCTION SPI_Write_256Bytes (END)

             ; FUNCTION SPI_Read_256Bytes (BEGIN)
                                           ; SOURCE LINE # 671
                                           ; SOURCE LINE # 672
                                           ; SOURCE LINE # 673
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 740F              MOV     A,#0FH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 674
0006 900000      E     MOV     DPTR,#ECINDAR2
0009 74FF              MOV     A,#0FFH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 675
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ECINDAR0
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 677
0011 900000      E     MOV     DPTR,#ECINDAR1
0014 74FE              MOV     A,#0FEH
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 678
0017 900000      E     MOV     DPTR,#ECINDDR
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 679
001C 900000      E     MOV     DPTR,#ECINDAR1
001F 74FD              MOV     A,#0FDH
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 680
0022 900000      E     MOV     DPTR,#ECINDDR
0025 7405              MOV     A,#05H
0027 F0                MOVX    @DPTR,A
0028         ?C0119:
                                           ; SOURCE LINE # 681
                                           ; SOURCE LINE # 682
                                           ; SOURCE LINE # 683
0028 900000      E     MOV     DPTR,#ECINDDR
002B E0                MOVX    A,@DPTR
002C 20E0F9            JB      ACC.0,?C0119
                                           ; SOURCE LINE # 684
                                           ; SOURCE LINE # 685
                                           ; SOURCE LINE # 686
                                           ; SOURCE LINE # 687
002F         ?C0120:
                                           ; SOURCE LINE # 689
002F 900000      E     MOV     DPTR,#ECINDAR1
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 45  

0032 74FE              MOV     A,#0FEH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 690
0035 900000      E     MOV     DPTR,#ECINDDR
0038 04                INC     A
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 691
003A 900000      E     MOV     DPTR,#ECINDAR1
003D 74FD              MOV     A,#0FDH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 692
0040 900000      E     MOV     DPTR,#ECINDDR
0043 740B              MOV     A,#0BH
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 694
0046 900000      E     MOV     DPTR,#SPIAddrCycle
0049 E0                MOVX    A,@DPTR
004A 900000      E     MOV     DPTR,#ECINDDR
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 695
004E 900000      E     MOV     DPTR,#SPIAddrCycle+01H
0051 E0                MOVX    A,@DPTR
0052 900000      E     MOV     DPTR,#ECINDDR
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 696
0056 900000      E     MOV     DPTR,#SPIAddrCycle+02H
0059 E0                MOVX    A,@DPTR
005A 900000      E     MOV     DPTR,#ECINDDR
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 697
005E E4                CLR     A
005F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 699
0060 900000      E     MOV     DPTR,#SPIIndex
0063 F0                MOVX    @DPTR,A
0064         ?C0124:
                                           ; SOURCE LINE # 701
                                           ; SOURCE LINE # 702
0064 900000      E     MOV     DPTR,#ECINDDR
0067 E0                MOVX    A,@DPTR
0068 FF                MOV     R7,A
0069 900000      E     MOV     DPTR,#SPIDataPointer
006C E0                MOVX    A,@DPTR
006D FC                MOV     R4,A
006E A3                INC     DPTR
006F E0                MOVX    A,@DPTR
0070 F582              MOV     DPL,A
0072 8C83              MOV     DPH,R4
0074 EF                MOV     A,R7
0075 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 703
0076 900000      E     MOV     DPTR,#SPIIndex
0079 E0                MOVX    A,@DPTR
007A 04                INC     A
007B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 704
007C 90009C            MOV     DPTR,#09CH
007F E0                MOVX    A,@DPTR
0080 04                INC     A
0081 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 705
0082 900000      E     MOV     DPTR,#SPIIndex
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 46  

0085 E0                MOVX    A,@DPTR
0086 70DC              JNZ     ?C0124
                                           ; SOURCE LINE # 707
0088 900000      E     MOV     DPTR,#ECINDAR1
008B 74FE              MOV     A,#0FEH
008D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 708
008E 900000      E     MOV     DPTR,#ECINDDR
0091 04                INC     A
0092 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 709
0093 900000      E     MOV     DPTR,#ECINDAR1
0096 74FD              MOV     A,#0FDH
0098 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 710
0099 900000      E     MOV     DPTR,#ECINDDR
009C 7405              MOV     A,#05H
009E F0                MOVX    @DPTR,A
009F         ?C0125:
                                           ; SOURCE LINE # 711
                                           ; SOURCE LINE # 712
                                           ; SOURCE LINE # 713
009F 900000      E     MOV     DPTR,#ECINDDR
00A2 E0                MOVX    A,@DPTR
00A3 20E0F9            JB      ACC.0,?C0125
                                           ; SOURCE LINE # 714
                                           ; SOURCE LINE # 715
                                           ; SOURCE LINE # 716
                                           ; SOURCE LINE # 717
00A6         ?C0126:
                                           ; SOURCE LINE # 719
00A6 E4                CLR     A
00A7 900000      E     MOV     DPTR,#ECINDAR3
00AA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 720
00AB 900000      E     MOV     DPTR,#ECINDAR2
00AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 721
00AF 22                RET     
             ; FUNCTION SPI_Read_256Bytes (END)

             ; FUNCTION _LoadSPIFucnToRam (BEGIN)
                                           ; SOURCE LINE # 731
;---- Variable 'funcpoint' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 732
                                           ; SOURCE LINE # 733
0000 7800        E     MOV     R0,#LOW Tmp_XPntr
0002 7606              MOV     @R0,#06H
0004 08                INC     R0
0005 7600              MOV     @R0,#00H
                                           ; SOURCE LINE # 734
0007 7800        E     MOV     R0,#LOW Tmp_code_pointer
0009 EE                MOV     A,R6
000A F6                MOV     @R0,A
000B 08                INC     R0
000C EF                MOV     A,R7
000D F6                MOV     @R0,A
                                           ; SOURCE LINE # 736
000E E4                CLR     A
000F F500        E     MOV     _R2,A
0011         ?C0131:
                                           ; SOURCE LINE # 738
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 47  

                                           ; SOURCE LINE # 739
0011 7800        E     MOV     R0,#LOW Tmp_code_pointer
0013 E6                MOV     A,@R0
0014 FE                MOV     R6,A
0015 08                INC     R0
0016 E6                MOV     A,@R0
0017 F582              MOV     DPL,A
0019 8E83              MOV     DPH,R6
001B E4                CLR     A
001C 93                MOVC    A,@A+DPTR
001D FF                MOV     R7,A
001E 7800        E     MOV     R0,#LOW Tmp_XPntr
0020 E6                MOV     A,@R0
0021 FC                MOV     R4,A
0022 08                INC     R0
0023 E6                MOV     A,@R0
0024 F582              MOV     DPL,A
0026 8C83              MOV     DPH,R4
0028 EF                MOV     A,R7
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 740
002A 06                INC     @R0
002B E6                MOV     A,@R0
002C 18                DEC     R0
002D 7001              JNZ     ?C0147
002F 06                INC     @R0
0030         ?C0147:
                                           ; SOURCE LINE # 741
0030 7800        E     MOV     R0,#LOW Tmp_code_pointer+01H
0032 06                INC     @R0
0033 E6                MOV     A,@R0
0034 18                DEC     R0
0035 7001              JNZ     ?C0148
0037 06                INC     @R0
0038         ?C0148:
                                           ; SOURCE LINE # 742
0038 0500        E     INC     _R2
                                           ; SOURCE LINE # 743
003A E500        E     MOV     A,_R2
003C 70D3              JNZ     ?C0131
                                           ; SOURCE LINE # 745
003E 22                RET     
             ; FUNCTION _LoadSPIFucnToRam (END)

             ; FUNCTION ITE_Flash_Utility (BEGIN)
                                           ; SOURCE LINE # 751
                                           ; SOURCE LINE # 752
                                           ; SOURCE LINE # 753
0000 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 754
0003 7E00        R     MOV     R6,#HIGH FlashECCode
0005 7F00        R     MOV     R7,#LOW FlashECCode
0007 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 755
000A 900000      E     MOV     DPTR,#FBCFG
000D E0                MOVX    A,@DPTR
000E 4480              ORL     A,#080H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 756
0011 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 757
0014 22                RET     
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 48  

             ; FUNCTION ITE_Flash_Utility (END)

             ; FUNCTION _Do_SPI_Write_Status (BEGIN)
                                           ; SOURCE LINE # 767
;---- Variable 'statusvalue' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 768
                                           ; SOURCE LINE # 769
0000 900000      E     MOV     DPTR,#SPIWriteStatus
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 771
0005 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 772
0008 7E00        R     MOV     R6,#HIGH SPI_Write_Status
000A 7F00        R     MOV     R7,#LOW SPI_Write_Status
000C 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 773
000F 900000      E     MOV     DPTR,#FBCFG
0012 E0                MOVX    A,@DPTR
0013 4480              ORL     A,#080H
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 774
0016 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 775
0019 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 776
001C 900000      E     MOV     DPTR,#FBCFG
001F E0                MOVX    A,@DPTR
0020 547F              ANL     A,#07FH
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 777
0023 22                RET     
             ; FUNCTION _Do_SPI_Write_Status (END)

             ; FUNCTION Do_SPI_Read_Status (BEGIN)
                                           ; SOURCE LINE # 784
                                           ; SOURCE LINE # 785
                                           ; SOURCE LINE # 786
0000 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 787
0003 7E00        R     MOV     R6,#HIGH SPI_Read_Status
0005 7F00        R     MOV     R7,#LOW SPI_Read_Status
0007 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 788
000A 900000      E     MOV     DPTR,#FBCFG
000D E0                MOVX    A,@DPTR
000E 4480              ORL     A,#080H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 789
0011 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 790
0014 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 791
0017 900000      E     MOV     DPTR,#FBCFG
001A E0                MOVX    A,@DPTR
001B 547F              ANL     A,#07FH
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 792
001E 22                RET     
             ; FUNCTION Do_SPI_Read_Status (END)

             ; FUNCTION Do_SPI_Read_ID (BEGIN)
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 49  

                                           ; SOURCE LINE # 799
                                           ; SOURCE LINE # 800
                                           ; SOURCE LINE # 801
0000 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 802
0003 7E00        R     MOV     R6,#HIGH SPI_Read_ID
0005 7F00        R     MOV     R7,#LOW SPI_Read_ID
0007 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 803
000A 900000      E     MOV     DPTR,#FBCFG
000D E0                MOVX    A,@DPTR
000E 4480              ORL     A,#080H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 804
0011 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 805
0014 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 806
0017 900000      E     MOV     DPTR,#FBCFG
001A E0                MOVX    A,@DPTR
001B 547F              ANL     A,#07FH
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 807
001E 22                RET     
             ; FUNCTION Do_SPI_Read_ID (END)

             ; FUNCTION Do_SPI_Read_ID_CmdAB (BEGIN)
                                           ; SOURCE LINE # 814
                                           ; SOURCE LINE # 815
                                           ; SOURCE LINE # 816
0000 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 817
0003 7E00        R     MOV     R6,#HIGH SPI_Read_ID_CmdAB
0005 7F00        R     MOV     R7,#LOW SPI_Read_ID_CmdAB
0007 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 818
000A 900000      E     MOV     DPTR,#FBCFG
000D E0                MOVX    A,@DPTR
000E 4480              ORL     A,#080H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 819
0011 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 820
0014 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 821
0017 900000      E     MOV     DPTR,#FBCFG
001A E0                MOVX    A,@DPTR
001B 547F              ANL     A,#07FH
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 822
001E 22                RET     
             ; FUNCTION Do_SPI_Read_ID_CmdAB (END)

             ; FUNCTION _Do_SPI_Erase (BEGIN)
                                           ; SOURCE LINE # 833
;---- Variable 'EraseCmd' assigned to Register 'R7' ----
;---- Variable 'Addr1' assigned to Register 'R3' ----
;---- Variable 'Addr2' assigned to Register 'R5' ----
                                           ; SOURCE LINE # 834
                                           ; SOURCE LINE # 835
0000 900000      E     MOV     DPTR,#SPIAEraseCmd
0003 EF                MOV     A,R7
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 50  

0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 836
0005 900000      E     MOV     DPTR,#SPIAddrCycle
0008 ED                MOV     A,R5
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 837
000A A3                INC     DPTR
000B EB                MOV     A,R3
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 838
000D 900000      R     MOV     DPTR,#Addr0
0010 E0                MOVX    A,@DPTR
0011 900000      E     MOV     DPTR,#SPIAddrCycle+02H
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 840
0015 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 841
0018 7E00        R     MOV     R6,#HIGH SPI_Erase
001A 7F00        R     MOV     R7,#LOW SPI_Erase
001C 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 842
001F 900000      E     MOV     DPTR,#FBCFG
0022 E0                MOVX    A,@DPTR
0023 4480              ORL     A,#080H
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 843
0026 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 844
0029 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 845
002C 900000      E     MOV     DPTR,#FBCFG
002F E0                MOVX    A,@DPTR
0030 547F              ANL     A,#07FH
0032 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 846
0033 22                RET     
             ; FUNCTION _Do_SPI_Erase (END)

             ; FUNCTION _Do_SPI_Write_256Bytes (BEGIN)
                                           ; SOURCE LINE # 856
;---- Variable 'DataPointer' assigned to Register 'R6/R7' ----
;---- Variable 'Addr1' assigned to Register 'R3' ----
;---- Variable 'Addr2' assigned to Register 'R5' ----
                                           ; SOURCE LINE # 857
                                           ; SOURCE LINE # 858
0000 900000      E     MOV     DPTR,#SPIDataPointer
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 859
0008 900000      E     MOV     DPTR,#SPIAddrCycle
000B ED                MOV     A,R5
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 860
000D A3                INC     DPTR
000E EB                MOV     A,R3
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 861
0010 900000      R     MOV     DPTR,#Addr0
0013 E0                MOVX    A,@DPTR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 51  

0014 900000      E     MOV     DPTR,#SPIAddrCycle+02H
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 863
0018 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 864
001B 120000      R     LCALL   SPI_Write_256Bytes
                                           ; SOURCE LINE # 865
001E 900000      E     MOV     DPTR,#FBCFG
0021 E0                MOVX    A,@DPTR
0022 4480              ORL     A,#080H
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 866
0025 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 867
0028 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 868
002B 900000      E     MOV     DPTR,#FBCFG
002E E0                MOVX    A,@DPTR
002F 547F              ANL     A,#07FH
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 869
0032 22                RET     
             ; FUNCTION _Do_SPI_Write_256Bytes (END)

             ; FUNCTION _Do_SPI_Read_256Bytes (BEGIN)
                                           ; SOURCE LINE # 879
;---- Variable 'DataPointer' assigned to Register 'R6/R7' ----
;---- Variable 'Addr1' assigned to Register 'R3' ----
;---- Variable 'Addr2' assigned to Register 'R5' ----
                                           ; SOURCE LINE # 880
                                           ; SOURCE LINE # 881
0000 900000      E     MOV     DPTR,#SPIDataPointer
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 882
0008 900000      E     MOV     DPTR,#SPIAddrCycle
000B ED                MOV     A,R5
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 883
000D A3                INC     DPTR
000E EB                MOV     A,R3
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 884
0010 900000      R     MOV     DPTR,#Addr0
0013 E0                MOVX    A,@DPTR
0014 900000      E     MOV     DPTR,#SPIAddrCycle+02H
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 886
0018 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 887
001B 7E00        R     MOV     R6,#HIGH SPI_Read_256Bytes
001D 7F00        R     MOV     R7,#LOW SPI_Read_256Bytes
001F 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 888
0022 900000      E     MOV     DPTR,#FBCFG
0025 E0                MOVX    A,@DPTR
0026 4480              ORL     A,#080H
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 889
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 52  

0029 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 890
002C 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 891
002F 900000      E     MOV     DPTR,#FBCFG
0032 E0                MOVX    A,@DPTR
0033 547F              ANL     A,#07FH
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 892
0036 22                RET     
             ; FUNCTION _Do_SPI_Read_256Bytes (END)

             ; FUNCTION Do_SPI_Write_Enable (BEGIN)
                                           ; SOURCE LINE # 900
                                           ; SOURCE LINE # 901
                                           ; SOURCE LINE # 902
0000 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 903
0003 7E00        R     MOV     R6,#HIGH SPI_Write_Enable
0005 7F00        R     MOV     R7,#LOW SPI_Write_Enable
0007 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 904
000A 900000      E     MOV     DPTR,#FBCFG
000D E0                MOVX    A,@DPTR
000E 4480              ORL     A,#080H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 905
0011 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 906
0014 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 907
0017 900000      E     MOV     DPTR,#FBCFG
001A E0                MOVX    A,@DPTR
001B 547F              ANL     A,#07FH
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 908
001E 22                RET     
             ; FUNCTION Do_SPI_Write_Enable (END)

             ; FUNCTION Do_SPI_Write_Disable (BEGIN)
                                           ; SOURCE LINE # 914
                                           ; SOURCE LINE # 915
                                           ; SOURCE LINE # 916
0000 120000      E     LCALL   DisableAllInterrupt
                                           ; SOURCE LINE # 917
0003 7E00        R     MOV     R6,#HIGH SPI_Write_Disable
0005 7F00        R     MOV     R7,#LOW SPI_Write_Disable
0007 120000      R     LCALL   _LoadSPIFucnToRam
                                           ; SOURCE LINE # 918
000A 900000      E     MOV     DPTR,#FBCFG
000D E0                MOVX    A,@DPTR
000E 4480              ORL     A,#080H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 919
0011 120000      R     LCALL   FuncAt_0xFE00
                                           ; SOURCE LINE # 920
0014 120000      E     LCALL   EnableAllInterrupt
                                           ; SOURCE LINE # 921
0017 900000      E     MOV     DPTR,#FBCFG
001A E0                MOVX    A,@DPTR
001B 547F              ANL     A,#07FH
001D F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 53  

                                           ; SOURCE LINE # 922
001E 22                RET     
             ; FUNCTION Do_SPI_Write_Disable (END)

             ; FUNCTION _OEM_Read_SPI_256Bytes (BEGIN)
                                           ; SOURCE LINE # 936
;---- Variable 'Addr2' assigned to Register 'R7' ----
;---- Variable 'Addr0' assigned to Register 'R6' ----
0000 CE                XCH     A,R6
0001 EB                MOV     A,R3
0002 CE                XCH     A,R6
;---- Variable 'Addr1' assigned to Register 'R4' ----
0003 CC                XCH     A,R4
0004 ED                MOV     A,R5
0005 CC                XCH     A,R4
                                           ; SOURCE LINE # 937
                                           ; SOURCE LINE # 938
0006 CD                XCH     A,R5
0007 EF                MOV     A,R7
0008 CD                XCH     A,R5
0009 CF                XCH     A,R7
000A EC                MOV     A,R4
000B CF                XCH     A,R7
000C CB                XCH     A,R3
000D EF                MOV     A,R7
000E CB                XCH     A,R3
000F 900000      R     MOV     DPTR,#?_Do_SPI_Read_256Bytes?BYTE+04H
0012 EE                MOV     A,R6
0013 F0                MOVX    @DPTR,A
0014 7F00              MOV     R7,#00H
0016 7E08              MOV     R6,#08H
0018 120000      R     LCALL   _Do_SPI_Read_256Bytes
                                           ; SOURCE LINE # 940
001B 22                RET     
             ; FUNCTION _OEM_Read_SPI_256Bytes (END)

             ; FUNCTION _OEM_Write_SPI_256Bytes (BEGIN)
                                           ; SOURCE LINE # 946
0000 900000      R     MOV     DPTR,#Addr2
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 EB                MOV     A,R3
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 947
                                           ; SOURCE LINE # 948
000B E4                CLR     A
000C FF                MOV     R7,A
000D 120000      R     LCALL   _Do_SPI_Write_Status
                                           ; SOURCE LINE # 949
0010 120000      R     LCALL   Do_SPI_Write_Enable
                                           ; SOURCE LINE # 950
0013 900000      R     MOV     DPTR,#Addr2
0016 E0                MOVX    A,@DPTR
0017 FD                MOV     R5,A
0018 A3                INC     DPTR
0019 E0                MOVX    A,@DPTR
001A FB                MOV     R3,A
001B A3                INC     DPTR
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 54  

001C E0                MOVX    A,@DPTR
001D 900000      R     MOV     DPTR,#?_Do_SPI_Erase?BYTE+03H
0020 F0                MOVX    @DPTR,A
0021 7F20              MOV     R7,#020H
0023 120000      R     LCALL   _Do_SPI_Erase
                                           ; SOURCE LINE # 951
0026 120000      R     LCALL   Do_SPI_Write_Enable
                                           ; SOURCE LINE # 952
0029 900000      R     MOV     DPTR,#Addr2
002C E0                MOVX    A,@DPTR
002D FD                MOV     R5,A
002E A3                INC     DPTR
002F E0                MOVX    A,@DPTR
0030 FB                MOV     R3,A
0031 A3                INC     DPTR
0032 E0                MOVX    A,@DPTR
0033 900000      R     MOV     DPTR,#?_Do_SPI_Write_256Bytes?BYTE+04H
0036 F0                MOVX    @DPTR,A
0037 7F00              MOV     R7,#00H
0039 7E08              MOV     R6,#08H
003B 120000      R     LCALL   _Do_SPI_Write_256Bytes
                                           ; SOURCE LINE # 953
003E 120000      R     LCALL   Do_SPI_Write_Disable
                                           ; SOURCE LINE # 954
0041 22                RET     
             ; FUNCTION _OEM_Write_SPI_256Bytes (END)

             ; FUNCTION _CacheDma (BEGIN)
                                           ; SOURCE LINE # 971
0000 900000      R     MOV     DPTR,#addr
0003 EC                MOV     A,R4
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
;---- Variable 'sramnum' assigned to Register 'R3' ----
0008 CB                XCH     A,R3
0009 EF                MOV     A,R7
000A CB                XCH     A,R3
                                           ; SOURCE LINE # 972
                                           ; SOURCE LINE # 973
000B EB                MOV     A,R3
000C 75F006            MOV     B,#06H
000F A4                MUL     AB
0010 2400        R     ADD     A,#LOW asDMAScratchSRAM
0012 F582              MOV     DPL,A
0014 E4                CLR     A
0015 3400        R     ADDC    A,#HIGH asDMAScratchSRAM
0017 F583              MOV     DPH,A
0019 E4                CLR     A
001A 93                MOVC    A,@A+DPTR
001B FE                MOV     R6,A
001C 7401              MOV     A,#01H
001E 93                MOVC    A,@A+DPTR
001F F582              MOV     DPL,A
0021 8E83              MOV     DPH,R6
0023 7480              MOV     A,#080H
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 976
0026 900000      R     MOV     DPTR,#addr
0029 E0                MOVX    A,@DPTR
002A FF                MOV     R7,A
C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 55  

002B EB                MOV     A,R3
002C 75F006            MOV     B,#06H
002F A4                MUL     AB
0030 2400        R     ADD     A,#LOW asDMAScratchSRAM+02H
0032 F582              MOV     DPL,A
0034 E4                CLR     A
0035 3400        R     ADDC    A,#HIGH asDMAScratchSRAM+02H
0037 F583              MOV     DPH,A
0039 E4                CLR     A
003A 93                MOVC    A,@A+DPTR
003B FC                MOV     R4,A
003C 7401              MOV     A,#01H
003E 93                MOVC    A,@A+DPTR
003F F582              MOV     DPL,A
0041 8C83              MOV     DPH,R4
0043 EF                MOV     A,R7
0044 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 980
0045 900000      R     MOV     DPTR,#addr
0048 E0                MOVX    A,@DPTR
0049 A3                INC     DPTR
004A E0                MOVX    A,@DPTR
004B FF                MOV     R7,A
004C EB                MOV     A,R3
004D 75F006            MOV     B,#06H
0050 A4                MUL     AB
0051 2400        R     ADD     A,#LOW asDMAScratchSRAM+04H
0053 F582              MOV     DPL,A
0055 E4                CLR     A
0056 3400        R     ADDC    A,#HIGH asDMAScratchSRAM+04H
0058 F583              MOV     DPH,A
005A E4                CLR     A
005B 93                MOVC    A,@A+DPTR
005C FC                MOV     R4,A
005D 7401              MOV     A,#01H
005F 93                MOVC    A,@A+DPTR
0060 F582              MOV     DPL,A
0062 8C83              MOV     DPH,R4
0064 EF                MOV     A,R7
0065 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 984
0066 EB                MOV     A,R3
0067 75F006            MOV     B,#06H
006A A4                MUL     AB
006B 2400        R     ADD     A,#LOW asDMAScratchSRAM
006D F582              MOV     DPL,A
006F E4                CLR     A
0070 3400        R     ADDC    A,#HIGH asDMAScratchSRAM
0072 F583              MOV     DPH,A
0074 E4                CLR     A
0075 93                MOVC    A,@A+DPTR
0076 FE                MOV     R6,A
0077 7401              MOV     A,#01H
0079 93                MOVC    A,@A+DPTR
007A F582              MOV     DPL,A
007C 8E83              MOV     DPH,R6
007E E4                CLR     A
007F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 986
0080 22                RET     
             ; FUNCTION _CacheDma (END)

C51 COMPILER V7.50   CORE_FLASH                                                            09/20/2020 10:56:18 PAGE 56  

             ; FUNCTION _EC_Indirect_Read_SPI (BEGIN)
                                           ; SOURCE LINE # 991
;---- Variable 'Addr2' assigned to Register 'R7' ----
;---- Variable 'Addr0' assigned to Register 'R3' ----
;---- Variable 'Addr1' assigned to Register 'R5' ----
                                           ; SOURCE LINE # 992
                                           ; SOURCE LINE # 994
0000 900000      E     MOV     DPTR,#ECINDAR3
0003 E0                MOVX    A,@DPTR
0004 FE                MOV     R6,A
;---- Variable 'itemp' assigned to Register 'R6' ----
                                           ; SOURCE LINE # 995
0005 E4                CLR     A
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 996
0007 900000      E     MOV     DPTR,#ECINDAR2
000A EF                MOV     A,R7
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 997
000C 900000      E     MOV     DPTR,#ECINDAR1
000F ED                MOV     A,R5
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 998
0011 900000      E     MOV     DPTR,#ECINDAR0
0014 EB                MOV     A,R3
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 999
0016 900000      E     MOV     DPTR,#ECINDDR
0019 E0                MOVX    A,@DPTR
001A FF                MOV     R7,A
;---- Variable 'SPI_Data' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1000
001B 900000      E     MOV     DPTR,#ECINDAR3
001E EE                MOV     A,R6
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1002
                                           ; SOURCE LINE # 1003
0020         ?C0146:
0020 22                RET     
             ; FUNCTION _EC_Indirect_Read_SPI (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2674    ----
   CONSTANT SIZE    =     24    ----
   XDATA SIZE       =   ----      19
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
