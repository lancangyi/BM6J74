C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE CORE_INIT
OBJECT MODULE PLACED IN Core\Core_Init.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\c51.exe Core\Core_Init.c LA WL(1) CD OT(9,SIZE) NOAREGS OR INCDIR(.\Core\Include\;.
                    -\Oem\Include\)

line level    source

   1          
   2          #include "Core_Inc.h"
   3          #include "Oem_Inc.h"
   4          
   5          
   6          void Kernel_Initialization(void)
   7          {
   8   1      
   9   1      //      EA = 0;
  10   1      //    EA = 1;
  11   1      
  12   1              SPCTRL1 = 0x03;         // I2EC R/W Enable;
  13   1              SPCTRL2 = 0x27;         // Bit4 = 1, 8032 UART1 Enable; Bit 2-1 = 11b, SSPI Enable, Bit 5 = 1 because the LRESE
             -T# gating;
  14   1                                                      // Bit 0 = 1, Port I2EC Enable;
  15   1                                                      
  16   1              #if VCC_POWER_ON_TREATED
                      RSTS = 0x44;//set 2006h bit3 =0 for LDN change issue 
                      #else
  19   1              RSTS = 0x84;//set 2006h bit3 =0 for LDN change issue 
  20   1              #endif
  21   1      
  22   1              PI2ECH = 0x0B;   // I2EC Base address MLB
  23   1              PI2ECL = 0x00;   // I2EC Base address LSB
  24   1      
  25   1              Disable_DCache();       //Disable DCache
  26   1      
  27   1              vDelay1ms(100);
  28   1              Index_07H = 0x07;    //LDN=0x07
  29   1              Index_30H = 0x01;
  30   1              Index_E9H = 0x20;       // Disable BUS Selection
  31   1      
  32   1              Index_2CH = 0x8B;       // Disable SMBUS isolation
  33   1              
  34   1              Index_62H = 0x02;       // IO base assignment
  35   1              Index_63H = 0x00;
  36   1      
  37   1      
  38   1              SET_BIT(CFG_REG, 7);                            
  39   1              SET_BIT(PWM_STEP_FREQ_REG, 4);  //Initialize the Thermal Diode At the VSTBY Power
  40   1      
  41   1              Kernel_Code_Version = Read_SPI(0xFEFE);
  42   1              
  43   1      }
  44          
  45          
  46          void Init_ClearRam(void)
  47          {
  48   1      
  49   1              IIBYTE *IdataIndex;
  50   1              PORT_BYTE_PNTR byte_register_pntr;
  51   1              IdataIndex = 0x20;
  52   1              byte_register_pntr=0;
  53   1      
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 2   

  54   1              #if INIT_CLEAR_XRAM
  55   1              while(byte_register_pntr<0x1000)// Clear external ram (0x000~0xFFF)
  56   1              {
  57   2                  *byte_register_pntr=0;
  58   2                  byte_register_pntr ++;
  59   2              }
  60   1              #endif
  61   1      
  62   1              #if INIT_CLEAR_IRAM
  63   1              while(IdataIndex<0xD0)                  // Clear internal ram (0x20~0xCF)
  64   1              {
  65   2                          *IdataIndex=0;
  66   2                          IdataIndex ++;
  67   2              }
  68   1              #endif
  69   1                      
  70   1      }
  71          
  72          
  73          
  74          void Enable_SMLink1_Mapping_To_TMPIN2(void)
  75          {
  76   1              Index_07H = 0x07 ;      // Secret move for enabling the SMLink1
  77   1              Index_2AH = 0x02 ;      // Secret move for enabling the SMLink1
  78   1      
  79   1              PCH_AMDTSI_HOST_STS             = 0x00 ;
  80   1              PCH_AMDTSI_TARGET_ADDR  = 0x97 ;
  81   1              PCH_AMDTSI_HOST_CMD             = 0x40 ;
  82   1              PCH_AMDTSI_HOST_CTRL            = 0xC3 ;
  83   1      }
  84          
  85          //-----------------------------------------------------------------------------
  86          // Reset_Initialization - Initialize the registers and data variables.
  87          //
  88          //-----------------------------------------------------------------------------
  89          void Reset_Initialization(void)
  90          {
  91   1      
  92   1              Kernel_Initialization();
  93   1      
  94   1              AWFCS_EN = 0x01;
  95   1              //==================================
  96   1              //Init GPIO
  97   1              //==================================
  98   1              Initialize_GPIO_Pin_State();
  99   1              //==================================
 100   1              InitADC();
 101   1      
 102   1              //==================================
 103   1              //Set K8 function (for AMD platform)
 104   1              //==================================
 105   1              #if K8_Function_Enable
                      Enable_K8_Function();
                      #endif
 108   1              
 109   1              LED_S0_Status = 0;
 110   1              
 111   1              Init_BRAM() ;
 112   1              
 113   1              Init_Timers();
 114   1      
 115   1      }
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 3   

 116          
 117          void Init_Timers(void)
 118          {
 119   1              TF0 = TR0 = 0;          // Stop timer0 and clear interrupt
 120   1              
 121   1              #if SUPPORT_Hook_1ms_Timer
 122   1              TL0 = T_Timer_1ms;              // Reload timer
 123   1              TH0 = T_Timer_1ms>>8;       // 1ms
 124   1              #else
                      TL0 = T_Timer_5ms;              // Reload timer
                      TH0 = T_Timer_5ms>>8;       // 5ms
                      #endif
 128   1              
 129   1              TMOD  = 0x11;                   // Timer0 and timer1 are 16 bits timer
 130   1              TR0 = 1;                // Start timer0 running
 131   1              ET0 = 1;                                // Enable timer0 interrupt
 132   1                                                              
 133   1              TF1 = TR1 = 0;          // Stop timer 1 and clear interrupt
 134   1              //TL1 = T_Timer_2ms;            // Reload timer
 135   1              //TH1 = T_Timer_2ms>>8;         // 2ms
 136   1              TR1 = 0;                // Stop timer1 
 137   1              //ET1 = 1;                              // Enable timer1 interrupt
 138   1      }
 139          
 140          
 141          //==============================================================================
 142          // Name: vSetTimeout
 143          // Description: When TF1 is 1 mean timeout occur
 144          //==============================================================================
 145          void Set_T1_Timeout(WORD wTimeCnt)
 146          {
 147   1              ET1 = 0;                                        // Disable timer1 interrupt
 148   1              TR1 = 0;                                        // Stop timer1
 149   1              _nop_();
 150   1              _nop_();
 151   1              _nop_();
 152   1              _nop_();
 153   1              TH1 = wTimeCnt>>8;                      // Set timer1 counter MSB
 154   1              TL1 = wTimeCnt;                         // Set timer1 counter LSB
 155   1              TF1 = 0;                                        // Clear overflow flag
 156   1              TR1 = 1;                                        // Enable timer1
 157   1      }
 158          
 159          
 160          
 161          void Load_Timer_A(void)
 162          {                                               // Assume the 8051 clock source is Ring Oscillator 
 163   1              TL0 = T_Timer_5ms;              // Reload timer
 164   1              TH0 = T_Timer_5ms>>8;       // 5ms
 165   1              TF0 = 0;                                // Clear overflow flag
 166   1      }
 167          
 168          
 169          void Load_Timer_A_1ms(void)
 170          {                                               // Assume the 8051 clock source is Ring Oscillator 
 171   1              TL0 = T_Timer_1ms;              // Reload timer
 172   1              TH0 = T_Timer_1ms>>8;       // 1ms
 173   1              TF0 = 0;                                // Clear overflow flag
 174   1      }
 175          
 176          
 177          
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 4   

 178          void InitSMBus(void)
 179          {
 180   1      
 181   1              //SMBUS initi
 182   1              Index_07H = 0x19;       // LDN 19h for SMBus configurations
 183   1              Index_70H = 0x00;
 184   1              Index_30H = 0x00;       // Disable Host side
 185   1              
 186   1              //SMBUS Disable
 187   1              #if Disable_All_SMBUS_Channel
                              Index_30H = 0x00;       // Activation
                              Index_70H = 0x00;
                              Index_76H = 0x00;       // SMBus disable
                              return;
                      #endif
 193   1      
 194   1      
 195   1              //---------------------------------------------
 196   1              #if Enable_SMBUS_ChannelA       //SMBUS0
 197   1              SET_BIT(Index_76H, 1);
 198   1              HOCTL2_A = 0x01;        //Enable SMBUS (SMHEN)
 199   1              #else
                      CLR_BIT(Index_76H, 1);
                      #endif
 202   1      
 203   1              #if Enable_SMBUS_ChannelB
                      HOCTL2_B = 0x01;        //Enable SMBUS (SMHEN)
                      #endif
 206   1      
 207   1      
 208   1              #if Enable_SMBUS_ChannelC       //SMBUS2
                      SET_BIT(Index_76H, 0);  // SMBus enable
                      HOCTL2_C = 0x01;        //Enable SMBUS (SMHEN)
                      #else
 212   1              CLR_BIT(Index_76H, 0);
 213   1              #endif
 214   1              //---------------------------------------------
 215   1      
 216   1              Core_Init_SMBus();
 217   1              #if SMBusServiceCenterFunc
                              CheckSMBusTableSize();
                      #endif
 220   1      
 221   1      
 222   1              switch(SMBus_Freq)//400,100,50,20,13,10
 223   1              {
 224   2                      case 400:
 225   2                              SMBUS_4P7USREG = 0x03;
 226   2                              SMBUS_4P0USREG = 0x02;
 227   2                              SMBUS_300NSREG = 0x03;  
 228   2                              SMBUS_250NSREG = 0x03;  
 229   2                              SMBUS_25MSREG    = 0x19;        
 230   2                              SMBUS_45P3USLREG = 0xC9;        
 231   2                              SMBUS_45P3USHREG = 0x01;
 232   2                              SMBUS_4P7A4P0H = 0x00;
 233   2                              break;
 234   2                              
 235   2                      case 100:
 236   2                              //set SMBUS Frequency = 100KHz
 237   2                              SMBUS_4P7USREG = 0x15;
 238   2                              SMBUS_4P0USREG = 0x25;
 239   2                              SMBUS_300NSREG = 0x03;  
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 5   

 240   2                              SMBUS_250NSREG = 0x15;  
 241   2                              SMBUS_25MSREG    = 0x19;        
 242   2                              SMBUS_45P3USLREG = 0xB8;        
 243   2                              SMBUS_45P3USHREG = 0x01;
 244   2                              SMBUS_4P7A4P0H = 0x00;
 245   2                              break;
 246   2      
 247   2                      case 50:
 248   2                              //set SMBUS Frequency = 50KHz
 249   2                              SMBUS_4P7USREG = 0x2C;
 250   2                              SMBUS_4P0USREG = 0x53;
 251   2                              SMBUS_300NSREG = 0x03;  
 252   2                              SMBUS_250NSREG = 0x2C;  
 253   2                              SMBUS_25MSREG    = 0x19;        
 254   2                              SMBUS_45P3USLREG = 0xA0;        
 255   2                              SMBUS_45P3USHREG = 0x01;
 256   2                              SMBUS_4P7A4P0H = 0x00;  
 257   2                              break;
 258   2              
 259   2                      case 20:
 260   2                              //set SMBUS Frequency = 20KHz
 261   2                              SMBUS_4P7USREG = 0x71;
 262   2                              SMBUS_4P0USREG = 0xDD;
 263   2                              SMBUS_300NSREG = 0x03;  
 264   2                              SMBUS_250NSREG = 0x71;  
 265   2                              SMBUS_25MSREG    = 0x19;        
 266   2                              SMBUS_45P3USLREG = 0x5B;        
 267   2                              SMBUS_45P3USHREG = 0x01;
 268   2                              SMBUS_4P7A4P0H = 0x00;  
 269   2                              break;
 270   2                              
 271   2                      case 13:
 272   2                              //set SMBUS Frequency = 13KHz
 273   2                              SMBUS_4P7USREG = 0xAF;
 274   2                              SMBUS_4P0USREG = 0x5A;
 275   2                              SMBUS_300NSREG = 0x03;  
 276   2                              SMBUS_250NSREG = 0xAF;  
 277   2                              SMBUS_25MSREG    = 0x19;        
 278   2                              SMBUS_45P3USLREG = 0x1D;        
 279   2                              SMBUS_45P3USHREG = 0x01;
 280   2                              SMBUS_4P7A4P0H = 0x02;
 281   2                              break;
 282   2                              
 283   2                      case 10:
 284   2                              //set SMBUS Frequency = 10KHz
 285   2                              SMBUS_4P7USREG = 0xE4;
 286   2                              SMBUS_4P0USREG = 0xC5;
 287   2                              SMBUS_300NSREG = 0x03;  
 288   2                              SMBUS_250NSREG = 0xE4;  
 289   2                              SMBUS_25MSREG    = 0x19;        
 290   2                              SMBUS_45P3USLREG = 0xE8;        
 291   2                              SMBUS_45P3USHREG = 0x00;
 292   2                              SMBUS_4P7A4P0H = 0x02;  
 293   2                              break;
 294   2              
 295   2                      default:
 296   2                              break;
 297   2              }
 298   1      
 299   1      }
 300          
 301          
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 6   

 302          void InitDAC(void)
 303          {
 304   1              DACPDREG = 0x00;        //Enable DAC0~4
 305   1              
 306   1              DACDAT0_MSB = 0x30;
 307   1              DACDAT0_LSB = 0xFF;
 308   1              
 309   1              DACDAT1_MSB = 0x02;
 310   1              DACDAT1_LSB = 0x00;
 311   1              
 312   1              DACDAT2_MSB = 0x00;
 313   1              DACDAT2_LSB = 0x00;
 314   1              
 315   1              DACDAT3_MSB = 0x00;
 316   1              DACDAT3_LSB = 0xFF;
 317   1              
 318   1              DACDAT4_MSB = 0x02;
 319   1              DACDAT4_LSB = 0xFF;
 320   1      }
 321          
 322          void InitADC(void)
 323          {
 324   1              Index_07H = 0x04;
 325   1              Index_30H = 0x01;
 326   1              ADC_VCEn = 0x3F;
 327   1              ADC_channel_enable = 0xFF;
 328   1              CFG_REG |= 0x01;
 329   1      }
 330          
 331          
 332          void InitFanCTL(void)
 333          {
 334   1              FAN_MAIN_CTL = 0x77;//enable TAC1-3
 335   1              FAN_CTL = 0xC0;//Set Active high
 336   1      
 337   1              FAN_CTL1= 0x00; //Use Fan1
 338   1              PWM_FAN_CTL1= 0x50;
 339   1      
 340   1              FAN_CTL2 = 0x00;        //Use Fan2
 341   1              PWM_FAN_CTL2 = 0x50;
 342   1      }
 343          
 344          
 345          //======================================================
 346          // Name:        vDelay1ms
 347          // Input:               bMS
 348          // Output:      bMS delay
 349          // Return:
 350          //
 351          // Module Author: Ethan Lo, ITE Tech. Inc.
 352          // Application Implementation: B.J. Chen, ITE. Tech. Inc.
 353          //======================================================
 354          void vDelay1ms(WORD bMS)
 355          {
 356   1          bit SaveEA;
 357   1          BYTE i;
 358   1      
 359   1          SaveEA = EA;    // save Interrupt
 360   1          EA = 0;         // clear global interrupt
 361   1      
 362   1          while(bMS)      // delay 1ms
 363   1          {
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 7   

 364   2              for( i=0; i<66; i++ )
 365   2                  WNCKR = 0;  // 15.26 us
 366   2              bMS--;
 367   2          }
 368   1          EA = SaveEA;        // restore Interrupt
 369   1      }//End vDelayXms
 370          
 371          void LED_SEG(BYTE ucByte) 
 372          {
 373   1      
 374   1          GPIO_7x = ucByte;   
 375   1              
 376   1      }//END LED_SEG
 377          
 378          /*
 379          Hardware Monitor 
 380          
 381                          INDEX13 bit 2~0=0
 382                          INDEX14 = C0h
 383          
 384          
 385          COM 2 
 386                  LDN07  
 387                          INDEX 25 bit 7=1
 388                        INDEX 26 bit7~4=1 : F0h
 389                        INDEX 26 bit1~0=1 : 03h
 390                        INDEX C0 bit7=1
 391                        INDEX C1 bit7~4=1 : F0h
 392                        INDEX C1 bit1~0=1 : 03h
 393                        INDEX C8 bit7=1
 394                        INDEX C9 bit7~4=1 : F0h
 395                        INDEX C9 bit1~0=1 : 03h
 396          
 397           Hardware Monitor EC 
 398          
 399                          index 0A bit 5~4= 0
 400          */
 401          
 402          
 403          void InitEnterDeepSleep(void)
 404          {
 405   1              //Disable Timer0/Timer1 Interrupt
 406   1              ET0 = 0;
 407   1              ET1 = 0;
 408   1      
 409   1              //WKO[34], INT52        GP34 WU34
 410   1              IER6 = 0x10;
 411   1              WUENR3 = 0x10;
 412   1              WUESR3 = 0xFF;
 413   1      }
 414          
 415          void InitWakeFromDeepSleep(void)
 416          {
 417   1              //WKO[34], INT52        GP34 WU34
 418   1              WUENR3 = 0x00;
 419   1              IER6 = 0x00;
 420   1      
 421   1              DeepSleepCountDown = 2;
 422   1      
 423   1              //Enable Timer0 Interrupt
 424   1              ET0 = 1;
 425   1              //ET1 = 0;
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 8   

 426   1      }
 427          
 428          
 429          void Init_UART2(void)
 430          {
 431   1              if( (SysPowState == _SYSTEM_S5) || (SysPowState == _PowrUp_S5) )
 432   1              {
 433   2                      //Index_23H = 0x01;     //For S5 only
 434   2                      SET_BIT(Index_23H, 0);  //For S5 only
 435   2              }
 436   1              
 437   1              
 438   1              //Set LDN 02 for UART2
 439   1              Index_07H = 0x02;
 440   1              Index_30H = 0x01;
 441   1              SET_BIT(Index_F0H, 3);  //UART2 Pin not gated
 442   1              
 443   1              Index_07H = 0x07;
 444   1              CLR_BIT(Index_26H,7);   //Sin2
 445   1              CLR_BIT(Index_26H,6);   //Sout2
 446   1              CLR_BIT(Index_C1H,7);
 447   1              CLR_BIT(Index_C1H,6);
 448   1              UART2_LCR = 0x80;                               // DLAB = 1
 449   1              UART2_DLM = 0x00;                               // Enable read/write Baud Rate
 450   1              //UART2_DLL = 0x01;                             // Set baud rate = 115200
 451   1              //UART2_DLL = 0x0C;                             // Set baud rate = 9600
 452   1              //UART2_DLL = 0x03;                             // Set baud rate = 38400
 453   1              UART2_DLL = 0x06;                               // Set baud rate = 19200
 454   1              
 455   1              UART2_LCR = 0x03;                               // DLAB = 0, Word length = 8 bit
 456   1              
 457   1              UART2_FCR |= 0x86;                              // Set Rx FIFO to 8 byte and reset FIFO
 458   1              SetFlag(UART2_FCR, BIT0);               // Enable FIFO
 459   1              SetFlag(UART2_IER, BIT0);               // Enable received data available interrupt
 460   1              SetFlag(UART2_MCR, BIT3);               // Enable OUT2
 461   1              SET_MASK(IER4, Int_UART2) ;     //UART2 int
 462   1              ISR4 = Int_UART2;
 463   1      
 464   1      
 465   1      }
 466          
 467          
 468          
 469          void Init_UART1(void)
 470          {
 471   1      
 472   1              //UART1 test
 473   1              if( (SysPowState == _SYSTEM_S5) || (SysPowState == _PowrUp_S5) )
 474   1              {
 475   2                      //Index_23H = 0x01;     //For S5 only
 476   2                      SET_BIT(Index_23H, 0);  //For S5 only
 477   2              }
 478   1                      
 479   1              //Set LDN 01 for UART1
 480   1              Index_07H = 0x01;
 481   1              Index_30H = 0x01;
 482   1              SET_BIT(Index_F0H, 3);  //UART1 Pin not gated
 483   1              
 484   1              UART1_LCR = 0x80;                               // DLAB = 1
 485   1              UART1_DLM = 0x00;                               // Enable read/write Baud Rate
 486   1              //UART2_DLL = 0x01;                             // Set baud rate = 115200
 487   1              //UART2_DLL = 0x0C;                             // Set baud rate = 9600
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 9   

 488   1              UART1_DLL = 0x03;                               // Set baud rate = 38400
 489   1              
 490   1              UART1_LCR = 0x03;                               // DLAB = 0, Word length = 8 bit
 491   1      
 492   1              UART1_FCR |= 0x86;                              // Set Rx FIFO to 8 byte and reset FIFO
 493   1              SetFlag(UART1_FCR, BIT0);               // Enable FIFO
 494   1              SetFlag(UART1_IER, BIT0);               // Enable received data available interrupt
 495   1              SetFlag(UART1_MCR, BIT3);               // Enable OUT2
 496   1              SET_MASK(IER4, Int_UART1) ;     //UART1 int
 497   1              ISR4 = Int_UART1 ;
 498   1      
 499   1      
 500   1      }
 501          
 502          
 503          void Set_ExtTimer1(void)
 504          {
 505   1      
 506   1              SET_BIT(ETWCTRL, 0);    //Reset
 507   1              ETPSR = 0x00;   //Set Clock     
 508   1              
 509   1              //ETCNTLHR = 0x3E;
 510   1              //ETCNTLLR = 0x80;              //Start
 511   1              
 512   1              ETCNTLHR = 0x7D;
 513   1              ETCNTLLR = 0x00;
 514   1              
 515   1              ISR3 = BIT6;            //clear INT30 ISR
 516   1              IER3 |= BIT6;   //set  INT30 IER
 517   1              
 518   1      }
 519          
 520          
 521          BYTE Read_SPI(WORD address)
 522          {
 523   1              unsigned char code *pt_rom;
 524   1              unsigned char tmp;
 525   1              
 526   1              pt_rom = 0+address;
 527   1              tmp = *pt_rom;
 528   1      
 529   1              return tmp;
 530   1      }
 531          
 532          
 533          void Init_BRAM(void)
 534          {
 535   1      
 536   1          PORT_BYTE_PNTR byte_reg_pntr ;
 537   1      
 538   1          byte_reg_pntr=0x2200;
 539   1      
 540   1              if( (BRAM_CHECK0 == 70) && (BRAM_CHECK1 == 5) && (BRAM_CHECK2 == 2) )
 541   1              {
 542   2                      return; 
 543   2              }
 544   1              else
 545   1              {
 546   2                      while( byte_reg_pntr < (0x22C0) )
 547   2                      {   // Clear BRAM range (0x2200~0x22BF)
 548   3                              *byte_reg_pntr = 0x00;
 549   3                              byte_reg_pntr++; ;
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 10  

 550   3                      }
 551   2                      BRAM_CHECK0 = 70;
 552   2                      BRAM_CHECK1 = 5;
 553   2                      BRAM_CHECK2 = 2;
 554   2              }
 555   1      
 556   1              
 557   1      
 558   1      }
 559          
 560          //------------------------------------------------------------------------------
 561          // The function of enabling KBC Input Buffer Full (60 64 port)Interrupt 
 562          //------------------------------------------------------------------------------
 563          void EnableKBCIBFInt(void)
 564          {
 565   1              SET_MASK(IER3,Int_KBCIBF);
 566   1      }
 567          
 568          //------------------------------------------------------------------------------
 569          //Disable Dynamic Cache
 570          //------------------------------------------------------------------------------
 571          void Disable_DCache(void)
 572          {
 573   1              #if Disable_DCache_without_checking
 574   1      
 575   1              CACHDISR = 0x03;
 576   1              
 577   1              #else 
                      
                      //Disable DCache except IT8738
                      if( ECHIPID2 != 0x38 )
                      {
                              CACHDISR = 0x03;
                      }
                      #endif
 585   1      }
 586          
 587          
 588          //------------------------------------------------------------------------------
 589          //K8 function Enable
 590          //------------------------------------------------------------------------------
 591          void Enable_K8_Function(void)
 592          {
 593   1              LDN = 0x07;
 594   1              SET_MASK(Index_2DH, BIT0);
 595   1      }
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 11  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION Com0037 (BEGIN)
0000         L?0056:
0000         L?0057:
0000 900000      E     MOV     DPTR,#SMBUS_250NSREG
0003         L?0058:
0003 F0                MOVX    @DPTR,A
0004 900000      E     MOV     DPTR,#SMBUS_25MSREG
0007 7419              MOV     A,#019H
0009 F0                MOVX    @DPTR,A
000A 900000      E     MOV     DPTR,#SMBUS_45P3USLREG
000D 22                RET     
000E         L?0059:
000E 900000      E     MOV     DPTR,#SMBUS_4P0USREG
0011         L?0060:
0011 F0                MOVX    @DPTR,A
0012 900000      E     MOV     DPTR,#SMBUS_300NSREG
0015 7403              MOV     A,#03H
0017 F0                MOVX    @DPTR,A
0018 22                RET     
0019         L?0061:
0019 900000      E     MOV     DPTR,#Index_07H
001C F0                MOVX    @DPTR,A
001D 900000      E     MOV     DPTR,#Index_30H
0020 22                RET     
0021         L?0062:
0021 900000      E     MOV     DPTR,#SMBUS_4P7USREG
0024 F0                MOVX    @DPTR,A
0025 900000      E     MOV     DPTR,#SMBUS_4P0USREG
0028 22                RET     
             ; FUNCTION Com0037 (END)

             ; FUNCTION Kernel_Initialization (BEGIN)
                                           ; SOURCE LINE # 6
                                           ; SOURCE LINE # 7
                                           ; SOURCE LINE # 12
0000 900000      E     MOV     DPTR,#SPCTRL1
0003 7403              MOV     A,#03H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 13
0006 900000      E     MOV     DPTR,#SPCTRL2
0009 7427              MOV     A,#027H
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 19
000C 900000      E     MOV     DPTR,#RSTS
000F 7484              MOV     A,#084H
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 22
0012 900000      E     MOV     DPTR,#PI2ECH
0015 740B              MOV     A,#0BH
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 23
0018 E4                CLR     A
0019 900000      E     MOV     DPTR,#PI2ECL
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 25
001D 120000      R     LCALL   Disable_DCache
                                           ; SOURCE LINE # 27
0020 7F64              MOV     R7,#064H
0022 7E00              MOV     R6,#00H
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 12  

0024 120000      R     LCALL   _vDelay1ms
                                           ; SOURCE LINE # 28
0027 7407              MOV     A,#07H
                                           ; SOURCE LINE # 29
0029 120000      R     LCALL   L?0061
002C 7401              MOV     A,#01H
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 30
002F 900000      E     MOV     DPTR,#Index_E9H
0032 7420              MOV     A,#020H
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 32
0035 900000      E     MOV     DPTR,#Index_2CH
0038 748B              MOV     A,#08BH
003A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 34
003B 900000      E     MOV     DPTR,#Index_62H
003E 7402              MOV     A,#02H
0040 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 35
0041 E4                CLR     A
0042 900000      E     MOV     DPTR,#Index_63H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 38
0046 900000      E     MOV     DPTR,#CFG_REG
0049 E0                MOVX    A,@DPTR
004A 4480              ORL     A,#080H
004C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 39
004D 900000      E     MOV     DPTR,#PWM_STEP_FREQ_REG
0050 E0                MOVX    A,@DPTR
0051 4410              ORL     A,#010H
0053 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 41
0054 74FE              MOV     A,#0FEH
0056 FF                MOV     R7,A
0057 FE                MOV     R6,A
0058 120000      R     LCALL   _Read_SPI
005B 8F00        E     MOV     Kernel_Code_Version,R7
                                           ; SOURCE LINE # 43
005D 22                RET     
             ; FUNCTION Kernel_Initialization (END)

             ; FUNCTION Init_ClearRam (BEGIN)
                                           ; SOURCE LINE # 46
                                           ; SOURCE LINE # 47
                                           ; SOURCE LINE # 51
;---- Variable 'IdataIndex' assigned to Register 'R7' ----
0000 7F20              MOV     R7,#020H
                                           ; SOURCE LINE # 52
;---- Variable 'byte_register_pntr' assigned to Register 'DPTR' ----
0002 900000            MOV     DPTR,#00H
0005         ?C0002:
                                           ; SOURCE LINE # 55
0005 AC83              MOV     R4,DPH
0007 C3                CLR     C
0008 EC                MOV     A,R4
0009 9410              SUBB    A,#010H
000B 5005              JNC     ?C0004
                                           ; SOURCE LINE # 56
                                           ; SOURCE LINE # 57
000D E4                CLR     A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 13  

000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 58
000F A3                INC     DPTR
                                           ; SOURCE LINE # 59
0010 80F3              SJMP    ?C0002
0012         ?C0004:
                                           ; SOURCE LINE # 63
0012 EF                MOV     A,R7
0013 C3                CLR     C
0014 94D0              SUBB    A,#0D0H
0016 5008              JNC     ?C0006
                                           ; SOURCE LINE # 64
                                           ; SOURCE LINE # 65
0018 C8                XCH     A,R0
0019 EF                MOV     A,R7
001A C8                XCH     A,R0
001B E4                CLR     A
001C F6                MOV     @R0,A
                                           ; SOURCE LINE # 66
001D 0F                INC     R7
                                           ; SOURCE LINE # 67
001E 80F2              SJMP    ?C0004
                                           ; SOURCE LINE # 70
0020         ?C0006:
0020 22                RET     
             ; FUNCTION Init_ClearRam (END)

             ; FUNCTION Enable_SMLink1_Mapping_To_TMPIN2 (BEGIN)
                                           ; SOURCE LINE # 74
                                           ; SOURCE LINE # 75
                                           ; SOURCE LINE # 76
0000 900000      E     MOV     DPTR,#Index_07H
0003 7407              MOV     A,#07H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 77
0006 900000      E     MOV     DPTR,#Index_2AH
0009 7402              MOV     A,#02H
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 79
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#PCH_AMDTSI_HOST_STS
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 80
0011 900000      E     MOV     DPTR,#PCH_AMDTSI_TARGET_ADDR
0014 7497              MOV     A,#097H
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 81
0017 900000      E     MOV     DPTR,#PCH_AMDTSI_HOST_CMD
001A 7440              MOV     A,#040H
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 82
001D 900000      E     MOV     DPTR,#PCH_AMDTSI_HOST_CTRL
0020 74C3              MOV     A,#0C3H
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 83
0023 22                RET     
             ; FUNCTION Enable_SMLink1_Mapping_To_TMPIN2 (END)

             ; FUNCTION Reset_Initialization (BEGIN)
                                           ; SOURCE LINE # 89
                                           ; SOURCE LINE # 90
                                           ; SOURCE LINE # 92
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 14  

0000 120000      R     LCALL   Kernel_Initialization
                                           ; SOURCE LINE # 94
0003 900000      E     MOV     DPTR,#AWFCS_EN
0006 7401              MOV     A,#01H
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 98
0009 120000      E     LCALL   Initialize_GPIO_Pin_State
                                           ; SOURCE LINE # 100
000C 120000      R     LCALL   InitADC
                                           ; SOURCE LINE # 109
000F E4                CLR     A
0010 900000      E     MOV     DPTR,#LED_S0_Status
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 111
0014 120000      R     LCALL   Init_BRAM
                                           ; SOURCE LINE # 113
0017 020000      R     LJMP    Init_Timers
             ; FUNCTION Reset_Initialization (END)

             ; FUNCTION Init_Timers (BEGIN)
                                           ; SOURCE LINE # 117
                                           ; SOURCE LINE # 118
                                           ; SOURCE LINE # 119
0000 C28C              CLR     TR0
0002 C28D              CLR     TF0
                                           ; SOURCE LINE # 122
0004 E4                CLR     A
0005 F58A              MOV     TL0,A
                                           ; SOURCE LINE # 123
0007 758CFD            MOV     TH0,#0FDH
                                           ; SOURCE LINE # 129
000A 758911            MOV     TMOD,#011H
                                           ; SOURCE LINE # 130
000D D28C              SETB    TR0
                                           ; SOURCE LINE # 131
000F D2A9              SETB    ET0
                                           ; SOURCE LINE # 133
0011 C28E              CLR     TR1
0013 C28F              CLR     TF1
                                           ; SOURCE LINE # 136
0015 C28E              CLR     TR1
                                           ; SOURCE LINE # 138
0017 22                RET     
             ; FUNCTION Init_Timers (END)

             ; FUNCTION _Set_T1_Timeout (BEGIN)
                                           ; SOURCE LINE # 145
0000 900000      R     MOV     DPTR,#wTimeCnt
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 146
                                           ; SOURCE LINE # 147
0008 C2AB              CLR     ET1
                                           ; SOURCE LINE # 148
000A C28E              CLR     TR1
                                           ; SOURCE LINE # 149
000C 00                NOP     
                                           ; SOURCE LINE # 150
000D 00                NOP     
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 15  

                                           ; SOURCE LINE # 151
000E 00                NOP     
                                           ; SOURCE LINE # 152
000F 00                NOP     
                                           ; SOURCE LINE # 153
0010 900000      R     MOV     DPTR,#wTimeCnt
0013 E0                MOVX    A,@DPTR
0014 F58D              MOV     TH1,A
                                           ; SOURCE LINE # 154
0016 E0                MOVX    A,@DPTR
0017 A3                INC     DPTR
0018 E0                MOVX    A,@DPTR
0019 F58B              MOV     TL1,A
                                           ; SOURCE LINE # 155
001B C28F              CLR     TF1
                                           ; SOURCE LINE # 156
001D D28E              SETB    TR1
                                           ; SOURCE LINE # 157
001F 22                RET     
             ; FUNCTION _Set_T1_Timeout (END)

             ; FUNCTION Load_Timer_A (BEGIN)
                                           ; SOURCE LINE # 161
                                           ; SOURCE LINE # 162
                                           ; SOURCE LINE # 163
0000 758A06            MOV     TL0,#06H
                                           ; SOURCE LINE # 164
0003 758CF1            MOV     TH0,#0F1H
                                           ; SOURCE LINE # 165
0006 C28D              CLR     TF0
                                           ; SOURCE LINE # 166
0008 22                RET     
             ; FUNCTION Load_Timer_A (END)

             ; FUNCTION Load_Timer_A_1ms (BEGIN)
                                           ; SOURCE LINE # 169
                                           ; SOURCE LINE # 170
                                           ; SOURCE LINE # 171
0000 E4                CLR     A
0001 F58A              MOV     TL0,A
                                           ; SOURCE LINE # 172
0003 758CFD            MOV     TH0,#0FDH
                                           ; SOURCE LINE # 173
0006 C28D              CLR     TF0
                                           ; SOURCE LINE # 174
0008 22                RET     
             ; FUNCTION Load_Timer_A_1ms (END)

             ; FUNCTION InitSMBus (BEGIN)
                                           ; SOURCE LINE # 178
                                           ; SOURCE LINE # 179
                                           ; SOURCE LINE # 182
0000 900000      E     MOV     DPTR,#Index_07H
0003 7419              MOV     A,#019H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 183
0006 E4                CLR     A
0007 900000      E     MOV     DPTR,#Index_70H
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 184
000B 900000      E     MOV     DPTR,#Index_30H
000E F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 16  

                                           ; SOURCE LINE # 197
000F 900000      E     MOV     DPTR,#Index_76H
0012 E0                MOVX    A,@DPTR
0013 4402              ORL     A,#02H
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 198
0016 900000      E     MOV     DPTR,#HOCTL2_A
0019 7401              MOV     A,#01H
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 212
001C 900000      E     MOV     DPTR,#Index_76H
001F E0                MOVX    A,@DPTR
0020 54FE              ANL     A,#0FEH
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 216
0023 120000      E     LCALL   Core_Init_SMBus
                                           ; SOURCE LINE # 222
0026 7464              MOV     A,#064H
0028 75F000            MOV     B,#00H
002B 120000      E     LCALL   ?C?ICASE
002E 0000        R     DW      ?C0019
0030 000A              DW      0AH
0032 0000        R     DW      ?C0018
0034 000D              DW      0DH
0036 0000        R     DW      ?C0017
0038 0014              DW      014H
003A 0000        R     DW      ?C0016
003C 0032              DW      032H
003E 0000        R     DW      ?C0015
0040 0064              DW      064H
0042 0000        R     DW      ?C0014
0044 0190              DW      0190H
0046 0000              DW      00H
0048 0000        R     DW      ?C0021
                                           ; SOURCE LINE # 223
                                           ; SOURCE LINE # 224
004A         ?C0014:
                                           ; SOURCE LINE # 225
004A 7403              MOV     A,#03H
                                           ; SOURCE LINE # 226
004C 120000      R     LCALL   L?0062
004F 14                DEC     A
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 227
0051 900000      E     MOV     DPTR,#SMBUS_300NSREG
0054 04                INC     A
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 228
                                           ; SOURCE LINE # 229
                                           ; SOURCE LINE # 230
0056 120000      R     LCALL   L?0057
0059 74C9              MOV     A,#0C9H
                                           ; SOURCE LINE # 231
                                           ; SOURCE LINE # 232
                                           ; SOURCE LINE # 233
005B 803C              SJMP    ?C0054
                                           ; SOURCE LINE # 235
005D         ?C0015:
                                           ; SOURCE LINE # 237
005D 900000      E     MOV     DPTR,#SMBUS_4P7USREG
0060 7415              MOV     A,#015H
0062 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 17  

                                           ; SOURCE LINE # 238
0063 7425              MOV     A,#025H
                                           ; SOURCE LINE # 239
0065 120000      R     LCALL   L?0059
                                           ; SOURCE LINE # 240
0068 7415              MOV     A,#015H
                                           ; SOURCE LINE # 241
                                           ; SOURCE LINE # 242
006A 120000      R     LCALL   L?0056
006D 74B8              MOV     A,#0B8H
006F         ?C0052:
                                           ; SOURCE LINE # 243
                                           ; SOURCE LINE # 244
                                           ; SOURCE LINE # 245
006F 8028              SJMP    ?C0054
                                           ; SOURCE LINE # 247
0071         ?C0016:
                                           ; SOURCE LINE # 249
0071 900000      E     MOV     DPTR,#SMBUS_4P7USREG
0074 742C              MOV     A,#02CH
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 250
0077 7453              MOV     A,#053H
                                           ; SOURCE LINE # 251
0079 120000      R     LCALL   L?0059
                                           ; SOURCE LINE # 252
007C 742C              MOV     A,#02CH
                                           ; SOURCE LINE # 253
                                           ; SOURCE LINE # 254
007E 120000      R     LCALL   L?0056
0081 74A0              MOV     A,#0A0H
0083         ?C0053:
                                           ; SOURCE LINE # 255
                                           ; SOURCE LINE # 256
                                           ; SOURCE LINE # 257
0083 8014              SJMP    ?C0054
                                           ; SOURCE LINE # 259
0085         ?C0017:
                                           ; SOURCE LINE # 261
0085 7471              MOV     A,#071H
                                           ; SOURCE LINE # 262
0087 120000      R     LCALL   L?0062
008A 74DD              MOV     A,#0DDH
                                           ; SOURCE LINE # 263
008C 120000      R     LCALL   L?0060
                                           ; SOURCE LINE # 264
008F 900000      E     MOV     DPTR,#SMBUS_250NSREG
0092 7471              MOV     A,#071H
                                           ; SOURCE LINE # 265
                                           ; SOURCE LINE # 266
0094 120000      R     LCALL   L?0058
0097 745B              MOV     A,#05BH
0099         ?C0054:
0099 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 267
009A 900000      E     MOV     DPTR,#SMBUS_45P3USHREG
009D 7401              MOV     A,#01H
009F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 268
00A0 E4                CLR     A
00A1 900000      E     MOV     DPTR,#SMBUS_4P7A4P0H
00A4 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 18  

                                           ; SOURCE LINE # 269
00A5 22                RET     
                                           ; SOURCE LINE # 271
00A6         ?C0018:
                                           ; SOURCE LINE # 273
00A6 900000      E     MOV     DPTR,#SMBUS_4P7USREG
00A9 74AF              MOV     A,#0AFH
00AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 274
00AC 900000      E     MOV     DPTR,#SMBUS_4P0USREG
00AF 745A              MOV     A,#05AH
                                           ; SOURCE LINE # 275
00B1 120000      R     LCALL   L?0060
                                           ; SOURCE LINE # 276
00B4 900000      E     MOV     DPTR,#SMBUS_250NSREG
00B7 74AF              MOV     A,#0AFH
                                           ; SOURCE LINE # 277
                                           ; SOURCE LINE # 278
00B9 120000      R     LCALL   L?0058
00BC 741D              MOV     A,#01DH
00BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 279
00BF 900000      E     MOV     DPTR,#SMBUS_45P3USHREG
00C2 7401              MOV     A,#01H
00C4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 280
00C5 900000      E     MOV     DPTR,#SMBUS_4P7A4P0H
00C8 04                INC     A
00C9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 281
00CA 22                RET     
                                           ; SOURCE LINE # 283
00CB         ?C0019:
                                           ; SOURCE LINE # 285
00CB 900000      E     MOV     DPTR,#SMBUS_4P7USREG
00CE 74E4              MOV     A,#0E4H
00D0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 286
00D1 900000      E     MOV     DPTR,#SMBUS_4P0USREG
00D4 74C5              MOV     A,#0C5H
                                           ; SOURCE LINE # 287
00D6 120000      R     LCALL   L?0060
                                           ; SOURCE LINE # 288
00D9 900000      E     MOV     DPTR,#SMBUS_250NSREG
00DC 74E4              MOV     A,#0E4H
                                           ; SOURCE LINE # 289
                                           ; SOURCE LINE # 290
00DE 120000      R     LCALL   L?0058
00E1 74E8              MOV     A,#0E8H
00E3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 291
00E4 E4                CLR     A
00E5 900000      E     MOV     DPTR,#SMBUS_45P3USHREG
00E8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
00E9 900000      E     MOV     DPTR,#SMBUS_4P7A4P0H
00EC 7402              MOV     A,#02H
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 293
                                           ; SOURCE LINE # 295
                                           ; SOURCE LINE # 296
                                           ; SOURCE LINE # 297
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 19  

                                           ; SOURCE LINE # 299
00EF         ?C0021:
00EF 22                RET     
             ; FUNCTION InitSMBus (END)

             ; FUNCTION InitDAC (BEGIN)
                                           ; SOURCE LINE # 302
                                           ; SOURCE LINE # 303
                                           ; SOURCE LINE # 304
0000 E4                CLR     A
0001 900000      E     MOV     DPTR,#DACPDREG
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 306
0005 900000      E     MOV     DPTR,#DACDAT0_MSB
0008 7430              MOV     A,#030H
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 307
000B 900000      E     MOV     DPTR,#DACDAT0_LSB
000E 74FF              MOV     A,#0FFH
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 309
0011 900000      E     MOV     DPTR,#DACDAT1_MSB
0014 7402              MOV     A,#02H
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 310
0017 E4                CLR     A
0018 900000      E     MOV     DPTR,#DACDAT1_LSB
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 312
001C 900000      E     MOV     DPTR,#DACDAT2_MSB
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 313
0020 900000      E     MOV     DPTR,#DACDAT2_LSB
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 315
0024 900000      E     MOV     DPTR,#DACDAT3_MSB
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 316
0028 900000      E     MOV     DPTR,#DACDAT3_LSB
002B 74FF              MOV     A,#0FFH
002D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 318
002E 900000      E     MOV     DPTR,#DACDAT4_MSB
0031 7402              MOV     A,#02H
0033 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 319
0034 900000      E     MOV     DPTR,#DACDAT4_LSB
0037 74FF              MOV     A,#0FFH
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 320
003A 22                RET     
             ; FUNCTION InitDAC (END)

             ; FUNCTION InitADC (BEGIN)
                                           ; SOURCE LINE # 322
                                           ; SOURCE LINE # 323
                                           ; SOURCE LINE # 324
0000 7404              MOV     A,#04H
                                           ; SOURCE LINE # 325
0002 120000      R     LCALL   L?0061
0005 7401              MOV     A,#01H
0007 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 20  

                                           ; SOURCE LINE # 326
0008 900000      E     MOV     DPTR,#ADC_VCEn
000B 743F              MOV     A,#03FH
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 327
000E 900000      E     MOV     DPTR,#ADC_channel_enable
0011 74FF              MOV     A,#0FFH
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 328
0014 900000      E     MOV     DPTR,#CFG_REG
0017 E0                MOVX    A,@DPTR
0018 4401              ORL     A,#01H
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 329
001B 22                RET     
             ; FUNCTION InitADC (END)

             ; FUNCTION InitFanCTL (BEGIN)
                                           ; SOURCE LINE # 332
                                           ; SOURCE LINE # 333
                                           ; SOURCE LINE # 334
0000 900000      E     MOV     DPTR,#FAN_MAIN_CTL
0003 7477              MOV     A,#077H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 335
0006 900000      E     MOV     DPTR,#FAN_CTL
0009 74C0              MOV     A,#0C0H
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 337
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#FAN_CTL1
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 338
0011 900000      E     MOV     DPTR,#PWM_FAN_CTL1
0014 7450              MOV     A,#050H
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 340
0017 E4                CLR     A
0018 900000      E     MOV     DPTR,#FAN_CTL2
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 341
001C 900000      E     MOV     DPTR,#PWM_FAN_CTL2
001F 7450              MOV     A,#050H
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 342
0022 22                RET     
             ; FUNCTION InitFanCTL (END)

             ; FUNCTION _vDelay1ms (BEGIN)
                                           ; SOURCE LINE # 354
0000 900000      R     MOV     DPTR,#bMS
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 355
                                           ; SOURCE LINE # 359
0008 A2AF              MOV     C,EA
000A 9200        R     MOV     SaveEA,C
                                           ; SOURCE LINE # 360
000C C2AF              CLR     EA
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 21  

000E         ?C0025:
                                           ; SOURCE LINE # 362
000E 900000      R     MOV     DPTR,#bMS
0011 E0                MOVX    A,@DPTR
0012 7002              JNZ     ?C0050
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016         ?C0050:
0016 6018              JZ      ?C0026
                                           ; SOURCE LINE # 363
                                           ; SOURCE LINE # 364
;---- Variable 'i' assigned to Register 'R7' ----
0018 E4                CLR     A
0019 FF                MOV     R7,A
001A         ?C0027:
                                           ; SOURCE LINE # 365
001A E4                CLR     A
001B 900000      E     MOV     DPTR,#WNCKR
001E F0                MOVX    @DPTR,A
001F 0F                INC     R7
0020 EF                MOV     A,R7
0021 B442F6            CJNE    A,#042H,?C0027
0024         ?C0028:
                                           ; SOURCE LINE # 366
0024 900000      R     MOV     DPTR,#bMS
0027 74FF              MOV     A,#0FFH
0029 F5F0              MOV     B,A
002B 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 367
002E 80DE              SJMP    ?C0025
0030         ?C0026:
                                           ; SOURCE LINE # 368
0030 A200        R     MOV     C,SaveEA
0032 92AF              MOV     EA,C
                                           ; SOURCE LINE # 369
0034 22                RET     
             ; FUNCTION _vDelay1ms (END)

             ; FUNCTION _LED_SEG (BEGIN)
                                           ; SOURCE LINE # 371
;---- Variable 'ucByte' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 372
                                           ; SOURCE LINE # 374
0000 900000      E     MOV     DPTR,#GPIO_7x
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 376
0005 22                RET     
             ; FUNCTION _LED_SEG (END)

             ; FUNCTION InitEnterDeepSleep (BEGIN)
                                           ; SOURCE LINE # 403
                                           ; SOURCE LINE # 404
                                           ; SOURCE LINE # 406
0000 C2A9              CLR     ET0
                                           ; SOURCE LINE # 407
0002 C2AB              CLR     ET1
                                           ; SOURCE LINE # 410
0004 900000      E     MOV     DPTR,#IER6
0007 7410              MOV     A,#010H
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 411
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 22  

000A 900000      E     MOV     DPTR,#WUENR3
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 412
000E 900000      E     MOV     DPTR,#WUESR3
0011 74FF              MOV     A,#0FFH
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 413
0014 22                RET     
             ; FUNCTION InitEnterDeepSleep (END)

             ; FUNCTION InitWakeFromDeepSleep (BEGIN)
                                           ; SOURCE LINE # 415
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 418
0000 E4                CLR     A
0001 900000      E     MOV     DPTR,#WUENR3
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 419
0005 900000      E     MOV     DPTR,#IER6
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 421
0009 900000      E     MOV     DPTR,#DeepSleepCountDown
000C 7402              MOV     A,#02H
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 424
000F D2A9              SETB    ET0
                                           ; SOURCE LINE # 426
0011 22                RET     
             ; FUNCTION InitWakeFromDeepSleep (END)

             ; FUNCTION Init_UART2 (BEGIN)
                                           ; SOURCE LINE # 429
                                           ; SOURCE LINE # 430
                                           ; SOURCE LINE # 431
0000 900000      E     MOV     DPTR,#SysPowState
0003 E0                MOVX    A,@DPTR
0004 6405              XRL     A,#05H
0006 6003              JZ      ?C0035
0008 E0                MOVX    A,@DPTR
0009 7007              JNZ     ?C0034
000B         ?C0035:
                                           ; SOURCE LINE # 432
                                           ; SOURCE LINE # 434
000B 900000      E     MOV     DPTR,#Index_23H
000E E0                MOVX    A,@DPTR
000F 4401              ORL     A,#01H
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 435
0012         ?C0034:
                                           ; SOURCE LINE # 439
0012 900000      E     MOV     DPTR,#Index_07H
0015 7402              MOV     A,#02H
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 440
0018 900000      E     MOV     DPTR,#Index_30H
001B 14                DEC     A
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 441
001D 900000      E     MOV     DPTR,#Index_F0H
0020 E0                MOVX    A,@DPTR
0021 4408              ORL     A,#08H
0023 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 23  

                                           ; SOURCE LINE # 443
0024 900000      E     MOV     DPTR,#Index_07H
0027 7407              MOV     A,#07H
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 444
002A 900000      E     MOV     DPTR,#Index_26H
002D E0                MOVX    A,@DPTR
002E 547F              ANL     A,#07FH
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 445
0031 E0                MOVX    A,@DPTR
0032 54BF              ANL     A,#0BFH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 446
0035 900000      E     MOV     DPTR,#Index_C1H
0038 E0                MOVX    A,@DPTR
0039 547F              ANL     A,#07FH
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 447
003C E0                MOVX    A,@DPTR
003D 54BF              ANL     A,#0BFH
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 448
0040 902803            MOV     DPTR,#02803H
0043 7480              MOV     A,#080H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 449
0046 902801            MOV     DPTR,#02801H
0049 E4                CLR     A
004A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 453
004B 902800            MOV     DPTR,#02800H
004E 7406              MOV     A,#06H
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 455
0051 902803            MOV     DPTR,#02803H
0054 7403              MOV     A,#03H
0056 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 457
0057 902802            MOV     DPTR,#02802H
005A E0                MOVX    A,@DPTR
005B 4486              ORL     A,#086H
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 458
005E E0                MOVX    A,@DPTR
005F 4401              ORL     A,#01H
0061 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 459
0062 902801            MOV     DPTR,#02801H
0065 E0                MOVX    A,@DPTR
0066 4401              ORL     A,#01H
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 460
0069 902804            MOV     DPTR,#02804H
006C E0                MOVX    A,@DPTR
006D 4408              ORL     A,#08H
006F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 461
0070 900000      E     MOV     DPTR,#IER4
0073 E0                MOVX    A,@DPTR
0074 4480              ORL     A,#080H
0076 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 24  

                                           ; SOURCE LINE # 462
0077 900000      E     MOV     DPTR,#ISR4
007A 7480              MOV     A,#080H
007C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 465
007D 22                RET     
             ; FUNCTION Init_UART2 (END)

             ; FUNCTION Init_UART1 (BEGIN)
                                           ; SOURCE LINE # 469
                                           ; SOURCE LINE # 470
                                           ; SOURCE LINE # 473
0000 900000      E     MOV     DPTR,#SysPowState
0003 E0                MOVX    A,@DPTR
0004 6405              XRL     A,#05H
0006 6003              JZ      ?C0038
0008 E0                MOVX    A,@DPTR
0009 7007              JNZ     ?C0037
000B         ?C0038:
                                           ; SOURCE LINE # 474
                                           ; SOURCE LINE # 476
000B 900000      E     MOV     DPTR,#Index_23H
000E E0                MOVX    A,@DPTR
000F 4401              ORL     A,#01H
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 477
0012         ?C0037:
                                           ; SOURCE LINE # 480
0012 900000      E     MOV     DPTR,#Index_07H
0015 7401              MOV     A,#01H
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 481
0018 900000      E     MOV     DPTR,#Index_30H
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 482
001C 900000      E     MOV     DPTR,#Index_F0H
001F E0                MOVX    A,@DPTR
0020 4408              ORL     A,#08H
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 484
0023 902703            MOV     DPTR,#02703H
0026 7480              MOV     A,#080H
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 485
0029 902701            MOV     DPTR,#02701H
002C E4                CLR     A
002D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 488
002E 902700            MOV     DPTR,#02700H
0031 7403              MOV     A,#03H
0033 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 490
0034 902703            MOV     DPTR,#02703H
0037 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 492
0038 902702            MOV     DPTR,#02702H
003B E0                MOVX    A,@DPTR
003C 4486              ORL     A,#086H
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 493
003F E0                MOVX    A,@DPTR
0040 4401              ORL     A,#01H
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 25  

0042 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 494
0043 902701            MOV     DPTR,#02701H
0046 E0                MOVX    A,@DPTR
0047 4401              ORL     A,#01H
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 495
004A 902704            MOV     DPTR,#02704H
004D E0                MOVX    A,@DPTR
004E 4408              ORL     A,#08H
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 496
0051 900000      E     MOV     DPTR,#IER4
0054 E0                MOVX    A,@DPTR
0055 4440              ORL     A,#040H
0057 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 497
0058 900000      E     MOV     DPTR,#ISR4
005B 7440              MOV     A,#040H
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 500
005E 22                RET     
             ; FUNCTION Init_UART1 (END)

             ; FUNCTION Set_ExtTimer1 (BEGIN)
                                           ; SOURCE LINE # 503
                                           ; SOURCE LINE # 504
                                           ; SOURCE LINE # 506
0000 900000      E     MOV     DPTR,#ETWCTRL
0003 E0                MOVX    A,@DPTR
0004 4401              ORL     A,#01H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 507
0007 E4                CLR     A
0008 900000      E     MOV     DPTR,#ETPSR
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 512
000C 900000      E     MOV     DPTR,#ETCNTLHR
000F 747D              MOV     A,#07DH
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 513
0012 E4                CLR     A
0013 900000      E     MOV     DPTR,#ETCNTLLR
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 515
0017 900000      E     MOV     DPTR,#ISR3
001A 7440              MOV     A,#040H
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 516
001D 900000      E     MOV     DPTR,#IER3
0020 E0                MOVX    A,@DPTR
0021 4440              ORL     A,#040H
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 518
0024 22                RET     
             ; FUNCTION Set_ExtTimer1 (END)

             ; FUNCTION _Read_SPI (BEGIN)
                                           ; SOURCE LINE # 521
0000 900000      R     MOV     DPTR,#address
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 26  

0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 522
                                           ; SOURCE LINE # 526
0008 900000      R     MOV     DPTR,#address
000B E0                MOVX    A,@DPTR
000C FE                MOV     R6,A
000D A3                INC     DPTR
000E E0                MOVX    A,@DPTR
;---- Variable 'pt_rom' assigned to Register 'DPTR' ----
000F F582              MOV     DPL,A
0011 8E83              MOV     DPH,R6
                                           ; SOURCE LINE # 527
0013 E4                CLR     A
0014 93                MOVC    A,@A+DPTR
0015 FF                MOV     R7,A
;---- Variable 'tmp' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 529
                                           ; SOURCE LINE # 530
0016         ?C0041:
0016 22                RET     
             ; FUNCTION _Read_SPI (END)

             ; FUNCTION Init_BRAM (BEGIN)
                                           ; SOURCE LINE # 533
                                           ; SOURCE LINE # 534
                                           ; SOURCE LINE # 538
;---- Variable 'byte_reg_pntr' assigned to Register 'R6/R7' ----
0000 7F00              MOV     R7,#00H
0002 7E22              MOV     R6,#022H
                                           ; SOURCE LINE # 540
0004 900000      E     MOV     DPTR,#BRAM_CHECK0
0007 E0                MOVX    A,@DPTR
0008 B4460F            CJNE    A,#046H,?C0045
000B 900000      E     MOV     DPTR,#BRAM_CHECK1
000E E0                MOVX    A,@DPTR
000F B40508            CJNE    A,#05H,?C0045
0012 900000      E     MOV     DPTR,#BRAM_CHECK2
0015 E0                MOVX    A,@DPTR
0016 6402              XRL     A,#02H
0018 6028              JZ      ?C0043
                                           ; SOURCE LINE # 541
                                           ; SOURCE LINE # 543
                                           ; SOURCE LINE # 545
001A         ?C0045:
                                           ; SOURCE LINE # 546
001A C3                CLR     C
001B EF                MOV     A,R7
001C 94C0              SUBB    A,#0C0H
001E EE                MOV     A,R6
001F 9422              SUBB    A,#022H
0021 500D              JNC     ?C0046
                                           ; SOURCE LINE # 547
                                           ; SOURCE LINE # 548
0023 8F82              MOV     DPL,R7
0025 8E83              MOV     DPH,R6
0027 E4                CLR     A
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 549
0029 0F                INC     R7
002A BF0001            CJNE    R7,#00H,?C0051
C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 27  

002D 0E                INC     R6
002E         ?C0051:
                                           ; SOURCE LINE # 550
002E 80EA              SJMP    ?C0045
0030         ?C0046:
                                           ; SOURCE LINE # 551
0030 900000      E     MOV     DPTR,#BRAM_CHECK0
0033 7446              MOV     A,#046H
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 552
0036 900000      E     MOV     DPTR,#BRAM_CHECK1
0039 7405              MOV     A,#05H
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 553
003C 900000      E     MOV     DPTR,#BRAM_CHECK2
003F 7402              MOV     A,#02H
0041 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 554
                                           ; SOURCE LINE # 558
0042         ?C0043:
0042 22                RET     
             ; FUNCTION Init_BRAM (END)

             ; FUNCTION EnableKBCIBFInt (BEGIN)
                                           ; SOURCE LINE # 563
                                           ; SOURCE LINE # 564
                                           ; SOURCE LINE # 565
0000 900000      E     MOV     DPTR,#IER3
0003 E0                MOVX    A,@DPTR
0004 4401              ORL     A,#01H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 566
0007 22                RET     
             ; FUNCTION EnableKBCIBFInt (END)

             ; FUNCTION Disable_DCache (BEGIN)
                                           ; SOURCE LINE # 571
                                           ; SOURCE LINE # 572
                                           ; SOURCE LINE # 575
0000 900000      E     MOV     DPTR,#CACHDISR
0003 7403              MOV     A,#03H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 585
0006 22                RET     
             ; FUNCTION Disable_DCache (END)

             ; FUNCTION Enable_K8_Function (BEGIN)
                                           ; SOURCE LINE # 591
                                           ; SOURCE LINE # 592
                                           ; SOURCE LINE # 593
0000 902907            MOV     DPTR,#02907H
0003 7407              MOV     A,#07H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 594
0006 900000      E     MOV     DPTR,#Index_2DH
0009 E0                MOVX    A,@DPTR
000A 4401              ORL     A,#01H
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 595
000D 22                RET     
             ; FUNCTION Enable_K8_Function (END)

C51 COMPILER V7.50   CORE_INIT                                                             09/16/2020 21:10:03 PAGE 28  



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1141    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       6
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
